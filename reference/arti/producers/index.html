
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.4, mkdocs-material-7.3.0">
    
    
      
        <title>Producers - artigraph</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="lightgreen">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-artiproducers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="artigraph" class="md-header__button md-logo" aria-label="artigraph" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            artigraph
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Producers
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/artigraph/artigraph/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    artigraph
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="artigraph" class="md-nav__button md-logo" aria-label="artigraph" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    artigraph
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/artigraph/artigraph/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    artigraph
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CHANGELOG/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CODE_OF_CONDUCT/" class="md-nav__link">
        Code Of Conduct
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../GOVERNANCE/" class="md-nav__link">
        Governance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../SECURITY/" class="md-nav__link">
        Security
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../SUPPORT/" class="md-nav__link">
        Support
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1" type="checkbox" id="__nav_8_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1">
          Arti
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Arti" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_1">
          <span class="md-nav__icon md-icon"></span>
          Arti
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../annotations/" class="md-nav__link">
        Annotations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../artifacts/" class="md-nav__link">
        Artifacts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fingerprints/" class="md-nav__link">
        Fingerprints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../graphs/" class="md-nav__link">
        Graphs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../partitions/" class="md-nav__link">
        Partitions
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Producers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Producers
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#producer" class="md-nav__link">
    producer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buildinputs" class="md-nav__link">
    BuildInputs
  </a>
  
    <nav class="md-nav" aria-label="BuildInputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get" class="md-nav__link">
    get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#items" class="md-nav__link">
    items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keys" class="md-nav__link">
    keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#values" class="md-nav__link">
    values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buildsig" class="md-nav__link">
    BuildSig
  </a>
  
    <nav class="md-nav" aria-label="BuildSig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_1" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inputpartitions" class="md-nav__link">
    InputPartitions
  </a>
  
    <nav class="md-nav" aria-label="InputPartitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_2" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_1" class="md-nav__link">
    get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#items_1" class="md-nav__link">
    items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keys_1" class="md-nav__link">
    keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#values_1" class="md-nav__link">
    values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapinputs" class="md-nav__link">
    MapInputs
  </a>
  
    <nav class="md-nav" aria-label="MapInputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_3" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add" class="md-nav__link">
    add
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear" class="md-nav__link">
    clear
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difference" class="md-nav__link">
    difference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difference_update" class="md-nav__link">
    difference_update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discard" class="md-nav__link">
    discard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intersection" class="md-nav__link">
    intersection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intersection_update" class="md-nav__link">
    intersection_update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isdisjoint" class="md-nav__link">
    isdisjoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issubset" class="md-nav__link">
    issubset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issuperset" class="md-nav__link">
    issuperset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pop" class="md-nav__link">
    pop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove" class="md-nav__link">
    remove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric_difference" class="md-nav__link">
    symmetric_difference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric_difference_update" class="md-nav__link">
    symmetric_difference_update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#union" class="md-nav__link">
    union
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapsig" class="md-nav__link">
    MapSig
  </a>
  
    <nav class="md-nav" aria-label="MapSig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_4" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    Outputs
  </a>
  
    <nav class="md-nav" aria-label="Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_5" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count" class="md-nav__link">
    count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    index
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitiondependencies" class="md-nav__link">
    PartitionDependencies
  </a>
  
    <nav class="md-nav" aria-label="PartitionDependencies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_6" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_2" class="md-nav__link">
    get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#items_2" class="md-nav__link">
    items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keys_2" class="md-nav__link">
    keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#values_2" class="md-nav__link">
    values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producer_1" class="md-nav__link">
    Producer
  </a>
  
    <nav class="md-nav" aria-label="Producer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_7" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_outputs" class="md-nav__link">
    validate_outputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_5" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_dependencies" class="md-nav__link">
    compute_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_input_fingerprint" class="md-nav__link">
    compute_input_fingerprint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_1" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out" class="md-nav__link">
    out
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#produceroutput" class="md-nav__link">
    ProducerOutput
  </a>
  
    <nav class="md-nav" aria-label="ProducerOutput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_8" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_1" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_1" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_1" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_1" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_1" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_1" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_1" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_1" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_1" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_1" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_1" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_1" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_6" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_2" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_1" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_1" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validatesig" class="md-nav__link">
    ValidateSig
  </a>
  
    <nav class="md-nav" aria-label="ValidateSig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_9" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../statistics/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../thresholds/" class="md-nav__link">
        Thresholds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../versions/" class="md-nav__link">
        Versions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1_11" type="checkbox" id="__nav_8_1_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1_11">
          Backends
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Backends" data-md-level="3">
        <label class="md-nav__title" for="__nav_8_1_11">
          <span class="md-nav__icon md-icon"></span>
          Backends
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backends/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backends/memory/" class="md-nav__link">
        Memory
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1_12" type="checkbox" id="__nav_8_1_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1_12">
          Executors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Executors" data-md-level="3">
        <label class="md-nav__title" for="__nav_8_1_12">
          <span class="md-nav__icon md-icon"></span>
          Executors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../executors/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../executors/local/" class="md-nav__link">
        Local
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1_13" type="checkbox" id="__nav_8_1_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1_13">
          Formats
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Formats" data-md-level="3">
        <label class="md-nav__title" for="__nav_8_1_13">
          <span class="md-nav__icon md-icon"></span>
          Formats
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../formats/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../formats/json/" class="md-nav__link">
        Json
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../formats/pickle/" class="md-nav__link">
        Pickle
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1_14" type="checkbox" id="__nav_8_1_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1_14">
          Internal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Internal" data-md-level="3">
        <label class="md-nav__title" for="__nav_8_1_14">
          <span class="md-nav__icon md-icon"></span>
          Internal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../internal/dispatch/" class="md-nav__link">
        Dispatch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../internal/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../internal/models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../internal/patches/" class="md-nav__link">
        Patches
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../internal/type_hints/" class="md-nav__link">
        Type Hints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../internal/utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1_15" type="checkbox" id="__nav_8_1_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1_15">
          Io
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Io" data-md-level="3">
        <label class="md-nav__title" for="__nav_8_1_15">
          <span class="md-nav__icon md-icon"></span>
          Io
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io/json_gcsfile_python/" class="md-nav__link">
        Json Gcsfile Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io/json_localfile_python/" class="md-nav__link">
        Json Localfile Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io/json_stringliteral_python/" class="md-nav__link">
        Json Stringliteral Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io/pickle_gcsfile_python/" class="md-nav__link">
        Pickle Gcsfile Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../io/pickle_localfile_python/" class="md-nav__link">
        Pickle Localfile Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1_16" type="checkbox" id="__nav_8_1_16" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1_16">
          Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Storage" data-md-level="3">
        <label class="md-nav__title" for="__nav_8_1_16">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../storage/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../storage/literal/" class="md-nav__link">
        Literal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../storage/local/" class="md-nav__link">
        Local
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1_17" type="checkbox" id="__nav_8_1_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1_17">
          Types
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Types" data-md-level="3">
        <label class="md-nav__title" for="__nav_8_1_17">
          <span class="md-nav__icon md-icon"></span>
          Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../types/bigquery/" class="md-nav__link">
        Bigquery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../types/numpy/" class="md-nav__link">
        Numpy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../types/pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../types/pyarrow/" class="md-nav__link">
        Pyarrow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../types/pydantic/" class="md-nav__link">
        Pydantic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../types/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_1_18" type="checkbox" id="__nav_8_1_18" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_1_18">
          Views
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Views" data-md-level="3">
        <label class="md-nav__title" for="__nav_8_1_18">
          <span class="md-nav__icon md-icon"></span>
          Views
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../views/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../views/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#producer" class="md-nav__link">
    producer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buildinputs" class="md-nav__link">
    BuildInputs
  </a>
  
    <nav class="md-nav" aria-label="BuildInputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get" class="md-nav__link">
    get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#items" class="md-nav__link">
    items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keys" class="md-nav__link">
    keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#values" class="md-nav__link">
    values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buildsig" class="md-nav__link">
    BuildSig
  </a>
  
    <nav class="md-nav" aria-label="BuildSig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_1" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inputpartitions" class="md-nav__link">
    InputPartitions
  </a>
  
    <nav class="md-nav" aria-label="InputPartitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_2" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_1" class="md-nav__link">
    get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#items_1" class="md-nav__link">
    items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keys_1" class="md-nav__link">
    keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#values_1" class="md-nav__link">
    values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapinputs" class="md-nav__link">
    MapInputs
  </a>
  
    <nav class="md-nav" aria-label="MapInputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_3" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add" class="md-nav__link">
    add
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear" class="md-nav__link">
    clear
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difference" class="md-nav__link">
    difference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difference_update" class="md-nav__link">
    difference_update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discard" class="md-nav__link">
    discard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intersection" class="md-nav__link">
    intersection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intersection_update" class="md-nav__link">
    intersection_update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isdisjoint" class="md-nav__link">
    isdisjoint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issubset" class="md-nav__link">
    issubset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issuperset" class="md-nav__link">
    issuperset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pop" class="md-nav__link">
    pop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove" class="md-nav__link">
    remove
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric_difference" class="md-nav__link">
    symmetric_difference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#symmetric_difference_update" class="md-nav__link">
    symmetric_difference_update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#union" class="md-nav__link">
    union
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update" class="md-nav__link">
    update
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapsig" class="md-nav__link">
    MapSig
  </a>
  
    <nav class="md-nav" aria-label="MapSig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_4" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    Outputs
  </a>
  
    <nav class="md-nav" aria-label="Outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_5" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#count" class="md-nav__link">
    count
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    index
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitiondependencies" class="md-nav__link">
    PartitionDependencies
  </a>
  
    <nav class="md-nav" aria-label="PartitionDependencies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_6" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_2" class="md-nav__link">
    get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#items_2" class="md-nav__link">
    items
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keys_2" class="md-nav__link">
    keys
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#values_2" class="md-nav__link">
    values
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producer_1" class="md-nav__link">
    Producer
  </a>
  
    <nav class="md-nav" aria-label="Producer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_7" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_outputs" class="md-nav__link">
    validate_outputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_5" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_dependencies" class="md-nav__link">
    compute_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_input_fingerprint" class="md-nav__link">
    compute_input_fingerprint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_1" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out" class="md-nav__link">
    out
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#produceroutput" class="md-nav__link">
    ProducerOutput
  </a>
  
    <nav class="md-nav" aria-label="ProducerOutput">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_8" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_1" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_1" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_1" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_1" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_1" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_1" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_1" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_1" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_1" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_1" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_1" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_1" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_6" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_2" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_1" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_1" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validatesig" class="md-nav__link">
    ValidateSig
  </a>
  
    <nav class="md-nav" aria-label="ValidateSig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_9" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/artigraph/artigraph/edit/golden/reference/arti/producers.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="module-artiproducers">Module arti.producers</h1>
<p>None</p>
<p>None</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">__path__</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="s2">&quot;pkgutil&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extend_path</span><span class="p">(</span><span class="n">__path__</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Iterator</span>

<span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">Signature</span><span class="p">,</span> <span class="n">getattr_static</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span>

    <span class="n">TYPE_CHECKING</span><span class="p">,</span>

    <span class="n">Annotated</span><span class="p">,</span>

    <span class="n">Any</span><span class="p">,</span>

    <span class="n">ClassVar</span><span class="p">,</span>

    <span class="n">Optional</span><span class="p">,</span>

    <span class="n">TypeVar</span><span class="p">,</span>

    <span class="n">Union</span><span class="p">,</span>

    <span class="n">cast</span><span class="p">,</span>

    <span class="n">get_args</span><span class="p">,</span>

    <span class="n">get_origin</span><span class="p">,</span>

<span class="p">)</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">validator</span>

<span class="kn">from</span> <span class="nn">pydantic.fields</span> <span class="kn">import</span> <span class="n">ModelField</span>

<span class="kn">from</span> <span class="nn">arti.annotations</span> <span class="kn">import</span> <span class="n">Annotation</span>

<span class="kn">from</span> <span class="nn">arti.artifacts</span> <span class="kn">import</span> <span class="n">Artifact</span>

<span class="kn">from</span> <span class="nn">arti.fingerprints</span> <span class="kn">import</span> <span class="n">Fingerprint</span>

<span class="kn">from</span> <span class="nn">arti.internal</span> <span class="kn">import</span> <span class="n">wrap_exc</span>

<span class="kn">from</span> <span class="nn">arti.internal.models</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="kn">from</span> <span class="nn">arti.internal.type_hints</span> <span class="kn">import</span> <span class="p">(</span>

    <span class="n">NoneType</span><span class="p">,</span>

    <span class="n">get_item_from_annotated</span><span class="p">,</span>

    <span class="n">lenient_issubclass</span><span class="p">,</span>

    <span class="n">signature</span><span class="p">,</span>

<span class="p">)</span>

<span class="kn">from</span> <span class="nn">arti.internal.utils</span> <span class="kn">import</span> <span class="n">frozendict</span><span class="p">,</span> <span class="n">get_module_name</span><span class="p">,</span> <span class="n">ordinal</span>

<span class="kn">from</span> <span class="nn">arti.partitions</span> <span class="kn">import</span> <span class="n">CompositeKey</span><span class="p">,</span> <span class="n">InputFingerprints</span><span class="p">,</span> <span class="n">NotPartitioned</span><span class="p">,</span> <span class="n">PartitionKey</span>

<span class="kn">from</span> <span class="nn">arti.storage</span> <span class="kn">import</span> <span class="n">StoragePartitions</span>

<span class="kn">from</span> <span class="nn">arti.types</span> <span class="kn">import</span> <span class="n">is_partitioned</span>

<span class="kn">from</span> <span class="nn">arti.versions</span> <span class="kn">import</span> <span class="n">SemVer</span><span class="p">,</span> <span class="n">Version</span>

<span class="kn">from</span> <span class="nn">arti.views</span> <span class="kn">import</span> <span class="n">View</span>

<span class="n">_T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;_T&quot;</span><span class="p">)</span>

<span class="n">MapInputs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

<span class="n">BuildInputs</span> <span class="o">=</span> <span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">View</span><span class="p">]</span>

<span class="n">Outputs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">View</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>

<span class="n">InputPartitions</span> <span class="o">=</span> <span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StoragePartitions</span><span class="p">]</span>

<span class="n">PartitionDependencies</span> <span class="o">=</span> <span class="n">frozendict</span><span class="p">[</span><span class="n">CompositeKey</span><span class="p">,</span> <span class="n">InputPartitions</span><span class="p">]</span>

<span class="n">MapSig</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">PartitionDependencies</span><span class="p">]</span>

<span class="n">BuildSig</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>

<span class="n">ValidateSig</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>

<span class="k">class</span> <span class="nc">Producer</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;A Producer is a task that builds one or more Artifacts.&quot;&quot;&quot;</span>

    <span class="c1"># User fields/methods</span>

    <span class="n">annotations</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Annotation</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>

    <span class="n">version</span><span class="p">:</span> <span class="n">Version</span> <span class="o">=</span> <span class="n">SemVer</span><span class="p">(</span><span class="n">major</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">patch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># The map/build/validate_outputs parameters are intended to be dynamic and set by subclasses,</span>

    <span class="c1"># however mypy doesn&#39;t like the &quot;incompatible&quot; signature on subclasses if actually defined here</span>

    <span class="c1"># (nor support ParamSpec yet). `map` is generated during subclassing if not set, `build` is</span>

    <span class="c1"># required, and `validate_outputs` defaults to no-op checks (hence is the only one with a</span>

    <span class="c1"># provided method).</span>

    <span class="c1">#</span>

    <span class="c1"># These must be @classmethods or @staticmethods.</span>

    <span class="nb">map</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">MapSig</span><span class="p">]</span>

    <span class="n">build</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">BuildSig</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>

        <span class="n">validate_outputs</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">ValidateSig</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="nd">@staticmethod</span>

        <span class="k">def</span> <span class="nf">validate_outputs</span><span class="p">(</span><span class="o">*</span><span class="n">outputs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>

<span class="w">            </span><span class="sd">&quot;&quot;&quot;Validate the `Producer.build` outputs, returning the status and a message.</span>

<span class="sd">            The validation status is applied to all outputs. If validation does not pass, the</span>

<span class="sd">            outputs will not be written to storage to prevent checkpointing the output. In the</span>

<span class="sd">            future, we may still write the data to ease debugging, but track validation status in</span>

<span class="sd">            the Backend (preventing downstream use).</span>

<span class="sd">            The arguments must not be mutated.</span>

<span class="sd">            The parameters must be usable with positional argument. The output of `build` will be</span>

<span class="sd">            passed in as it was returned, for example: `def build(...): return 1, 2` will result in</span>

<span class="sd">            `validate_outputs(1, 2)`.</span>

<span class="sd">            NOTE: `validate_outputs` is a stopgap until Statistics and Thresholds are fully implemented.</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;No validation performed.&quot;</span>

    <span class="c1"># Internal fields/methods</span>

    <span class="n">_abstract_</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">_fingerprint_excludes_</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="s2">&quot;annotations&quot;</span><span class="p">])</span>

    <span class="c1"># NOTE: The following are set in __init_subclass__</span>

    <span class="n">_input_artifact_classes_</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Artifact</span><span class="p">]]]</span>

    <span class="n">_build_inputs_</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">BuildInputs</span><span class="p">]</span>

    <span class="n">_build_sig_</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">Signature</span><span class="p">]</span>

    <span class="n">_map_inputs_</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">MapInputs</span><span class="p">]</span>

    <span class="n">_map_sig_</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">Signature</span><span class="p">]</span>

    <span class="n">_outputs_</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">Outputs</span><span class="p">]</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_abstract_</span><span class="p">:</span>

            <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">):</span>

                <span class="bp">cls</span><span class="o">.</span><span class="n">_input_artifact_classes_</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_fields</span><span class="p">()</span>

                <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;.build&quot;</span><span class="p">):</span>

                    <span class="p">(</span>

                        <span class="bp">cls</span><span class="o">.</span><span class="n">_build_sig_</span><span class="p">,</span>

                        <span class="bp">cls</span><span class="o">.</span><span class="n">_build_inputs_</span><span class="p">,</span>

                        <span class="bp">cls</span><span class="o">.</span><span class="n">_outputs_</span><span class="p">,</span>

                    <span class="p">)</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_build_sig</span><span class="p">()</span>

                <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;.validate_output&quot;</span><span class="p">):</span>

                    <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_validate_output_sig</span><span class="p">()</span>

                <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;.map&quot;</span><span class="p">):</span>

                    <span class="bp">cls</span><span class="o">.</span><span class="n">_map_sig_</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_map_inputs_</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_map_sig</span><span class="p">()</span>

                <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_no_unused_fields</span><span class="p">()</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Artifact</span><span class="p">]]:</span>

        <span class="c1"># NOTE: Aside from the base producer fields, all others should (currently) be Artifacts.</span>

        <span class="c1">#</span>

        <span class="c1"># Users can set additional class attributes, but they must be properly hinted as ClassVars.</span>

        <span class="c1"># These won&#39;t interact with the &quot;framework&quot; and can&#39;t be parameters to build/map.</span>

        <span class="n">artifact_fields</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">__fields__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Producer</span><span class="o">.</span><span class="n">__fields__</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">artifact_fields</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">):</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">default_factory</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">field</span><span class="o">.</span><span class="n">required</span><span class="p">):</span>

                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;field must not have a default nor be Optional.&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">lenient_issubclass</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">outer_type_</span><span class="p">,</span> <span class="n">Artifact</span><span class="p">):</span>

                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                        <span class="sa">f</span><span class="s2">&quot;type hint must be an Artifact subclass, got: </span><span class="si">{</span><span class="n">field</span><span class="o">.</span><span class="n">outer_type_</span><span class="si">}</span><span class="s2">&quot;</span>

                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">frozendict</span><span class="p">({</span><span class="n">name</span><span class="p">:</span> <span class="n">field</span><span class="o">.</span><span class="n">outer_type_</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">artifact_fields</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_parameters</span><span class="p">(</span>

        <span class="bp">cls</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="n">Signature</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">validator</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">],</span> <span class="n">_T</span><span class="p">]</span>

    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_T</span><span class="p">]:</span>

        <span class="k">if</span> <span class="n">undefined_params</span> <span class="o">:=</span> <span class="nb">set</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_input_artifact_classes_</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                <span class="sa">f</span><span class="s2">&quot;the following parameter(s) must be defined as a field: </span><span class="si">{</span><span class="n">undefined_params</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> param&quot;</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">annotation</span> <span class="ow">is</span> <span class="n">param</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>

                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must have a type hint.&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>

                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must not have a default.&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="n">KEYWORD_ONLY</span><span class="p">):</span>

                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must be usable as a keyword argument.&quot;</span><span class="p">)</span>

                <span class="k">yield</span> <span class="n">validator</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_build_param</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">View</span><span class="p">]:</span>

        <span class="n">annotation</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">annotation</span>

        <span class="n">field_artifact_class</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_input_artifact_classes_</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

        <span class="c1"># If there is no Artifact hint, add in the field value as the default.</span>

        <span class="k">if</span> <span class="n">get_item_from_annotated</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="n">Artifact</span><span class="p">,</span> <span class="n">is_subclass</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">annotation</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">annotation</span><span class="p">,</span> <span class="n">field_artifact_class</span><span class="p">]</span>

        <span class="n">view</span> <span class="o">=</span> <span class="n">View</span><span class="o">.</span><span class="n">from_annotation</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;READ&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">view</span><span class="o">.</span><span class="n">artifact_class</span> <span class="o">!=</span> <span class="n">field_artifact_class</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                <span class="sa">f</span><span class="s2">&quot;annotation Artifact class (</span><span class="si">{</span><span class="n">view</span><span class="o">.</span><span class="n">artifact_class</span><span class="si">}</span><span class="s2">) does not match that set on the field (</span><span class="si">{</span><span class="n">field_artifact_class</span><span class="si">}</span><span class="s2">).&quot;</span>

            <span class="p">)</span>

        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">view</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_build_sig_return</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">annotation</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">View</span><span class="p">:</span>

        <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">ordinal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> return&quot;</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">View</span><span class="o">.</span><span class="n">from_annotation</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;WRITE&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_build_sig</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Signature</span><span class="p">,</span> <span class="n">BuildInputs</span><span class="p">,</span> <span class="n">Outputs</span><span class="p">]:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the .build method&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;build&quot;</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must be implemented&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">getattr_static</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;build&quot;</span><span class="p">),</span> <span class="p">(</span><span class="nb">classmethod</span><span class="p">,</span> <span class="nb">staticmethod</span><span class="p">)):</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must be a @classmethod or @staticmethod&quot;</span><span class="p">)</span>

        <span class="n">build_sig</span> <span class="o">=</span> <span class="n">signature</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">build</span><span class="p">,</span> <span class="n">force_tuple_return</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_owner</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Validate the parameters</span>

        <span class="n">build_inputs</span> <span class="o">=</span> <span class="n">BuildInputs</span><span class="p">(</span>

            <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_parameters</span><span class="p">(</span><span class="n">build_sig</span><span class="p">,</span> <span class="n">validator</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_validate_build_param</span><span class="p">)</span>

        <span class="p">)</span>

        <span class="c1"># Validate the return definition</span>

        <span class="n">return_annotation</span> <span class="o">=</span> <span class="n">build_sig</span><span class="o">.</span><span class="n">return_annotation</span>

        <span class="k">if</span> <span class="n">return_annotation</span> <span class="ow">is</span> <span class="n">build_sig</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>

            <span class="c1"># TODO: &quot;side effect&quot; Producers: https://github.com/artigraph/artigraph/issues/11</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;a return value must be set with the output Artifact(s).&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">return_annotation</span> <span class="o">==</span> <span class="p">(</span><span class="n">NoneType</span><span class="p">,):</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;missing return signature&quot;</span><span class="p">)</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="n">Outputs</span><span class="p">(</span>

            <span class="bp">cls</span><span class="o">.</span><span class="n">_validate_build_sig_return</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">return_annotation</span><span class="p">)</span>

        <span class="p">)</span>

        <span class="c1"># Validate all outputs have equivalent partitioning schemes.</span>

        <span class="c1">#</span>

        <span class="c1"># We currently require the partition key type *and* name to match, but in the future we</span>

        <span class="c1"># might be able to extend the dependency metadata to support heterogeneous names if</span>

        <span class="c1"># necessary.</span>

        <span class="n">seen_key_types</span> <span class="o">=</span> <span class="p">{</span><span class="n">PartitionKey</span><span class="o">.</span><span class="n">types_from</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="n">outputs</span><span class="p">}</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seen_key_types</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;all outputs must have the same partitioning scheme&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">build_sig</span><span class="p">,</span> <span class="n">build_inputs</span><span class="p">,</span> <span class="n">outputs</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_validate_output_sig</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">build_output_hints</span> <span class="o">=</span> <span class="p">[</span>

            <span class="n">get_args</span><span class="p">(</span><span class="n">hint</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">get_origin</span><span class="p">(</span><span class="n">hint</span><span class="p">)</span> <span class="ow">is</span> <span class="n">Annotated</span> <span class="k">else</span> <span class="n">hint</span>

            <span class="k">for</span> <span class="n">hint</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_build_sig_</span><span class="o">.</span><span class="n">return_annotation</span>

        <span class="p">]</span>

        <span class="n">match_build_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;match the `.build` return (`</span><span class="si">{</span><span class="n">build_output_hints</span><span class="si">}</span><span class="s2">`)&quot;</span>

        <span class="n">validate_parameters</span> <span class="o">=</span> <span class="n">signature</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">validate_outputs</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>

        <span class="k">def</span> <span class="nf">param_matches</span><span class="p">(</span><span class="n">param</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">build_return</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

            <span class="c1"># Skip checking non-hinted parameters to allow lambdas.</span>

            <span class="c1">#</span>

            <span class="c1"># NOTE: Parameter type hints are *contravariant* (you can&#39;t pass a &quot;Manager&quot; into a</span>

            <span class="c1"># function expecting an &quot;Employee&quot;), hence the lenient_issubclass has build_return as</span>

            <span class="c1"># the subtype and param.annotation as the supertype.</span>

            <span class="k">return</span> <span class="n">param</span><span class="o">.</span><span class="n">annotation</span> <span class="ow">is</span> <span class="n">param</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="n">lenient_issubclass</span><span class="p">(</span>

                <span class="n">build_return</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="n">annotation</span>

            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>  <span class="c1"># Allow `*args: Any` or `*args: T` for `build(...) -&gt; tuple[T, ...]`</span>

            <span class="nb">len</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

            <span class="ow">and</span> <span class="p">(</span><span class="n">param</span> <span class="o">:=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">validate_parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="n">param</span><span class="o">.</span><span class="n">VAR_POSITIONAL</span>

        <span class="p">):</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">param_matches</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">output_hint</span><span class="p">)</span> <span class="k">for</span> <span class="n">output_hint</span> <span class="ow">in</span> <span class="n">build_output_hints</span><span class="p">):</span>

                <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> param&quot;</span><span class="p">):</span>

                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;type hint must be `Any` or </span><span class="si">{</span><span class="n">match_build_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Otherwise, check pairwise</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">build_output_hints</span><span class="p">):</span>

                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;must </span><span class="si">{</span><span class="n">match_build_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">validate_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>

                <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> param&quot;</span><span class="p">):</span>

                    <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>

                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must not have a default.&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">POSITIONAL_ONLY</span><span class="p">,</span> <span class="n">param</span><span class="o">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">):</span>

                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must be usable as a positional argument.&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">param_matches</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="p">(</span><span class="n">expected</span> <span class="o">:=</span> <span class="n">build_output_hints</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>

                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                            <span class="sa">f</span><span class="s2">&quot;type hint must match the </span><span class="si">{</span><span class="n">ordinal</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> `.build` return (`</span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">`)&quot;</span>

                        <span class="p">)</span>

        <span class="c1"># TODO: Validate return signature?</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_map_param</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="n">Parameter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

        <span class="c1"># TODO: Should we add some ArtifactPartition[MyArtifact] type?</span>

        <span class="k">if</span> <span class="n">param</span><span class="o">.</span><span class="n">annotation</span> <span class="o">!=</span> <span class="n">StoragePartitions</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type hint must be `StoragePartitions`&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">name</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_map_sig</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Signature</span><span class="p">,</span> <span class="n">MapInputs</span><span class="p">]:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate partitioned Artifacts and the .map method&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;map&quot;</span><span class="p">):</span>

            <span class="c1"># TODO: Add runtime checking of `map` output (ie: output aligns w/ output</span>

            <span class="c1"># artifacts and such).</span>

            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">is_partitioned</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_outputs_</span><span class="p">):</span>

                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must be implemented when the `build` outputs are partitioned&quot;</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">StoragePartitions</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PartitionDependencies</span><span class="p">:</span>

                <span class="k">return</span> <span class="n">PartitionDependencies</span><span class="p">({</span><span class="n">NotPartitioned</span><span class="p">:</span> <span class="n">frozendict</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)})</span>

            <span class="c1"># Narrow the map signature, which is validated below and used at graph build time (via</span>

            <span class="c1"># cls._map_inputs_) to determine what arguments to pass to map.</span>

            <span class="nb">map</span><span class="o">.</span><span class="n">__signature__</span> <span class="o">=</span> <span class="n">Signature</span><span class="p">(</span>  <span class="c1"># type: ignore[attr-defined]</span>

                <span class="p">[</span>

                    <span class="n">Parameter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">annotation</span><span class="o">=</span><span class="n">StoragePartitions</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">Parameter</span><span class="o">.</span><span class="n">KEYWORD_ONLY</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">artifact</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_input_artifact_classes_</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_build_inputs_</span>

                <span class="p">],</span>

                <span class="n">return_annotation</span><span class="o">=</span><span class="n">PartitionDependencies</span><span class="p">,</span>

            <span class="p">)</span>

            <span class="bp">cls</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">MapSig</span><span class="p">,</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="nb">map</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">getattr_static</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;map&quot;</span><span class="p">),</span> <span class="p">(</span><span class="nb">classmethod</span><span class="p">,</span> <span class="nb">staticmethod</span><span class="p">)):</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must be a @classmethod or @staticmethod&quot;</span><span class="p">)</span>

        <span class="n">map_sig</span> <span class="o">=</span> <span class="n">signature</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">map</span><span class="p">)</span>

        <span class="n">map_inputs</span> <span class="o">=</span> <span class="n">MapInputs</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_validate_parameters</span><span class="p">(</span><span class="n">map_sig</span><span class="p">,</span> <span class="n">validator</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_validate_map_param</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">map_sig</span><span class="p">,</span> <span class="n">map_inputs</span>  <span class="c1"># TODO: Verify map output hint matches TBD spec</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_no_unused_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">unused_fields</span> <span class="o">:=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_input_artifact_classes_</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span>

            <span class="nb">set</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_build_sig_</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_map_sig_</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>

        <span class="p">):</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                <span class="sa">f</span><span class="s2">&quot;the following fields aren&#39;t used in `.build` or `.map`: </span><span class="si">{</span><span class="n">unused_fields</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="p">)</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">_validate_instance_artifact_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Artifact</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">ModelField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Artifact</span><span class="p">:</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">view</span> <span class="o">:=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_build_inputs_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">view</span><span class="o">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">value</span>

    <span class="c1"># NOTE: pydantic defines .__iter__ to return `self.__dict__.items()` to support `dict(model)`,</span>

    <span class="c1"># but we want to override to support easy expansion/assignment to a Graph  without `.out()` (eg:</span>

    <span class="c1"># `g.artifacts.a, g.artifacts.b = MyProducer(...)`).</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Artifact</span><span class="p">]:</span>  <span class="c1"># type: ignore[override]</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>

            <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">ret</span><span class="p">,)</span>

        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">compute_input_fingerprint</span><span class="p">(</span>

        <span class="bp">self</span><span class="p">,</span> <span class="n">dependency_partitions</span><span class="p">:</span> <span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StoragePartitions</span><span class="p">]</span>

    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Fingerprint</span><span class="p">:</span>

        <span class="n">input_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dependency_partitions</span><span class="p">)</span>

        <span class="n">expected_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_inputs_</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">input_names</span> <span class="o">!=</span> <span class="n">expected_names</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                <span class="sa">f</span><span class="s2">&quot;Mismatched dependency inputs; expected </span><span class="si">{</span><span class="n">expected_names</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">input_names</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="p">)</span>

        <span class="c1"># We only care if the *code* or *input partition contents* changed, not if the input file</span>

        <span class="c1"># paths changed (but have the same content as a prior run).</span>

        <span class="k">return</span> <span class="n">Fingerprint</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_class_key_</span><span class="p">)</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">fingerprint</span><span class="p">,</span>

            <span class="o">*</span><span class="p">(</span>

                <span class="n">partition</span><span class="o">.</span><span class="n">content_fingerprint</span>

                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">partitions</span> <span class="ow">in</span> <span class="n">dependency_partitions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">partition</span> <span class="ow">in</span> <span class="n">partitions</span>

            <span class="p">),</span>

        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">compute_dependencies</span><span class="p">(</span>

        <span class="bp">self</span><span class="p">,</span> <span class="n">input_partitions</span><span class="p">:</span> <span class="n">InputPartitions</span>

    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">PartitionDependencies</span><span class="p">,</span> <span class="n">InputFingerprints</span><span class="p">]:</span>

        <span class="c1"># TODO: Validate the partition_dependencies against the Producer&#39;s partitioning scheme and</span>

        <span class="c1"># such (basically, check user error). eg: if output is not partitioned, we expect only 1</span>

        <span class="c1"># entry in partition_dependencies (NotPartitioned).</span>

        <span class="n">partition_dependencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>

            <span class="o">**</span><span class="p">{</span>

                <span class="n">name</span><span class="p">:</span> <span class="n">partitions</span>

                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">partitions</span> <span class="ow">in</span> <span class="n">input_partitions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_inputs_</span>

            <span class="p">}</span>

        <span class="p">)</span>

        <span class="n">partition_input_fingerprints</span> <span class="o">=</span> <span class="n">InputFingerprints</span><span class="p">(</span>

            <span class="p">{</span>

                <span class="n">composite_key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_input_fingerprint</span><span class="p">(</span><span class="n">dependency_partitions</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">composite_key</span><span class="p">,</span> <span class="n">dependency_partitions</span> <span class="ow">in</span> <span class="n">partition_dependencies</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

            <span class="p">}</span>

        <span class="p">)</span>

        <span class="k">return</span> <span class="n">partition_dependencies</span><span class="p">,</span> <span class="n">partition_input_fingerprints</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Artifact</span><span class="p">]:</span>

        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_artifact_classes_</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">outputs</span><span class="p">:</span> <span class="n">Artifact</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Artifact</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Artifact</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the output Artifacts this Producer will build.</span>

<span class="sd">        The arguments are matched to the `Producer.build` return signature in order.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">outputs</span><span class="p">:</span>

            <span class="n">outputs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">artifact_class</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="n">view</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">view</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outputs_</span><span class="p">)</span>

        <span class="n">passed_n</span><span class="p">,</span> <span class="n">expected_n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_sig_</span><span class="o">.</span><span class="n">return_annotation</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">passed_n</span> <span class="o">!=</span> <span class="n">expected_n</span><span class="p">:</span>

            <span class="n">ret_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_sig_</span><span class="o">.</span><span class="n">return_annotation</span><span class="p">])</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_class_key_</span><span class="si">}</span><span class="s2">.out() - expected </span><span class="si">{</span><span class="n">expected_n</span><span class="si">}</span><span class="s2"> arguments of (</span><span class="si">{</span><span class="n">ret_str</span><span class="si">}</span><span class="s2">), but got: </span><span class="si">{</span><span class="n">outputs</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="p">)</span>

        <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">artifact</span><span class="p">:</span> <span class="n">Artifact</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ord</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Artifact</span><span class="p">:</span>

            <span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outputs_</span><span class="p">[</span><span class="nb">ord</span><span class="p">]</span>

            <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_class_key_</span><span class="si">}</span><span class="s2">.out() </span><span class="si">{</span><span class="n">ordinal</span><span class="p">(</span><span class="nb">ord</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2"> argument&quot;</span><span class="p">):</span>

                <span class="n">view</span><span class="o">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">artifact</span><span class="o">.</span><span class="n">producer_output</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">artifact</span><span class="si">}</span><span class="s2"> is produced by </span><span class="si">{</span><span class="n">artifact</span><span class="o">.</span><span class="n">producer_output</span><span class="o">.</span><span class="n">producer</span><span class="si">}</span><span class="s2">!&quot;</span>

                    <span class="p">)</span>

            <span class="k">return</span> <span class="n">artifact</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>

                <span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;producer_output&quot;</span><span class="p">:</span> <span class="n">ProducerOutput</span><span class="p">(</span><span class="n">producer</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="nb">ord</span><span class="p">)}</span>

            <span class="p">)</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">validate</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">artifact</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

            <span class="k">return</span> <span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">outputs</span>

<span class="k">def</span> <span class="nf">producer</span><span class="p">(</span>

    <span class="o">*</span><span class="p">,</span>

    <span class="n">annotations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Annotation</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="nb">map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MapSig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="n">validate_outputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ValidateSig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Version</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">BuildSig</span><span class="p">],</span> <span class="nb">type</span><span class="p">[</span><span class="n">Producer</span><span class="p">]]:</span>

    <span class="k">def</span> <span class="nf">decorate</span><span class="p">(</span><span class="n">build</span><span class="p">:</span> <span class="n">BuildSig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">Producer</span><span class="p">]:</span>

        <span class="k">nonlocal</span> <span class="n">name</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">name</span>

        <span class="vm">__annotations__</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">signature</span><span class="p">(</span><span class="n">build</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

            <span class="k">with</span> <span class="n">wrap_exc</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> param&quot;</span><span class="p">):</span>

                <span class="n">view</span> <span class="o">=</span> <span class="n">View</span><span class="o">.</span><span class="n">from_annotation</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;READ&quot;</span><span class="p">)</span>

                <span class="vm">__annotations__</span><span class="p">[</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">artifact_class</span>

        <span class="c1"># If overriding, set an explicit &quot;annotations&quot; hint until [1] is released.</span>

        <span class="c1">#</span>

        <span class="c1"># 1: https://github.com/samuelcolvin/pydantic/pull/3018</span>

        <span class="k">if</span> <span class="n">annotations</span><span class="p">:</span>

            <span class="vm">__annotations__</span><span class="p">[</span><span class="s2">&quot;annotations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Annotation</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">version</span><span class="p">:</span>

            <span class="vm">__annotations__</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Version</span>

        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span>

            <span class="n">name</span><span class="p">,</span>

            <span class="p">(</span><span class="n">Producer</span><span class="p">,),</span>

            <span class="p">{</span>

                <span class="n">k</span><span class="p">:</span> <span class="n">v</span>

                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">{</span>

                    <span class="s2">&quot;__annotations__&quot;</span><span class="p">:</span> <span class="vm">__annotations__</span><span class="p">,</span>

                    <span class="s2">&quot;__module__&quot;</span><span class="p">:</span> <span class="n">get_module_name</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># Not our module, but our caller&#39;s.</span>

                    <span class="s2">&quot;annotations&quot;</span><span class="p">:</span> <span class="n">annotations</span><span class="p">,</span>

                    <span class="s2">&quot;build&quot;</span><span class="p">:</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">build</span><span class="p">),</span>

                    <span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="kc">None</span> <span class="k">if</span> <span class="nb">map</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="nb">map</span><span class="p">),</span>

                    <span class="s2">&quot;validate_outputs&quot;</span><span class="p">:</span> <span class="p">(</span>

                        <span class="kc">None</span> <span class="k">if</span> <span class="n">validate_outputs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">validate_outputs</span><span class="p">)</span>

                    <span class="p">),</span>

                    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>

                <span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

            <span class="p">},</span>

        <span class="p">)</span>

    <span class="k">return</span> <span class="n">decorate</span>

<span class="k">class</span> <span class="nc">ProducerOutput</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">producer</span><span class="p">:</span> <span class="n">Producer</span>

    <span class="n">position</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># TODO: Support named output (defaulting to artifact classname?)</span>

<span class="n">Artifact</span><span class="o">.</span><span class="n">update_forward_refs</span><span class="p">(</span><span class="n">ProducerOutput</span><span class="o">=</span><span class="n">ProducerOutput</span><span class="p">)</span>
</code></pre></div>

</details>
<h2 id="variables">Variables</h2>
<div class="codehilite"><pre><span></span><code><span class="n">TYPE_CHECKING</span>
</code></pre></div>

<h2 id="functions">Functions</h2>
<h3 id="producer">producer</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">producer</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">annotations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">Annotation</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="nb">map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">arti</span><span class="o">.</span><span class="n">partitions</span><span class="o">.</span><span class="n">PartitionKey</span><span class="p">],</span> <span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">StoragePartition</span><span class="p">,</span> <span class="o">...</span><span class="p">]]]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validate_outputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">versions</span><span class="o">.</span><span class="n">Version</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Callable</span><span class="p">[[</span><span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]],</span> <span class="nb">type</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">producers</span><span class="o">.</span><span class="n">Producer</span><span class="p">]]</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">producer</span><span class="p">(</span>

<span class="w">    </span><span class="o">*</span><span class="p">,</span>

<span class="w">    </span><span class="nl">annotations</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">tuple[Annotation, ...</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="k">map</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">MapSig</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">validate_outputs</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">ValidateSig</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Version</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Callable</span><span class="o">[</span><span class="n">[BuildSig</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">Producer</span><span class="o">]</span><span class="err">]:</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">decorate</span><span class="p">(</span><span class="nl">build</span><span class="p">:</span><span class="w"> </span><span class="n">BuildSig</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">Producer</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="n">nonlocal</span><span class="w"> </span><span class="n">name</span>

<span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">build</span><span class="p">.</span><span class="n">__name__</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">name</span>

<span class="w">        </span><span class="nl">__annotations__</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">param</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">signature</span><span class="p">(</span><span class="n">build</span><span class="p">).</span><span class="k">parameters</span><span class="p">.</span><span class="k">values</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot;{name} {param.name} param&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">from_annotation</span><span class="p">(</span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="ss">&quot;READ&quot;</span><span class="p">)</span>

<span class="w">                </span><span class="n">__annotations__</span><span class="o">[</span><span class="n">param.name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">view</span><span class="p">.</span><span class="n">artifact_class</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">overriding</span><span class="p">,</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="ss">&quot;annotations&quot;</span><span class="w"> </span><span class="n">hint</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">released</span><span class="p">.</span>

<span class="w">        </span><span class="err">#</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">samuelcolvin</span><span class="o">/</span><span class="n">pydantic</span><span class="o">/</span><span class="n">pull</span><span class="o">/</span><span class="mi">3018</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">annotations</span><span class="p">:</span>

<span class="w">            </span><span class="n">__annotations__</span><span class="o">[</span><span class="n">&quot;annotations&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">Annotation, ...</span><span class="o">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">version</span><span class="p">:</span>

<span class="w">            </span><span class="n">__annotations__</span><span class="o">[</span><span class="n">&quot;version&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Version</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">(</span>

<span class="w">            </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="p">(</span><span class="n">Producer</span><span class="p">,),</span>

<span class="w">            </span><span class="err">{</span>

<span class="w">                </span><span class="nl">k</span><span class="p">:</span><span class="w"> </span><span class="n">v</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="err">{</span>

<span class="w">                    </span><span class="ss">&quot;__annotations__&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">__annotations__</span><span class="p">,</span>

<span class="w">                    </span><span class="ss">&quot;__module__&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">get_module_name</span><span class="p">(</span><span class="k">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="ow">Not</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="k">module</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">caller</span><span class="err">&#39;</span><span class="n">s</span><span class="p">.</span>

<span class="w">                    </span><span class="ss">&quot;annotations&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">annotations</span><span class="p">,</span>

<span class="w">                    </span><span class="ss">&quot;build&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">(</span><span class="n">build</span><span class="p">),</span>

<span class="w">                    </span><span class="ss">&quot;map&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">(</span><span class="k">map</span><span class="p">),</span>

<span class="w">                    </span><span class="ss">&quot;validate_outputs&quot;</span><span class="err">:</span><span class="w"> </span><span class="p">(</span>

<span class="w">                        </span><span class="k">None</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">validate_outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">(</span><span class="n">validate_outputs</span><span class="p">)</span>

<span class="w">                    </span><span class="p">),</span>

<span class="w">                    </span><span class="ss">&quot;version&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">version</span><span class="p">,</span>

<span class="w">                </span><span class="err">}</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span>

<span class="w">            </span><span class="err">}</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">decorate</span>
</code></pre></div>

</details>
<h2 id="classes">Classes</h2>
<h3 id="buildinputs">BuildInputs</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BuildInputs</span><span class="p">(</span>
    <span class="n">arg</span><span class="p">:</span> <span class="s1">&#39;Union[Mapping[_K, _V], Iterable[tuple[_K, _V]]]&#39;</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;_V&#39;</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span><span class="n">Mapping</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">arg</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Mapping[_K, _V</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">Iterable</span><span class="o">[</span><span class="n">tuple[_K, _V</span><span class="o">]</span><span class="err">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(),</span><span class="w"> </span><span class="o">**</span><span class="nl">kwargs</span><span class="p">:</span><span class="w"> </span><span class="n">_V</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Eagerly</span><span class="w"> </span><span class="n">evaluate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">confirm</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">frozen</span><span class="w"> </span><span class="p">(</span><span class="n">via</span><span class="w"> </span><span class="n">frozenset</span><span class="p">)</span><span class="w"> </span><span class="k">at</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">creation</span><span class="w"> </span><span class="nc">time</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">hashed</span><span class="p">.</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hash</span><span class="p">(</span><span class="n">frozenset</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">.</span><span class="n">items</span><span class="p">()))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__getitem__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="n">_K</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">_V</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="o">[</span><span class="n">key</span><span class="o">]</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__hash__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_hash</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__iter__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="o">[</span><span class="n">_K</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">iter</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__len__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__or__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">other</span><span class="p">:</span><span class="w"> </span><span class="n">Mapping</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">self</span><span class="p">)(</span><span class="err">{</span><span class="o">**</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">other</span><span class="err">}</span><span class="p">)</span>

<span class="w">    </span><span class="n">__ror__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__or__</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">repr</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.utils.frozendict</li>
<li>collections.abc.Mapping</li>
<li>collections.abc.Collection</li>
<li>collections.abc.Sized</li>
<li>collections.abc.Iterable</li>
<li>collections.abc.Container</li>
</ul>
<h4 id="methods">Methods</h4>
<h4 id="get">get</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">key</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>D.get(k[,d]) -&gt; D[k] if k in D, else d.  d defaults to None.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">get</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">=</span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="s1">&#39;D.get(k[,d]) -&gt; D[k] if k in D, else d.  d defaults to None.&#39;</span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="o">[</span><span class="n">key</span><span class="o">]</span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="nl">KeyError</span><span class="p">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">default</span>
</code></pre></div>

</details>
<h4 id="items">items</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>D.items() -&gt; a set-like object providing a view on D's items</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">items</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;D.items() -&gt; a set-like object providing a view on D&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">items</span><span class="s">&quot;</span>

<span class="s">        return ItemsView(self)</span>
</code></pre></div>

</details>
<h4 id="keys">keys</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">keys</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>D.keys() -&gt; a set-like object providing a view on D's keys</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">keys</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;D.keys() -&gt; a set-like object providing a view on D&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">keys</span><span class="s">&quot;</span>

<span class="s">        return KeysView(self)</span>
</code></pre></div>

</details>
<h4 id="values">values</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">values</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>D.values() -&gt; an object providing a view on D's values</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">values</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;D.values() -&gt; an object providing a view on D&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">values</span><span class="s">&quot;</span>

<span class="s">        return ValuesView(self)</span>
</code></pre></div>

</details>
<h3 id="buildsig">BuildSig</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BuildSig</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="ancestors-in-mro_1">Ancestors (in MRO)</h4>
<ul>
<li>collections.abc.Callable</li>
</ul>
<h3 id="inputpartitions">InputPartitions</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">InputPartitions</span><span class="p">(</span>
    <span class="n">arg</span><span class="p">:</span> <span class="s1">&#39;Union[Mapping[_K, _V], Iterable[tuple[_K, _V]]]&#39;</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;_V&#39;</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span><span class="n">Mapping</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">arg</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Mapping[_K, _V</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">Iterable</span><span class="o">[</span><span class="n">tuple[_K, _V</span><span class="o">]</span><span class="err">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(),</span><span class="w"> </span><span class="o">**</span><span class="nl">kwargs</span><span class="p">:</span><span class="w"> </span><span class="n">_V</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Eagerly</span><span class="w"> </span><span class="n">evaluate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">confirm</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">frozen</span><span class="w"> </span><span class="p">(</span><span class="n">via</span><span class="w"> </span><span class="n">frozenset</span><span class="p">)</span><span class="w"> </span><span class="k">at</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">creation</span><span class="w"> </span><span class="nc">time</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">hashed</span><span class="p">.</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hash</span><span class="p">(</span><span class="n">frozenset</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">.</span><span class="n">items</span><span class="p">()))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__getitem__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="n">_K</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">_V</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="o">[</span><span class="n">key</span><span class="o">]</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__hash__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_hash</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__iter__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="o">[</span><span class="n">_K</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">iter</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__len__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__or__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">other</span><span class="p">:</span><span class="w"> </span><span class="n">Mapping</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">self</span><span class="p">)(</span><span class="err">{</span><span class="o">**</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">other</span><span class="err">}</span><span class="p">)</span>

<span class="w">    </span><span class="n">__ror__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__or__</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">repr</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_2">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.utils.frozendict</li>
<li>collections.abc.Mapping</li>
<li>collections.abc.Collection</li>
<li>collections.abc.Sized</li>
<li>collections.abc.Iterable</li>
<li>collections.abc.Container</li>
</ul>
<h4 id="methods_1">Methods</h4>
<h4 id="get_1">get</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">key</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>D.get(k[,d]) -&gt; D[k] if k in D, else d.  d defaults to None.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">get</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">=</span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="s1">&#39;D.get(k[,d]) -&gt; D[k] if k in D, else d.  d defaults to None.&#39;</span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="o">[</span><span class="n">key</span><span class="o">]</span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="nl">KeyError</span><span class="p">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">default</span>
</code></pre></div>

</details>
<h4 id="items_1">items</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>D.items() -&gt; a set-like object providing a view on D's items</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">items</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;D.items() -&gt; a set-like object providing a view on D&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">items</span><span class="s">&quot;</span>

<span class="s">        return ItemsView(self)</span>
</code></pre></div>

</details>
<h4 id="keys_1">keys</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">keys</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>D.keys() -&gt; a set-like object providing a view on D's keys</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">keys</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;D.keys() -&gt; a set-like object providing a view on D&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">keys</span><span class="s">&quot;</span>

<span class="s">        return KeysView(self)</span>
</code></pre></div>

</details>
<h4 id="values_1">values</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">values</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>D.values() -&gt; an object providing a view on D's values</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">values</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;D.values() -&gt; an object providing a view on D&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">values</span><span class="s">&quot;</span>

<span class="s">        return ValuesView(self)</span>
</code></pre></div>

</details>
<h3 id="mapinputs">MapInputs</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MapInputs</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="ancestors-in-mro_3">Ancestors (in MRO)</h4>
<ul>
<li>builtins.set</li>
</ul>
<h4 id="methods_2">Methods</h4>
<h4 id="add">add</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Add an element to a set.</p>
<p>This has no effect if the element is already present.</p>
<h4 id="clear">clear</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">clear</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove all elements from this set.</p>
<h4 id="copy">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Return a shallow copy of a set.</p>
<h4 id="difference">difference</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">difference</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Return the difference of two or more sets as a new set.</p>
<p>(i.e. all elements that are in this set but not the others.)</p>
<h4 id="difference_update">difference_update</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">difference_update</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove all elements of another set from this set.</p>
<h4 id="discard">discard</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">discard</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove an element from a set if it is a member.</p>
<p>If the element is not a member, do nothing.</p>
<h4 id="intersection">intersection</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">intersection</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Return the intersection of two sets as a new set.</p>
<p>(i.e. all elements that are in both sets.)</p>
<h4 id="intersection_update">intersection_update</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">intersection_update</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Update a set with the intersection of itself and another.</p>
<h4 id="isdisjoint">isdisjoint</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">isdisjoint</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Return True if two sets have a null intersection.</p>
<h4 id="issubset">issubset</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">issubset</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Report whether another set contains this set.</p>
<h4 id="issuperset">issuperset</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">issuperset</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Report whether this set contains another set.</p>
<h4 id="pop">pop</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">pop</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove and return an arbitrary set element.</p>
<p>Raises KeyError if the set is empty.</p>
<h4 id="remove">remove</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">remove</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Remove an element from a set; it must be a member.</p>
<p>If the element is not a member, raise a KeyError.</p>
<h4 id="symmetric_difference">symmetric_difference</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">symmetric_difference</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Return the symmetric difference of two sets as a new set.</p>
<p>(i.e. all elements that are in exactly one of the sets.)</p>
<h4 id="symmetric_difference_update">symmetric_difference_update</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">symmetric_difference_update</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Update a set with the symmetric difference of itself and another.</p>
<h4 id="union">union</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">union</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Return the union of sets as a new set.</p>
<p>(i.e. all elements that are in either set.)</p>
<h4 id="update">update</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<p>Update a set with the union of itself and others.</p>
<h3 id="mapsig">MapSig</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MapSig</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="ancestors-in-mro_4">Ancestors (in MRO)</h4>
<ul>
<li>collections.abc.Callable</li>
</ul>
<h3 id="outputs">Outputs</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Outputs</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="ancestors-in-mro_5">Ancestors (in MRO)</h4>
<ul>
<li>builtins.tuple</li>
</ul>
<h4 id="methods_3">Methods</h4>
<h4 id="count">count</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">count</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">value</span><span class="p">,</span>
    <span class="o">/</span>
<span class="p">)</span>
</code></pre></div>

<p>Return number of occurrences of value.</p>
<h4 id="index">index</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">index</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">value</span><span class="p">,</span>
    <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">stop</span><span class="o">=</span><span class="mi">9223372036854775807</span><span class="p">,</span>
    <span class="o">/</span>
<span class="p">)</span>
</code></pre></div>

<p>Return first index of value.</p>
<p>Raises ValueError if the value is not present.</p>
<h3 id="partitiondependencies">PartitionDependencies</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PartitionDependencies</span><span class="p">(</span>
    <span class="n">arg</span><span class="p">:</span> <span class="s1">&#39;Union[Mapping[_K, _V], Iterable[tuple[_K, _V]]]&#39;</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;_V&#39;</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span><span class="n">Mapping</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">arg</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Mapping[_K, _V</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">Iterable</span><span class="o">[</span><span class="n">tuple[_K, _V</span><span class="o">]</span><span class="err">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(),</span><span class="w"> </span><span class="o">**</span><span class="nl">kwargs</span><span class="p">:</span><span class="w"> </span><span class="n">_V</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Eagerly</span><span class="w"> </span><span class="n">evaluate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">confirm</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">frozen</span><span class="w"> </span><span class="p">(</span><span class="n">via</span><span class="w"> </span><span class="n">frozenset</span><span class="p">)</span><span class="w"> </span><span class="k">at</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">creation</span><span class="w"> </span><span class="nc">time</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">hashed</span><span class="p">.</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hash</span><span class="p">(</span><span class="n">frozenset</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">.</span><span class="n">items</span><span class="p">()))</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__getitem__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="n">_K</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">_V</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="o">[</span><span class="n">key</span><span class="o">]</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__hash__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_hash</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__iter__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="o">[</span><span class="n">_K</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">iter</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__len__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__or__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">other</span><span class="p">:</span><span class="w"> </span><span class="n">Mapping</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">_K, _V</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">self</span><span class="p">)(</span><span class="err">{</span><span class="o">**</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">other</span><span class="err">}</span><span class="p">)</span>

<span class="w">    </span><span class="n">__ror__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__or__</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">repr</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_data</span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_6">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.utils.frozendict</li>
<li>collections.abc.Mapping</li>
<li>collections.abc.Collection</li>
<li>collections.abc.Sized</li>
<li>collections.abc.Iterable</li>
<li>collections.abc.Container</li>
</ul>
<h4 id="methods_4">Methods</h4>
<h4 id="get_2">get</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">key</span><span class="p">,</span>
    <span class="n">default</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>D.get(k[,d]) -&gt; D[k] if k in D, else d.  d defaults to None.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">get</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="k">default</span><span class="o">=</span><span class="k">None</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="s1">&#39;D.get(k[,d]) -&gt; D[k] if k in D, else d.  d defaults to None.&#39;</span>

<span class="w">        </span><span class="k">try</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="o">[</span><span class="n">key</span><span class="o">]</span>

<span class="w">        </span><span class="ow">except</span><span class="w"> </span><span class="nl">KeyError</span><span class="p">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">default</span>
</code></pre></div>

</details>
<h4 id="items_2">items</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>D.items() -&gt; a set-like object providing a view on D's items</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">items</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;D.items() -&gt; a set-like object providing a view on D&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">items</span><span class="s">&quot;</span>

<span class="s">        return ItemsView(self)</span>
</code></pre></div>

</details>
<h4 id="keys_2">keys</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">keys</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>D.keys() -&gt; a set-like object providing a view on D's keys</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">keys</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;D.keys() -&gt; a set-like object providing a view on D&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">keys</span><span class="s">&quot;</span>

<span class="s">        return KeysView(self)</span>
</code></pre></div>

</details>
<h4 id="values_2">values</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">values</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<p>D.values() -&gt; an object providing a view on D's values</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">values</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;D.values() -&gt; an object providing a view on D&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">values</span><span class="s">&quot;</span>

<span class="s">        return ValuesView(self)</span>
</code></pre></div>

</details>
<h3 id="producer_1">Producer</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Producer</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Producer</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;A Producer is a task that builds one or more Artifacts.&quot;&quot;&quot;</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">fields</span><span class="o">/</span><span class="n">methods</span>

<span class="w">    </span><span class="nl">annotations</span><span class="p">:</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">Annotation, ...</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span>

<span class="w">    </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="n">Version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SemVer</span><span class="p">(</span><span class="n">major</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">minor</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">patch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">map</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">validate_outputs</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">dynamic</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">subclasses</span><span class="p">,</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">however</span><span class="w"> </span><span class="n">mypy</span><span class="w"> </span><span class="n">doesn</span><span class="s1">&#39;t like the &quot;incompatible&quot; signature on subclasses if actually defined here</span>

<span class="s1">    # (nor support ParamSpec yet). `map` is generated during subclassing if not set, `build` is</span>

<span class="s1">    # required, and `validate_outputs` defaults to no-op checks (hence is the only one with a</span>

<span class="s1">    # provided method).</span>

<span class="s1">    #</span>

<span class="s1">    # These must be @classmethods or @staticmethods.</span>

<span class="s1">    map: ClassVar[MapSig]</span>

<span class="s1">    build: ClassVar[BuildSig]</span>

<span class="s1">    if TYPE_CHECKING:</span>

<span class="s1">        validate_outputs: ClassVar[ValidateSig]</span>

<span class="s1">    else:</span>

<span class="s1">        @staticmethod</span>

<span class="s1">        def validate_outputs(*outputs: Any) -&gt; Union[bool, tuple[bool, str]]:</span>

<span class="s1">            &quot;&quot;&quot;Validate the `Producer.build` outputs, returning the status and a message.</span>

<span class="s1">            The validation status is applied to all outputs. If validation does not pass, the</span>

<span class="s1">            outputs will not be written to storage to prevent checkpointing the output. In the</span>

<span class="s1">            future, we may still write the data to ease debugging, but track validation status in</span>

<span class="s1">            the Backend (preventing downstream use).</span>

<span class="s1">            The arguments must not be mutated.</span>

<span class="s1">            The parameters must be usable with positional argument. The output of `build` will be</span>

<span class="s1">            passed in as it was returned, for example: `def build(...): return 1, 2` will result in</span>

<span class="s1">            `validate_outputs(1, 2)`.</span>

<span class="s1">            NOTE: `validate_outputs` is a stopgap until Statistics and Thresholds are fully implemented.</span>

<span class="s1">            &quot;&quot;&quot;</span>

<span class="s1">            return True, &quot;No validation performed.&quot;</span>

<span class="s1">    # Internal fields/methods</span>

<span class="s1">    _abstract_: ClassVar[bool] = True</span>

<span class="s1">    _fingerprint_excludes_ = frozenset([&quot;annotations&quot;])</span>

<span class="s1">    # NOTE: The following are set in __init_subclass__</span>

<span class="s1">    _input_artifact_classes_: ClassVar[frozendict[str, type[Artifact]]]</span>

<span class="s1">    _build_inputs_: ClassVar[BuildInputs]</span>

<span class="s1">    _build_sig_: ClassVar[Signature]</span>

<span class="s1">    _map_inputs_: ClassVar[MapInputs]</span>

<span class="s1">    _map_sig_: ClassVar[Signature]</span>

<span class="s1">    _outputs_: ClassVar[Outputs]</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def __init_subclass__(cls, **kwargs: Any) -&gt; None:</span>

<span class="s1">        super().__init_subclass__(**kwargs)</span>

<span class="s1">        if not cls._abstract_:</span>

<span class="s1">            with wrap_exc(ValueError, prefix=cls.__name__):</span>

<span class="s1">                cls._input_artifact_classes_ = cls._validate_fields()</span>

<span class="s1">                with wrap_exc(ValueError, prefix=&quot;.build&quot;):</span>

<span class="s1">                    (</span>

<span class="s1">                        cls._build_sig_,</span>

<span class="s1">                        cls._build_inputs_,</span>

<span class="s1">                        cls._outputs_,</span>

<span class="s1">                    ) = cls._validate_build_sig()</span>

<span class="s1">                with wrap_exc(ValueError, prefix=&quot;.validate_output&quot;):</span>

<span class="s1">                    cls._validate_validate_output_sig()</span>

<span class="s1">                with wrap_exc(ValueError, prefix=&quot;.map&quot;):</span>

<span class="s1">                    cls._map_sig_, cls._map_inputs_ = cls._validate_map_sig()</span>

<span class="s1">                cls._validate_no_unused_fields()</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_fields(cls) -&gt; frozendict[str, type[Artifact]]:</span>

<span class="s1">        # NOTE: Aside from the base producer fields, all others should (currently) be Artifacts.</span>

<span class="s1">        #</span>

<span class="s1">        # Users can set additional class attributes, but they must be properly hinted as ClassVars.</span>

<span class="s1">        # These won&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">interact</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">&quot;framework&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="s1">&#39;t be parameters to build/map.</span>

<span class="s1">        artifact_fields = {k: v for k, v in cls.__fields__.items() if k not in Producer.__fields__}</span>

<span class="s1">        for name, field in artifact_fields.items():</span>

<span class="s1">            with wrap_exc(ValueError, prefix=f&quot;.{name}&quot;):</span>

<span class="s1">                if not (field.default is None and field.default_factory is None and field.required):</span>

<span class="s1">                    raise ValueError(&quot;field must not have a default nor be Optional.&quot;)</span>

<span class="s1">                if not lenient_issubclass(field.outer_type_, Artifact):</span>

<span class="s1">                    raise ValueError(</span>

<span class="s1">                        f&quot;type hint must be an Artifact subclass, got: {field.outer_type_}&quot;</span>

<span class="s1">                    )</span>

<span class="s1">        return frozendict({name: field.outer_type_ for name, field in artifact_fields.items()})</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_parameters(</span>

<span class="s1">        cls, sig: Signature, *, validator: Callable[[str, Parameter], _T]</span>

<span class="s1">    ) -&gt; Iterator[_T]:</span>

<span class="s1">        if undefined_params := set(sig.parameters) - set(cls._input_artifact_classes_):</span>

<span class="s1">            raise ValueError(</span>

<span class="s1">                f&quot;the following parameter(s) must be defined as a field: {undefined_params}&quot;</span>

<span class="s1">            )</span>

<span class="s1">        for name, param in sig.parameters.items():</span>

<span class="s1">            with wrap_exc(ValueError, prefix=f&quot; {name} param&quot;):</span>

<span class="s1">                if param.annotation is param.empty:</span>

<span class="s1">                    raise ValueError(&quot;must have a type hint.&quot;)</span>

<span class="s1">                if param.default is not param.empty:</span>

<span class="s1">                    raise ValueError(&quot;must not have a default.&quot;)</span>

<span class="s1">                if param.kind not in (param.POSITIONAL_OR_KEYWORD, param.KEYWORD_ONLY):</span>

<span class="s1">                    raise ValueError(&quot;must be usable as a keyword argument.&quot;)</span>

<span class="s1">                yield validator(name, param)</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_build_param(cls, name: str, param: Parameter) -&gt; tuple[str, View]:</span>

<span class="s1">        annotation = param.annotation</span>

<span class="s1">        field_artifact_class = cls._input_artifact_classes_[param.name]</span>

<span class="s1">        # If there is no Artifact hint, add in the field value as the default.</span>

<span class="s1">        if get_item_from_annotated(annotation, Artifact, is_subclass=True) is None:</span>

<span class="s1">            annotation = Annotated[annotation, field_artifact_class]</span>

<span class="s1">        view = View.from_annotation(annotation, mode=&quot;READ&quot;)</span>

<span class="s1">        if view.artifact_class != field_artifact_class:</span>

<span class="s1">            raise ValueError(</span>

<span class="s1">                f&quot;annotation Artifact class ({view.artifact_class}) does not match that set on the field ({field_artifact_class}).&quot;</span>

<span class="s1">            )</span>

<span class="s1">        return name, view</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_build_sig_return(cls, annotation: Any, *, i: int) -&gt; View:</span>

<span class="s1">        with wrap_exc(ValueError, prefix=f&quot; {ordinal(i+1)} return&quot;):</span>

<span class="s1">            return View.from_annotation(annotation, mode=&quot;WRITE&quot;)</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_build_sig(cls) -&gt; tuple[Signature, BuildInputs, Outputs]:</span>

<span class="s1">        &quot;&quot;&quot;Validate the .build method&quot;&quot;&quot;</span>

<span class="s1">        if not hasattr(cls, &quot;build&quot;):</span>

<span class="s1">            raise ValueError(&quot;must be implemented&quot;)</span>

<span class="s1">        if not isinstance(getattr_static(cls, &quot;build&quot;), (classmethod, staticmethod)):</span>

<span class="s1">            raise ValueError(&quot;must be a @classmethod or @staticmethod&quot;)</span>

<span class="s1">        build_sig = signature(cls.build, force_tuple_return=True, remove_owner=True)</span>

<span class="s1">        # Validate the parameters</span>

<span class="s1">        build_inputs = BuildInputs(</span>

<span class="s1">            cls._validate_parameters(build_sig, validator=cls._validate_build_param)</span>

<span class="s1">        )</span>

<span class="s1">        # Validate the return definition</span>

<span class="s1">        return_annotation = build_sig.return_annotation</span>

<span class="s1">        if return_annotation is build_sig.empty:</span>

<span class="s1">            # TODO: &quot;side effect&quot; Producers: https://github.com/artigraph/artigraph/issues/11</span>

<span class="s1">            raise ValueError(&quot;a return value must be set with the output Artifact(s).&quot;)</span>

<span class="s1">        if return_annotation == (NoneType,):</span>

<span class="s1">            raise ValueError(&quot;missing return signature&quot;)</span>

<span class="s1">        outputs = Outputs(</span>

<span class="s1">            cls._validate_build_sig_return(annotation, i=i)</span>

<span class="s1">            for i, annotation in enumerate(return_annotation)</span>

<span class="s1">        )</span>

<span class="s1">        # Validate all outputs have equivalent partitioning schemes.</span>

<span class="s1">        #</span>

<span class="s1">        # We currently require the partition key type *and* name to match, but in the future we</span>

<span class="s1">        # might be able to extend the dependency metadata to support heterogeneous names if</span>

<span class="s1">        # necessary.</span>

<span class="s1">        seen_key_types = {PartitionKey.types_from(view.type) for view in outputs}</span>

<span class="s1">        if len(seen_key_types) != 1:</span>

<span class="s1">            raise ValueError(&quot;all outputs must have the same partitioning scheme&quot;)</span>

<span class="s1">        return build_sig, build_inputs, outputs</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_validate_output_sig(cls) -&gt; None:</span>

<span class="s1">        build_output_hints = [</span>

<span class="s1">            get_args(hint)[0] if get_origin(hint) is Annotated else hint</span>

<span class="s1">            for hint in cls._build_sig_.return_annotation</span>

<span class="s1">        ]</span>

<span class="s1">        match_build_str = f&quot;match the `.build` return (`{build_output_hints}`)&quot;</span>

<span class="s1">        validate_parameters = signature(cls.validate_outputs).parameters</span>

<span class="s1">        def param_matches(param: Parameter, build_return: type) -&gt; bool:</span>

<span class="s1">            # Skip checking non-hinted parameters to allow lambdas.</span>

<span class="s1">            #</span>

<span class="s1">            # NOTE: Parameter type hints are *contravariant* (you can&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ss">&quot;Manager&quot;</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">a</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">expecting</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="ss">&quot;Employee&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">hence</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">build_return</span><span class="w"> </span><span class="k">as</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subtype</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">supertype</span><span class="p">.</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">empty</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="p">(</span>

<span class="w">                </span><span class="n">build_return</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Allow</span><span class="w"> </span><span class="err">`</span><span class="o">*</span><span class="nl">args</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="err">`</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">`</span><span class="o">*</span><span class="nl">args</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">build</span><span class="p">(...)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">T, ...</span><span class="o">]</span><span class="err">`</span>

<span class="w">            </span><span class="nf">len</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>

<span class="w">            </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">param</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">.</span><span class="k">values</span><span class="p">())</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">).</span><span class="n">kind</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">VAR_POSITIONAL</span>

<span class="w">        </span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">all</span><span class="p">(</span><span class="n">param_matches</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="w"> </span><span class="n">output_hint</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">output_hint</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">build_output_hints</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot; {param.name} param&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;type hint must be `Any` or {match_build_str}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Otherwise</span><span class="p">,</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">pairwise</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">build_output_hints</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;must {match_build_str}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">.</span><span class="n">items</span><span class="p">())</span><span class="err">:</span>

<span class="w">                </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot; {name} param&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="k">default</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="nl">empty</span><span class="p">:</span>

<span class="w">                        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;must not have a default.&quot;</span><span class="p">)</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="n">param</span><span class="p">.</span><span class="n">POSITIONAL_ONLY</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">)</span><span class="err">:</span>

<span class="w">                        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;must be usable as a positional argument.&quot;</span><span class="p">)</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">param_matches</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">expected</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">build_output_hints</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">))</span><span class="err">:</span>

<span class="w">                        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                            </span><span class="n">f</span><span class="ss">&quot;type hint must match the {ordinal(i+1)} `.build` return (`{expected}`)&quot;</span>

<span class="w">                        </span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Validate</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">signature</span><span class="vm">?</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_map_param</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">param</span><span class="p">:</span><span class="w"> </span><span class="k">Parameter</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Should</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="ow">some</span><span class="w"> </span><span class="n">ArtifactPartition</span><span class="o">[</span><span class="n">MyArtifact</span><span class="o">]</span><span class="w"> </span><span class="n">type</span><span class="vm">?</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">StoragePartitions</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;type hint must be `StoragePartitions`&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">name</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_map_sig</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">Signature, MapInputs</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Validate partitioned Artifacts and the .map method&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">hasattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;map&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">runtime</span><span class="w"> </span><span class="n">checking</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="err">`</span><span class="k">map</span><span class="err">`</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="p">(</span><span class="nl">ie</span><span class="p">:</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="n">aligns</span><span class="w"> </span><span class="n">w</span><span class="o">/</span><span class="w"> </span><span class="k">output</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">artifacts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">such</span><span class="p">).</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">any</span><span class="p">(</span><span class="n">is_partitioned</span><span class="p">(</span><span class="k">view</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_outputs_</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;must be implemented when the `build` outputs are partitioned&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">def</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="o">**</span><span class="nl">kwargs</span><span class="p">:</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">PartitionDependencies</span><span class="p">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">PartitionDependencies</span><span class="p">(</span><span class="err">{</span><span class="nl">NotPartitioned</span><span class="p">:</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span><span class="err">}</span><span class="p">)</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">Narrow</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="n">signature</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">validated</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">graph</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="p">(</span><span class="n">via</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_map_inputs_</span><span class="p">)</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">map</span><span class="p">.</span>

<span class="w">            </span><span class="k">map</span><span class="p">.</span><span class="n">__signature__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Signature</span><span class="p">(</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="k">ignore</span><span class="o">[</span><span class="n">attr-defined</span><span class="o">]</span>

<span class="w">                </span><span class="o">[</span>

<span class="n">                    Parameter(name=name, annotation=StoragePartitions, kind=Parameter.KEYWORD_ONLY)</span>

<span class="n">                    for name, artifact in cls._input_artifact_classes_.items()</span>

<span class="n">                    if name in cls._build_inputs_</span>

<span class="n">                </span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="n">return_annotation</span><span class="o">=</span><span class="n">PartitionDependencies</span><span class="p">,</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">cls</span><span class="p">.</span><span class="k">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cast</span><span class="p">(</span><span class="n">MapSig</span><span class="p">,</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">(</span><span class="k">map</span><span class="p">))</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">getattr_static</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;map&quot;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">classmethod</span><span class="p">,</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">))</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;must be a @classmethod or @staticmethod&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">map_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">signature</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="k">map</span><span class="p">)</span>

<span class="w">        </span><span class="n">map_inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MapInputs</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_validate_parameters</span><span class="p">(</span><span class="n">map_sig</span><span class="p">,</span><span class="w"> </span><span class="n">validator</span><span class="o">=</span><span class="n">cls</span><span class="p">.</span><span class="n">_validate_map_param</span><span class="p">))</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">map_sig</span><span class="p">,</span><span class="w"> </span><span class="n">map_inputs</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Verify</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="n">hint</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">TBD</span><span class="w"> </span><span class="n">spec</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_no_unused_fields</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">unused_fields</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_input_artifact_classes_</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span>

<span class="w">            </span><span class="k">set</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_build_sig_</span><span class="p">.</span><span class="k">parameters</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_map_sig_</span><span class="p">.</span><span class="k">parameters</span><span class="p">)</span>

<span class="w">        </span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;the following fields aren&#39;t used in `.build` or `.map`: {unused_fields}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">    </span><span class="nv">@validator</span><span class="p">(</span><span class="ss">&quot;*&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_instance_artifact_args</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="nl">field</span><span class="p">:</span><span class="w"> </span><span class="n">ModelField</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Artifact</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">view</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_build_inputs_</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">field</span><span class="p">.</span><span class="n">name</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="k">view</span><span class="p">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">value</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">pydantic</span><span class="w"> </span><span class="n">defines</span><span class="w"> </span><span class="p">.</span><span class="n">__iter__</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="err">`</span><span class="n">self</span><span class="p">.</span><span class="n">__dict__</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="err">`</span><span class="n">dict</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="err">`</span><span class="p">,</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">override</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">easy</span><span class="w"> </span><span class="n">expansion</span><span class="o">/</span><span class="n">assignment</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Graph</span><span class="w">  </span><span class="k">without</span><span class="w"> </span><span class="err">`</span><span class="p">.</span><span class="k">out</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="err">`</span><span class="n">g</span><span class="p">.</span><span class="n">artifacts</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">.</span><span class="n">artifacts</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyProducer</span><span class="p">(...)</span><span class="err">`</span><span class="p">).</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__iter__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="o">[</span><span class="n">Artifact</span><span class="o">]</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="k">ignore</span><span class="o">[</span><span class="n">override</span><span class="o">]</span>

<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">out</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span><span class="w"> </span><span class="n">tuple</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">,)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">iter</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">compute_input_fingerprint</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">dependency_partitions</span><span class="p">:</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">str, StoragePartitions</span><span class="o">]</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="n">input_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">dependency_partitions</span><span class="p">)</span>

<span class="w">        </span><span class="n">expected_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_build_inputs_</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">input_names</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">expected_names</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;Mismatched dependency inputs; expected {expected_names}, got {input_names}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">care</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">*</span><span class="n">code</span><span class="o">*</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">*</span><span class="k">input</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">contents</span><span class="o">*</span><span class="w"> </span><span class="n">changed</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="k">file</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="p">(</span><span class="n">but</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">prior</span><span class="w"> </span><span class="n">run</span><span class="p">).</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_class_key_</span><span class="p">).</span><span class="n">combine</span><span class="p">(</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">version</span><span class="p">.</span><span class="n">fingerprint</span><span class="p">,</span>

<span class="w">            </span><span class="o">*</span><span class="p">(</span>

<span class="w">                </span><span class="k">partition</span><span class="p">.</span><span class="n">content_fingerprint</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">dependency_partitions</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">partitions</span>

<span class="w">            </span><span class="p">),</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">compute_dependencies</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">input_partitions</span><span class="p">:</span><span class="w"> </span><span class="n">InputPartitions</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">PartitionDependencies, InputFingerprints</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Validate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Producer</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">partitioning</span><span class="w"> </span><span class="n">scheme</span><span class="w"> </span><span class="ow">and</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="p">(</span><span class="n">basically</span><span class="p">,</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">error</span><span class="p">).</span><span class="w"> </span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">partitioned</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">expect</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="mi">1</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="w"> </span><span class="p">(</span><span class="n">NotPartitioned</span><span class="p">).</span>

<span class="w">        </span><span class="n">partition_dependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">map</span><span class="p">(</span>

<span class="w">            </span><span class="o">**</span><span class="err">{</span>

<span class="w">                </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">partitions</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">input_partitions</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_map_inputs_</span>

<span class="w">            </span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">partition_input_fingerprints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">(</span>

<span class="w">            </span><span class="err">{</span>

<span class="w">                </span><span class="nl">composite_key</span><span class="p">:</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">compute_input_fingerprint</span><span class="p">(</span><span class="n">dependency_partitions</span><span class="p">)</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">composite_key</span><span class="p">,</span><span class="w"> </span><span class="n">dependency_partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">            </span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="p">,</span><span class="w"> </span><span class="n">partition_input_fingerprints</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">inputs</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Artifact</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">{</span><span class="nl">k</span><span class="p">:</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_input_artifact_classes_</span><span class="err">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">out</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nl">outputs</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Artifact, tuple[Artifact, ...</span><span class="o">]</span><span class="err">]:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Configure the output Artifacts this Producer will build.</span>

<span class="ss">        The arguments are matched to the `Producer.build` return signature in order.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="k">view</span><span class="p">.</span><span class="n">artifact_class</span><span class="p">(</span><span class="n">type</span><span class="o">=</span><span class="k">view</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_outputs_</span><span class="p">)</span>

<span class="w">        </span><span class="n">passed_n</span><span class="p">,</span><span class="w"> </span><span class="n">expected_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">),</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_build_sig_</span><span class="p">.</span><span class="n">return_annotation</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">passed_n</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">expected_n</span><span class="p">:</span>

<span class="w">            </span><span class="n">ret_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;, &quot;</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="o">[</span><span class="n">str(v) for v in self._build_sig_.return_annotation</span><span class="o">]</span><span class="p">)</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;{self._class_key_}.out() - expected {expected_n} arguments of ({ret_str}), but got: {outputs}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">ord</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Artifact</span><span class="p">:</span>

<span class="w">            </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_outputs_</span><span class="o">[</span><span class="n">ord</span><span class="o">]</span>

<span class="w">            </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot;{self._class_key_}.out() {ordinal(ord+1)} argument&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">view</span><span class="p">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                        </span><span class="n">f</span><span class="ss">&quot;{artifact} is produced by {artifact.producer_output.producer}!&quot;</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span>

<span class="w">                </span><span class="k">update</span><span class="o">=</span><span class="err">{</span><span class="ss">&quot;producer_output&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">ProducerOutput</span><span class="p">(</span><span class="n">producer</span><span class="o">=</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">position</span><span class="o">=</span><span class="n">ord</span><span class="p">)</span><span class="err">}</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="n">validate</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">ord</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">outputs</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">outputs</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_7">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods">Static methods</h4>
<h4 id="construct">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="validate_outputs">validate_outputs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate_outputs</span><span class="p">(</span>
    <span class="o">*</span><span class="n">outputs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</code></pre></div>

<p>Validate the <code>Producer.build</code> outputs, returning the status and a message.</p>
<p>The validation status is applied to all outputs. If validation does not pass, the
outputs will not be written to storage to prevent checkpointing the output. In the
future, we may still write the data to ease debugging, but track validation status in
the Backend (preventing downstream use).</p>
<p>The arguments must not be mutated.</p>
<p>The parameters must be usable with positional argument. The output of <code>build</code> will be
passed in as it was returned, for example: <code>def build(...): return 1, 2</code> will result in
<code>validate_outputs(1, 2)</code>.</p>
<p>NOTE: <code>validate_outputs</code> is a stopgap until Statistics and Thresholds are fully implemented.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">        </span><span class="nv">@staticmethod</span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">validate_outputs</span><span class="p">(</span><span class="o">*</span><span class="n">outputs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">Union</span><span class="err">[</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="n">tuple</span><span class="err">[</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="err">]]</span><span class="o">:</span>

<span class="w">            </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Validate the `Producer.build` outputs, returning the status and a message.</span>

<span class="s2">            The validation status is applied to all outputs. If validation does not pass, the</span>

<span class="s2">            outputs will not be written to storage to prevent checkpointing the output. In the</span>

<span class="s2">            future, we may still write the data to ease debugging, but track validation status in</span>

<span class="s2">            the Backend (preventing downstream use).</span>

<span class="s2">            The arguments must not be mutated.</span>

<span class="s2">            The parameters must be usable with positional argument. The output of `build` will be</span>

<span class="s2">            passed in as it was returned, for example: `def build(...): return 1, 2` will result in</span>

<span class="s2">            `validate_outputs(1, 2)`.</span>

<span class="s2">            NOTE: `validate_outputs` is a stopgap until Statistics and Thresholds are fully implemented.</span>

<span class="s2">            </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;No validation performed.&quot;</span>
</code></pre></div>

</details>
<h4 id="instance-variables">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">inputs</span>
</code></pre></div>

<h4 id="methods_5">Methods</h4>
<h4 id="compute_dependencies">compute_dependencies</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_dependencies</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">input_partitions</span><span class="p">:</span> <span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">StoragePartition</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">arti</span><span class="o">.</span><span class="n">partitions</span><span class="o">.</span><span class="n">PartitionKey</span><span class="p">],</span> <span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">StoragePartition</span><span class="p">,</span> <span class="o">...</span><span class="p">]]],</span> <span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">arti</span><span class="o">.</span><span class="n">partitions</span><span class="o">.</span><span class="n">PartitionKey</span><span class="p">],</span> <span class="n">arti</span><span class="o">.</span><span class="n">fingerprints</span><span class="o">.</span><span class="n">Fingerprint</span><span class="p">]]</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">compute_dependencies</span><span class="p">(</span>

<span class="w">        </span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">input_partitions</span><span class="o">:</span><span class="w"> </span><span class="n">InputPartitions</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="p">[</span><span class="n">PartitionDependencies</span><span class="p">,</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">]</span><span class="o">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="o">:</span><span class="w"> </span><span class="kr">Validate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Producer</span><span class="s">&#39;s partitioning scheme and</span>

<span class="s">        # such (basically, check user error). eg: if output is not partitioned, we expect only 1</span>

<span class="s">        # entry in partition_dependencies (NotPartitioned).</span>

<span class="s">        partition_dependencies = self.map(</span>

<span class="s">            **{</span>

<span class="s">                name: partitions</span>

<span class="s">                for name, partitions in input_partitions.items()</span>

<span class="s">                if name in self._map_inputs_</span>

<span class="s">            }</span>

<span class="s">        )</span>

<span class="s">        partition_input_fingerprints = InputFingerprints(</span>

<span class="s">            {</span>

<span class="s">                composite_key: self.compute_input_fingerprint(dependency_partitions)</span>

<span class="s">                for composite_key, dependency_partitions in partition_dependencies.items()</span>

<span class="s">            }</span>

<span class="s">        )</span>

<span class="s">        return partition_dependencies, partition_input_fingerprints</span>
</code></pre></div>

</details>
<h4 id="compute_input_fingerprint">compute_input_fingerprint</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_input_fingerprint</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dependency_partitions</span><span class="p">:</span> <span class="n">arti</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">frozendict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">StoragePartition</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">arti</span><span class="o">.</span><span class="n">fingerprints</span><span class="o">.</span><span class="n">Fingerprint</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nt">def</span><span class="w"> </span><span class="nt">compute_input_fingerprint</span><span class="o">(</span>

<span class="w">        </span><span class="nt">self</span><span class="o">,</span><span class="w"> </span><span class="nt">dependency_partitions</span><span class="o">:</span><span class="w"> </span><span class="nt">frozendict</span><span class="cp">[</span><span class="nx">str</span><span class="p">,</span><span class="w"> </span><span class="nx">StoragePartitions</span><span class="cp">]</span>

<span class="w">    </span><span class="o">)</span><span class="w"> </span><span class="nt">-</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">Fingerprint</span><span class="o">:</span>

<span class="w">        </span><span class="nt">input_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">set</span><span class="o">(</span><span class="nt">dependency_partitions</span><span class="o">)</span>

<span class="w">        </span><span class="nt">expected_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">set</span><span class="o">(</span><span class="nt">self</span><span class="p">.</span><span class="nc">_build_inputs_</span><span class="o">)</span>

<span class="w">        </span><span class="nt">if</span><span class="w"> </span><span class="nt">input_names</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nt">expected_names</span><span class="o">:</span>

<span class="w">            </span><span class="nt">raise</span><span class="w"> </span><span class="nt">ValueError</span><span class="o">(</span>

<span class="w">                </span><span class="nt">f</span><span class="s2">&quot;Mismatched dependency inputs; expected {expected_names}, got {input_names}&quot;</span>

<span class="w">            </span><span class="o">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nt">We</span><span class="w"> </span><span class="nt">only</span><span class="w"> </span><span class="nt">care</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="o">*</span><span class="nt">code</span><span class="o">*</span><span class="w"> </span><span class="nt">or</span><span class="w"> </span><span class="o">*</span><span class="nt">input</span><span class="w"> </span><span class="nt">partition</span><span class="w"> </span><span class="nt">contents</span><span class="o">*</span><span class="w"> </span><span class="nt">changed</span><span class="o">,</span><span class="w"> </span><span class="nt">not</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="nt">input</span><span class="w"> </span><span class="nt">file</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nt">paths</span><span class="w"> </span><span class="nt">changed</span><span class="w"> </span><span class="o">(</span><span class="nt">but</span><span class="w"> </span><span class="nt">have</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="nt">same</span><span class="w"> </span><span class="nt">content</span><span class="w"> </span><span class="nt">as</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="nt">prior</span><span class="w"> </span><span class="nt">run</span><span class="o">).</span>

<span class="w">        </span><span class="nt">return</span><span class="w"> </span><span class="nt">Fingerprint</span><span class="p">.</span><span class="nc">from_string</span><span class="o">(</span><span class="nt">self</span><span class="p">.</span><span class="nc">_class_key_</span><span class="o">)</span><span class="p">.</span><span class="nc">combine</span><span class="o">(</span>

<span class="w">            </span><span class="nt">self</span><span class="p">.</span><span class="nc">version</span><span class="p">.</span><span class="nc">fingerprint</span><span class="o">,</span>

<span class="w">            </span><span class="o">*(</span>

<span class="w">                </span><span class="nt">partition</span><span class="p">.</span><span class="nc">content_fingerprint</span>

<span class="w">                </span><span class="nt">for</span><span class="w"> </span><span class="nt">name</span><span class="o">,</span><span class="w"> </span><span class="nt">partitions</span><span class="w"> </span><span class="nt">in</span><span class="w"> </span><span class="nt">dependency_partitions</span><span class="p">.</span><span class="nc">items</span><span class="o">()</span>

<span class="w">                </span><span class="nt">for</span><span class="w"> </span><span class="nt">partition</span><span class="w"> </span><span class="nt">in</span><span class="w"> </span><span class="nt">partitions</span>

<span class="w">            </span><span class="o">),</span>

<span class="w">        </span><span class="o">)</span>
</code></pre></div>

</details>
<h4 id="copy_1">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="o">~</span><span class="n">_Model</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="o">~</span><span class="n">_Model</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="n">_Model</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">_Model</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h4 id="out">out</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">out</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">outputs</span><span class="p">:</span> <span class="n">arti</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">Artifact</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">Artifact</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">arti</span><span class="o">.</span><span class="n">artifacts</span><span class="o">.</span><span class="n">Artifact</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span>
</code></pre></div>

<p>Configure the output Artifacts this Producer will build.</p>
<p>The arguments are matched to the <code>Producer.build</code> return signature in order.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">out</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nl">outputs</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Artifact, tuple[Artifact, ...</span><span class="o">]</span><span class="err">]:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Configure the output Artifacts this Producer will build.</span>

<span class="ss">        The arguments are matched to the `Producer.build` return signature in order.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="k">view</span><span class="p">.</span><span class="n">artifact_class</span><span class="p">(</span><span class="n">type</span><span class="o">=</span><span class="k">view</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_outputs_</span><span class="p">)</span>

<span class="w">        </span><span class="n">passed_n</span><span class="p">,</span><span class="w"> </span><span class="n">expected_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">),</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_build_sig_</span><span class="p">.</span><span class="n">return_annotation</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">passed_n</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">expected_n</span><span class="p">:</span>

<span class="w">            </span><span class="n">ret_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;, &quot;</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="o">[</span><span class="n">str(v) for v in self._build_sig_.return_annotation</span><span class="o">]</span><span class="p">)</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;{self._class_key_}.out() - expected {expected_n} arguments of ({ret_str}), but got: {outputs}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">ord</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Artifact</span><span class="p">:</span>

<span class="w">            </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_outputs_</span><span class="o">[</span><span class="n">ord</span><span class="o">]</span>

<span class="w">            </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot;{self._class_key_}.out() {ordinal(ord+1)} argument&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">view</span><span class="p">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                        </span><span class="n">f</span><span class="ss">&quot;{artifact} is produced by {artifact.producer_output.producer}!&quot;</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span>

<span class="w">                </span><span class="k">update</span><span class="o">=</span><span class="err">{</span><span class="ss">&quot;producer_output&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">ProducerOutput</span><span class="p">(</span><span class="n">producer</span><span class="o">=</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">position</span><span class="o">=</span><span class="n">ord</span><span class="p">)</span><span class="err">}</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="n">validate</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">ord</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">outputs</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">outputs</span>
</code></pre></div>

</details>
<h3 id="produceroutput">ProducerOutput</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ProducerOutput</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">ProducerOutput</span>(<span class="n">Model</span>):

    <span class="n">producer:</span> <span class="n">Producer</span>

    <span class="n">position:</span> <span class="n">int</span>  <span class="c1"># TODO: Support named output (defaulting to artifact classname?)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_8">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables_1">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_1">Static methods</h4>
<h4 id="construct_1">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_1">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_1">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_1">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_1">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_1">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_1">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_1">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_1">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_1">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_6">Methods</h4>
<h4 id="copy_2">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="o">~</span><span class="n">_Model</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="o">~</span><span class="n">_Model</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="o">:</span><span class="w"> </span><span class="n">_Model</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">_Model</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_1">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_1">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="validatesig">ValidateSig</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ValidateSig</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="ancestors-in-mro_9">Ancestors (in MRO)</h4>
<ul>
<li>collections.abc.Callable</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../partitions/" title="Partitions" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Partitions
              </span>
            </div>
          </a>
        
        
          <a href="../statistics/" title="Statistics" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Statistics
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Powered by
        <a href="http://timothycrosley.github.io/portray">portray.</a>
        You too can
        <a href="http://timothycrosley.github.io/portray">
          portray</a>
        your Python project well using automatic documentation.
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>