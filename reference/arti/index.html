
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.4, mkdocs-material-7.3.0">
    
    
      
        <title>Index - artigraph</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="lightgreen">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-arti" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="artigraph" class="md-header__button md-logo" aria-label="artigraph" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            artigraph
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Index
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/artigraph/artigraph/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    artigraph
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="artigraph" class="md-nav__button md-logo" aria-label="artigraph" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    artigraph
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/artigraph/artigraph/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    artigraph
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../CODE_OF_CONDUCT/" class="md-nav__link">
        Code Of Conduct
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../GOVERNANCE/" class="md-nav__link">
        Governance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../SECURITY/" class="md-nav__link">
        Security
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../SUPPORT/" class="md-nav__link">
        Support
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Arti
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Arti" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Arti
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="annotations/" class="md-nav__link">
        Annotations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="artifacts/" class="md-nav__link">
        Artifacts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="fingerprints/" class="md-nav__link">
        Fingerprints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="graphs/" class="md-nav__link">
        Graphs
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Index
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Index
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sub-modules" class="md-nav__link">
    Sub-modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#producer" class="md-nav__link">
    producer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read" class="md-nav__link">
    read
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_reader" class="md-nav__link">
    register_reader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_writer" class="md-nav__link">
    register_writer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write" class="md-nav__link">
    write
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#annotation" class="md-nav__link">
    Annotation
  </a>
  
    <nav class="md-nav" aria-label="Annotation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifact" class="md-nav__link">
    Artifact
  </a>
  
    <nav class="md-nav" aria-label="Artifact">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_1" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_1" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_1" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cast" class="md-nav__link">
    cast
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_1" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_1" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_1" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_1" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_1" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_1" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_1" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_1" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_1" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_1" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_1" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_1" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_1" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backend" class="md-nav__link">
    Backend
  </a>
  
    <nav class="md-nav" aria-label="Backend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_2" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_2" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_2" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_2" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_2" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_2" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_2" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_2" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_2" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_2" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_2" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_2" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_2" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect" class="md-nav__link">
    connect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_2" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_2" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_2" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection" class="md-nav__link">
    Connection
  </a>
  
    <nav class="md-nav" aria-label="Connection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#descendants_1" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect_1" class="md-nav__link">
    connect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_artifact_partitions" class="md-nav__link">
    read_artifact_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_graph" class="md-nav__link">
    read_graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_snapshot" class="md-nav__link">
    read_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_snapshot_partitions" class="md-nav__link">
    read_snapshot_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_snapshot_tag" class="md-nav__link">
    read_snapshot_tag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_artifact_and_graph_partitions" class="md-nav__link">
    write_artifact_and_graph_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_artifact_partitions" class="md-nav__link">
    write_artifact_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_graph" class="md-nav__link">
    write_graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_snapshot" class="md-nav__link">
    write_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_snapshot_partitions" class="md-nav__link">
    write_snapshot_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_snapshot_tag" class="md-nav__link">
    write_snapshot_tag
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executor" class="md-nav__link">
    Executor
  </a>
  
    <nav class="md-nav" aria-label="Executor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_3" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_2" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_3" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_3" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_3" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_3" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_3" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_3" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_3" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_3" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_3" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_3" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_3" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_3" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build" class="md-nav__link">
    build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build_producer_partition" class="md-nav__link">
    build_producer_partition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_3" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_3" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discover_producer_partitions" class="md-nav__link">
    discover_producer_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_producer_inputs" class="md-nav__link">
    get_producer_inputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_3" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fingerprint" class="md-nav__link">
    Fingerprint
  </a>
  
    <nav class="md-nav" aria-label="Fingerprint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_4" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_4" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_4" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_4" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#empty" class="md-nav__link">
    empty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_int" class="md-nav__link">
    from_int
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_int64" class="md-nav__link">
    from_int64
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_4" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_string" class="md-nav__link">
    from_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_uint64" class="md-nav__link">
    from_uint64
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#identity" class="md-nav__link">
    identity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_4" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_4" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_4" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_4" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_4" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_4" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_4" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_4" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_5" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combine" class="md-nav__link">
    combine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_4" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_4" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_4" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format" class="md-nav__link">
    Format
  </a>
  
    <nav class="md-nav" aria-label="Format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_5" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_3" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_5" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_5" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_5" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_5" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_default" class="md-nav__link">
    get_default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_5" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_5" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_5" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_5" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_5" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_5" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_5" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_5" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_6" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_5" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_5" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_5" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graph" class="md-nav__link">
    Graph
  </a>
  
    <nav class="md-nav" aria-label="Graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_6" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_6" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_6" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_6" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_6" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_6" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_6" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_6" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_6" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_6" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_6" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_6" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_6" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_7" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build_1" class="md-nav__link">
    build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_6" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_6" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_6" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producer_outputs" class="md-nav__link">
    producer_outputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producers" class="md-nav__link">
    producers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_1" class="md-nav__link">
    read
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshot" class="md-nav__link">
    snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_1" class="md-nav__link">
    write
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphsnapshot" class="md-nav__link">
    GraphSnapshot
  </a>
  
    <nav class="md-nav" aria-label="GraphSnapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_7" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_7" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_7" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_7" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_graph" class="md-nav__link">
    from_graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_7" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_tag" class="md-nav__link">
    from_tag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_7" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_7" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_7" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_7" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_7" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_7" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_7" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_7" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_8" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build_2" class="md-nav__link">
    build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_7" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_7" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_7" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_2" class="md-nav__link">
    read
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag" class="md-nav__link">
    tag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_2" class="md-nav__link">
    write
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitionkey" class="md-nav__link">
    PartitionKey
  </a>
  
    <nav class="md-nav" aria-label="PartitionKey">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_8" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_4" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_8" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_8" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_8" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_key_components" class="md-nav__link">
    from_key_components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_8" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_class_for" class="md-nav__link">
    get_class_for
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_8" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_8" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_8" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_8" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_8" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#types_from" class="md-nav__link">
    types_from
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_8" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_8" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_8" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_9" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_8" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_8" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_8" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producer_1" class="md-nav__link">
    Producer
  </a>
  
    <nav class="md-nav" aria-label="Producer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_9" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_9" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_9" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_9" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_9" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_9" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_9" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_9" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_9" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_9" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_9" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_9" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_outputs" class="md-nav__link">
    validate_outputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_9" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_10" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_dependencies" class="md-nav__link">
    compute_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_input_fingerprint" class="md-nav__link">
    compute_input_fingerprint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_9" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_9" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_9" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out" class="md-nav__link">
    out
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statistic" class="md-nav__link">
    Statistic
  </a>
  
    <nav class="md-nav" aria-label="Statistic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_10" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_10" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_10" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_10" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_10" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_10" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_10" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_10" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_10" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_10" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_10" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_10" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_10" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_11" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_10" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_10" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_10" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage" class="md-nav__link">
    Storage
  </a>
  
    <nav class="md-nav" aria-label="Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_11" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_5" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_11" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_11" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_11" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_11" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_default_1" class="md-nav__link">
    get_default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_11" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_11" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_11" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_11" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_11" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_11" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_11" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_11" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_12" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_11" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_11" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discover_partitions" class="md-nav__link">
    discover_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate_partition" class="md-nav__link">
    generate_partition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_11" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolve" class="md-nav__link">
    resolve
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storagepartition" class="md-nav__link">
    StoragePartition
  </a>
  
    <nav class="md-nav" aria-label="StoragePartition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_12" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_6" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_12" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_12" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_12" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_12" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_12" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_12" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_12" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_12" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_12" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_12" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_12" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_12" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_13" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_content_fingerprint" class="md-nav__link">
    compute_content_fingerprint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_12" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_12" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_12" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with_content_fingerprint" class="md-nav__link">
    with_content_fingerprint
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threshold" class="md-nav__link">
    Threshold
  </a>
  
    <nav class="md-nav" aria-label="Threshold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_13" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_13" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_13" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_13" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_13" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_13" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_13" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_13" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_13" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_13" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_13" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_13" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_13" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_14" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_13" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_13" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_13" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type" class="md-nav__link">
    Type
  </a>
  
    <nav class="md-nav" aria-label="Type">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_14" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_7" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_14" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_14" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_14" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_14" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_14" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_14" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_14" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_14" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_14" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_14" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_14" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_14" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_15" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_14" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_14" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_14" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typeadapter" class="md-nav__link">
    TypeAdapter
  </a>
  
    <nav class="md-nav" aria-label="TypeAdapter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#descendants_8" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_15" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_15" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matches_artigraph" class="md-nav__link">
    matches_artigraph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matches_system" class="md-nav__link">
    matches_system
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_artigraph" class="md-nav__link">
    to_artigraph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_system" class="md-nav__link">
    to_system
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typesystem" class="md-nav__link">
    TypeSystem
  </a>
  
    <nav class="md-nav" aria-label="TypeSystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_15" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_16" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_16" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_15" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_15" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_15" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_15" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_15" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_15" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_15" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_15" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_15" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_15" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_16" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_15" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_15" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_15" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_adapter" class="md-nav__link">
    register_adapter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_artigraph_1" class="md-nav__link">
    to_artigraph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_system_1" class="md-nav__link">
    to_system
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version" class="md-nav__link">
    Version
  </a>
  
    <nav class="md-nav" aria-label="Version">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_16" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_9" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_17" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_17" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_16" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_16" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_16" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_16" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_16" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_16" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_16" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_16" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_16" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_16" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_17" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_16" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_16" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_16" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view" class="md-nav__link">
    View
  </a>
  
    <nav class="md-nav" aria-label="View">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_17" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_10" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_18" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_18" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_17" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_annotation" class="md-nav__link">
    from_annotation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_17" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_class_for_1" class="md-nav__link">
    get_class_for
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_17" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_17" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_17" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_17" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_17" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_17" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_17" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_17" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_18" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_annotation_compatibility" class="md-nav__link">
    check_annotation_compatibility
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_artifact_compatibility" class="md-nav__link">
    check_artifact_compatibility
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_17" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_17" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_17" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="partitions/" class="md-nav__link">
        Partitions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="producers/" class="md-nav__link">
        Producers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="statistics/" class="md-nav__link">
        Statistics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="thresholds/" class="md-nav__link">
        Thresholds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="versions/" class="md-nav__link">
        Versions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_11" type="checkbox" id="__nav_7_1_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_11">
          Backends
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Backends" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_11">
          <span class="md-nav__icon md-icon"></span>
          Backends
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="backends/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="backends/memory/" class="md-nav__link">
        Memory
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_12" type="checkbox" id="__nav_7_1_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_12">
          Executors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Executors" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_12">
          <span class="md-nav__icon md-icon"></span>
          Executors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="executors/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="executors/local/" class="md-nav__link">
        Local
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_13" type="checkbox" id="__nav_7_1_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_13">
          Formats
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Formats" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_13">
          <span class="md-nav__icon md-icon"></span>
          Formats
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="formats/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="formats/json/" class="md-nav__link">
        Json
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="formats/pickle/" class="md-nav__link">
        Pickle
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_14" type="checkbox" id="__nav_7_1_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_14">
          Internal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Internal" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_14">
          <span class="md-nav__icon md-icon"></span>
          Internal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="internal/dispatch/" class="md-nav__link">
        Dispatch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="internal/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="internal/models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="internal/patches/" class="md-nav__link">
        Patches
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="internal/type_hints/" class="md-nav__link">
        Type Hints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="internal/utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_15" type="checkbox" id="__nav_7_1_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_15">
          Io
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Io" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_15">
          <span class="md-nav__icon md-icon"></span>
          Io
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="io/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="io/json_gcsfile_python/" class="md-nav__link">
        Json Gcsfile Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="io/json_localfile_python/" class="md-nav__link">
        Json Localfile Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="io/json_stringliteral_python/" class="md-nav__link">
        Json Stringliteral Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="io/pickle_gcsfile_python/" class="md-nav__link">
        Pickle Gcsfile Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="io/pickle_localfile_python/" class="md-nav__link">
        Pickle Localfile Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_16" type="checkbox" id="__nav_7_1_16" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_16">
          Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Storage" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_16">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="storage/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="storage/literal/" class="md-nav__link">
        Literal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="storage/local/" class="md-nav__link">
        Local
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_17" type="checkbox" id="__nav_7_1_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_17">
          Types
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Types" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_17">
          <span class="md-nav__icon md-icon"></span>
          Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="types/bigquery/" class="md-nav__link">
        Bigquery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="types/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="types/numpy/" class="md-nav__link">
        Numpy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="types/pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="types/pyarrow/" class="md-nav__link">
        Pyarrow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="types/pydantic/" class="md-nav__link">
        Pydantic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="types/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1_18" type="checkbox" id="__nav_7_1_18" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1_18">
          Views
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Views" data-md-level="3">
        <label class="md-nav__title" for="__nav_7_1_18">
          <span class="md-nav__icon md-icon"></span>
          Views
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="views/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="views/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sub-modules" class="md-nav__link">
    Sub-modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#producer" class="md-nav__link">
    producer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read" class="md-nav__link">
    read
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_reader" class="md-nav__link">
    register_reader
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_writer" class="md-nav__link">
    register_writer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write" class="md-nav__link">
    write
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#annotation" class="md-nav__link">
    Annotation
  </a>
  
    <nav class="md-nav" aria-label="Annotation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#artifact" class="md-nav__link">
    Artifact
  </a>
  
    <nav class="md-nav" aria-label="Artifact">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_1" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_1" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_1" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cast" class="md-nav__link">
    cast
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_1" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_1" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_1" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_1" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_1" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_1" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_1" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_1" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_1" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_1" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_1" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_1" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_1" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backend" class="md-nav__link">
    Backend
  </a>
  
    <nav class="md-nav" aria-label="Backend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_2" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_2" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_2" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_2" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_2" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_2" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_2" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_2" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_2" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_2" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_2" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_2" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_2" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect" class="md-nav__link">
    connect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_2" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_2" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_2" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection" class="md-nav__link">
    Connection
  </a>
  
    <nav class="md-nav" aria-label="Connection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#descendants_1" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_3" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect_1" class="md-nav__link">
    connect
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_artifact_partitions" class="md-nav__link">
    read_artifact_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_graph" class="md-nav__link">
    read_graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_snapshot" class="md-nav__link">
    read_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_snapshot_partitions" class="md-nav__link">
    read_snapshot_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_snapshot_tag" class="md-nav__link">
    read_snapshot_tag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_artifact_and_graph_partitions" class="md-nav__link">
    write_artifact_and_graph_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_artifact_partitions" class="md-nav__link">
    write_artifact_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_graph" class="md-nav__link">
    write_graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_snapshot" class="md-nav__link">
    write_snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_snapshot_partitions" class="md-nav__link">
    write_snapshot_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_snapshot_tag" class="md-nav__link">
    write_snapshot_tag
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executor" class="md-nav__link">
    Executor
  </a>
  
    <nav class="md-nav" aria-label="Executor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_3" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_2" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_3" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_3" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_3" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_3" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_3" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_3" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_3" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_3" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_3" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_3" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_3" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_3" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_4" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build" class="md-nav__link">
    build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build_producer_partition" class="md-nav__link">
    build_producer_partition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_3" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_3" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discover_producer_partitions" class="md-nav__link">
    discover_producer_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_producer_inputs" class="md-nav__link">
    get_producer_inputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_3" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fingerprint" class="md-nav__link">
    Fingerprint
  </a>
  
    <nav class="md-nav" aria-label="Fingerprint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_4" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_4" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_4" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_4" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#empty" class="md-nav__link">
    empty
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_int" class="md-nav__link">
    from_int
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_int64" class="md-nav__link">
    from_int64
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_4" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_string" class="md-nav__link">
    from_string
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_uint64" class="md-nav__link">
    from_uint64
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#identity" class="md-nav__link">
    identity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_4" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_4" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_4" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_4" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_4" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_4" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_4" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_4" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_5" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combine" class="md-nav__link">
    combine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_4" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_4" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_4" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format" class="md-nav__link">
    Format
  </a>
  
    <nav class="md-nav" aria-label="Format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_5" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_3" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_5" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_5" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_5" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_5" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_default" class="md-nav__link">
    get_default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_5" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_5" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_5" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_5" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_5" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_5" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_5" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_5" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_6" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_5" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_5" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_5" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graph" class="md-nav__link">
    Graph
  </a>
  
    <nav class="md-nav" aria-label="Graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_6" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_6" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_6" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_6" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_6" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_6" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_6" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_6" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_6" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_6" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_6" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_6" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_6" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_7" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build_1" class="md-nav__link">
    build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_6" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_6" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_6" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producer_outputs" class="md-nav__link">
    producer_outputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producers" class="md-nav__link">
    producers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_1" class="md-nav__link">
    read
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snapshot" class="md-nav__link">
    snapshot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_1" class="md-nav__link">
    write
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#graphsnapshot" class="md-nav__link">
    GraphSnapshot
  </a>
  
    <nav class="md-nav" aria-label="GraphSnapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_7" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_7" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_7" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_7" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_graph" class="md-nav__link">
    from_graph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_7" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_tag" class="md-nav__link">
    from_tag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_7" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_7" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_7" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_7" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_7" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_7" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_7" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_7" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_8" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build_2" class="md-nav__link">
    build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_7" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_7" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_7" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read_2" class="md-nav__link">
    read
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tag" class="md-nav__link">
    tag
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write_2" class="md-nav__link">
    write
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitionkey" class="md-nav__link">
    PartitionKey
  </a>
  
    <nav class="md-nav" aria-label="PartitionKey">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_8" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_4" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_8" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_8" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_8" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_key_components" class="md-nav__link">
    from_key_components
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_8" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_class_for" class="md-nav__link">
    get_class_for
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_8" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_8" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_8" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_8" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_8" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#types_from" class="md-nav__link">
    types_from
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_8" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_8" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_8" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_9" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_8" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_8" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_8" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#producer_1" class="md-nav__link">
    Producer
  </a>
  
    <nav class="md-nav" aria-label="Producer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_9" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_9" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_9" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_9" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_9" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_9" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_9" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_9" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_9" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_9" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_9" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_9" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_outputs" class="md-nav__link">
    validate_outputs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_9" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_10" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_dependencies" class="md-nav__link">
    compute_dependencies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_input_fingerprint" class="md-nav__link">
    compute_input_fingerprint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_9" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_9" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_9" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out" class="md-nav__link">
    out
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statistic" class="md-nav__link">
    Statistic
  </a>
  
    <nav class="md-nav" aria-label="Statistic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_10" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_10" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_10" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_10" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_10" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_10" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_10" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_10" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_10" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_10" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_10" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_10" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_10" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_11" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_10" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_10" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_10" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage" class="md-nav__link">
    Storage
  </a>
  
    <nav class="md-nav" aria-label="Storage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_11" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_5" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_11" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_11" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_11" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_11" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_default_1" class="md-nav__link">
    get_default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_11" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_11" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_11" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_11" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_11" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_11" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_11" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_11" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_12" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_11" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_11" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discover_partitions" class="md-nav__link">
    discover_partitions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate_partition" class="md-nav__link">
    generate_partition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_11" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolve" class="md-nav__link">
    resolve
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storagepartition" class="md-nav__link">
    StoragePartition
  </a>
  
    <nav class="md-nav" aria-label="StoragePartition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_12" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_6" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_12" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_12" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_12" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_12" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_12" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_12" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_12" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_12" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_12" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_12" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_12" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_12" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_13" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_content_fingerprint" class="md-nav__link">
    compute_content_fingerprint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_12" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_12" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_12" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with_content_fingerprint" class="md-nav__link">
    with_content_fingerprint
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#threshold" class="md-nav__link">
    Threshold
  </a>
  
    <nav class="md-nav" aria-label="Threshold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_13" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_13" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_13" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_13" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_13" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_13" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_13" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_13" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_13" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_13" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_13" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_13" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_13" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_14" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check" class="md-nav__link">
    check
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_13" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_13" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_13" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type" class="md-nav__link">
    Type
  </a>
  
    <nav class="md-nav" aria-label="Type">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_14" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_7" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_14" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_14" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_14" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_14" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_14" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_14" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_14" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_14" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_14" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_14" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_14" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_14" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_15" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_14" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_14" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_14" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typeadapter" class="md-nav__link">
    TypeAdapter
  </a>
  
    <nav class="md-nav" aria-label="TypeAdapter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#descendants_8" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_15" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_15" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matches_artigraph" class="md-nav__link">
    matches_artigraph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matches_system" class="md-nav__link">
    matches_system
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_artigraph" class="md-nav__link">
    to_artigraph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_system" class="md-nav__link">
    to_system
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typesystem" class="md-nav__link">
    TypeSystem
  </a>
  
    <nav class="md-nav" aria-label="TypeSystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_15" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_16" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_16" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_15" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_15" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_15" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_15" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_15" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_15" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_15" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_15" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_15" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_15" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_16" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_15" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_15" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_15" class="md-nav__link">
    json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_adapter" class="md-nav__link">
    register_adapter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_artigraph_1" class="md-nav__link">
    to_artigraph
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to_system_1" class="md-nav__link">
    to_system
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version" class="md-nav__link">
    Version
  </a>
  
    <nav class="md-nav" aria-label="Version">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_16" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_9" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_17" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_17" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_16" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_16" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_16" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_16" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_16" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_16" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_16" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_16" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_16" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_16" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_17" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_16" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_16" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_16" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view" class="md-nav__link">
    View
  </a>
  
    <nav class="md-nav" aria-label="View">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro_17" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants_10" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-variables_18" class="md-nav__link">
    Class variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#static-methods_18" class="md-nav__link">
    Static methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construct_17" class="md-nav__link">
    construct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_annotation" class="md-nav__link">
    from_annotation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from_orm_17" class="md-nav__link">
    from_orm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_class_for_1" class="md-nav__link">
    get_class_for
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_file_17" class="md-nav__link">
    parse_file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_obj_17" class="md-nav__link">
    parse_obj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parse_raw_17" class="md-nav__link">
    parse_raw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_17" class="md-nav__link">
    schema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema_json_17" class="md-nav__link">
    schema_json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update_forward_refs_17" class="md-nav__link">
    update_forward_refs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#validate_17" class="md-nav__link">
    validate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_17" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_18" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_annotation_compatibility" class="md-nav__link">
    check_annotation_compatibility
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_artifact_compatibility" class="md-nav__link">
    check_artifact_compatibility
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy_17" class="md-nav__link">
    copy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dict_17" class="md-nav__link">
    dict
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#json_17" class="md-nav__link">
    json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/artigraph/artigraph/edit/golden/reference/arti/index.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="module-arti">Module arti</h1>
<p>None</p>
<p>None</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">importlib.metadata</span>

<span class="n">__path__</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="s2">&quot;pkgutil&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">extend_path</span><span class="p">(</span><span class="n">__path__</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">version</span><span class="p">(</span><span class="s2">&quot;arti&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">threading</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">arti.annotations</span> <span class="kn">import</span> <span class="n">Annotation</span>

<span class="kn">from</span> <span class="nn">arti.artifacts</span> <span class="kn">import</span> <span class="n">Artifact</span>

<span class="kn">from</span> <span class="nn">arti.backends</span> <span class="kn">import</span> <span class="n">Backend</span><span class="p">,</span> <span class="n">Connection</span>

<span class="kn">from</span> <span class="nn">arti.executors</span> <span class="kn">import</span> <span class="n">Executor</span>

<span class="kn">from</span> <span class="nn">arti.fingerprints</span> <span class="kn">import</span> <span class="n">Fingerprint</span>

<span class="kn">from</span> <span class="nn">arti.formats</span> <span class="kn">import</span> <span class="n">Format</span>

<span class="kn">from</span> <span class="nn">arti.graphs</span> <span class="kn">import</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">GraphSnapshot</span>

<span class="kn">from</span> <span class="nn">arti.io</span> <span class="kn">import</span> <span class="n">read</span><span class="p">,</span> <span class="n">register_reader</span><span class="p">,</span> <span class="n">register_writer</span><span class="p">,</span> <span class="n">write</span>

<span class="kn">from</span> <span class="nn">arti.partitions</span> <span class="kn">import</span> <span class="n">CompositeKey</span><span class="p">,</span> <span class="n">CompositeKeyTypes</span><span class="p">,</span> <span class="n">InputFingerprints</span><span class="p">,</span> <span class="n">PartitionKey</span>

<span class="kn">from</span> <span class="nn">arti.producers</span> <span class="kn">import</span> <span class="n">PartitionDependencies</span><span class="p">,</span> <span class="n">Producer</span><span class="p">,</span> <span class="n">producer</span>

<span class="kn">from</span> <span class="nn">arti.statistics</span> <span class="kn">import</span> <span class="n">Statistic</span>

<span class="kn">from</span> <span class="nn">arti.storage</span> <span class="kn">import</span> <span class="n">Storage</span><span class="p">,</span> <span class="n">StoragePartition</span><span class="p">,</span> <span class="n">StoragePartitions</span>

<span class="kn">from</span> <span class="nn">arti.thresholds</span> <span class="kn">import</span> <span class="n">Threshold</span>

<span class="kn">from</span> <span class="nn">arti.types</span> <span class="kn">import</span> <span class="n">Type</span><span class="p">,</span> <span class="n">TypeAdapter</span><span class="p">,</span> <span class="n">TypeSystem</span>

<span class="kn">from</span> <span class="nn">arti.versions</span> <span class="kn">import</span> <span class="n">Version</span>

<span class="kn">from</span> <span class="nn">arti.views</span> <span class="kn">import</span> <span class="n">View</span>

<span class="c1"># Export all interfaces.</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>

    <span class="s2">&quot;Annotation&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Artifact&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Backend&quot;</span><span class="p">,</span>

    <span class="s2">&quot;CompositeKey&quot;</span><span class="p">,</span>

    <span class="s2">&quot;CompositeKeyTypes&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Connection&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Executor&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Fingerprint&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Format&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Graph&quot;</span><span class="p">,</span>

    <span class="s2">&quot;GraphSnapshot&quot;</span><span class="p">,</span>

    <span class="s2">&quot;InputFingerprints&quot;</span><span class="p">,</span>

    <span class="s2">&quot;PartitionDependencies&quot;</span><span class="p">,</span>

    <span class="s2">&quot;PartitionKey&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Producer&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Statistic&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Storage&quot;</span><span class="p">,</span>

    <span class="s2">&quot;StoragePartition&quot;</span><span class="p">,</span>

    <span class="s2">&quot;StoragePartitions&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Threshold&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Type&quot;</span><span class="p">,</span>

    <span class="s2">&quot;TypeAdapter&quot;</span><span class="p">,</span>

    <span class="s2">&quot;TypeSystem&quot;</span><span class="p">,</span>

    <span class="s2">&quot;Version&quot;</span><span class="p">,</span>

    <span class="s2">&quot;View&quot;</span><span class="p">,</span>

    <span class="s2">&quot;producer&quot;</span><span class="p">,</span>

    <span class="s2">&quot;read&quot;</span><span class="p">,</span>

    <span class="s2">&quot;register_reader&quot;</span><span class="p">,</span>

    <span class="s2">&quot;register_writer&quot;</span><span class="p">,</span>

    <span class="s2">&quot;write&quot;</span><span class="p">,</span>

<span class="p">]</span>

<span class="k">class</span> <span class="nc">_Context</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">local</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Graph</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">context</span> <span class="o">=</span> <span class="n">_Context</span><span class="p">()</span>
</code></pre></div>

</details>
<h2 id="sub-modules">Sub-modules</h2>
<ul>
<li><a href="annotations/">arti.annotations</a></li>
<li><a href="artifacts/">arti.artifacts</a></li>
<li><a href="backends/">arti.backends</a></li>
<li><a href="executors/">arti.executors</a></li>
<li><a href="fingerprints/">arti.fingerprints</a></li>
<li><a href="formats/">arti.formats</a></li>
<li><a href="graphs/">arti.graphs</a></li>
<li><a href="internal/">arti.internal</a></li>
<li><a href="io/">arti.io</a></li>
<li><a href="partitions/">arti.partitions</a></li>
<li><a href="producers/">arti.producers</a></li>
<li><a href="statistics/">arti.statistics</a></li>
<li><a href="storage/">arti.storage</a></li>
<li><a href="thresholds/">arti.thresholds</a></li>
<li><a href="types/">arti.types</a></li>
<li><a href="versions/">arti.versions</a></li>
<li><a href="views/">arti.views</a></li>
</ul>
<h2 id="variables">Variables</h2>
<div class="codehilite"><pre><span></span><code><span class="n">CompositeKey</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">CompositeKeyTypes</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">InputFingerprints</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">PartitionDependencies</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">StoragePartitions</span>
</code></pre></div>

<h2 id="functions">Functions</h2>
<h3 id="producer">producer</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">producer</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">annotations</span><span class="p">:</span> <span class="s1">&#39;Optional[tuple[Annotation, ...]]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="nb">map</span><span class="p">:</span> <span class="s1">&#39;Optional[MapSig]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Optional[str]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validate_outputs</span><span class="p">:</span> <span class="s1">&#39;Optional[ValidateSig]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version</span><span class="p">:</span> <span class="s1">&#39;Optional[Version]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Callable[[BuildSig], type[Producer]]&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">producer</span><span class="p">(</span>

<span class="w">    </span><span class="o">*</span><span class="p">,</span>

<span class="w">    </span><span class="nl">annotations</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">tuple[Annotation, ...</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="k">map</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">MapSig</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">validate_outputs</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">ValidateSig</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Version</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Callable</span><span class="o">[</span><span class="n">[BuildSig</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">Producer</span><span class="o">]</span><span class="err">]:</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">decorate</span><span class="p">(</span><span class="nl">build</span><span class="p">:</span><span class="w"> </span><span class="n">BuildSig</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">Producer</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="n">nonlocal</span><span class="w"> </span><span class="n">name</span>

<span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">build</span><span class="p">.</span><span class="n">__name__</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">name</span>

<span class="w">        </span><span class="nl">__annotations__</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">param</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">signature</span><span class="p">(</span><span class="n">build</span><span class="p">).</span><span class="k">parameters</span><span class="p">.</span><span class="k">values</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot;{name} {param.name} param&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">from_annotation</span><span class="p">(</span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="ss">&quot;READ&quot;</span><span class="p">)</span>

<span class="w">                </span><span class="n">__annotations__</span><span class="o">[</span><span class="n">param.name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">view</span><span class="p">.</span><span class="n">artifact_class</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">overriding</span><span class="p">,</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">explicit</span><span class="w"> </span><span class="ss">&quot;annotations&quot;</span><span class="w"> </span><span class="n">hint</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">released</span><span class="p">.</span>

<span class="w">        </span><span class="err">#</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">samuelcolvin</span><span class="o">/</span><span class="n">pydantic</span><span class="o">/</span><span class="n">pull</span><span class="o">/</span><span class="mi">3018</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">annotations</span><span class="p">:</span>

<span class="w">            </span><span class="n">__annotations__</span><span class="o">[</span><span class="n">&quot;annotations&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">Annotation, ...</span><span class="o">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">version</span><span class="p">:</span>

<span class="w">            </span><span class="n">__annotations__</span><span class="o">[</span><span class="n">&quot;version&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Version</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">(</span>

<span class="w">            </span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="p">(</span><span class="n">Producer</span><span class="p">,),</span>

<span class="w">            </span><span class="err">{</span>

<span class="w">                </span><span class="nl">k</span><span class="p">:</span><span class="w"> </span><span class="n">v</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="err">{</span>

<span class="w">                    </span><span class="ss">&quot;__annotations__&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">__annotations__</span><span class="p">,</span>

<span class="w">                    </span><span class="ss">&quot;__module__&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">get_module_name</span><span class="p">(</span><span class="k">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="ow">Not</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="k">module</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">caller</span><span class="err">&#39;</span><span class="n">s</span><span class="p">.</span>

<span class="w">                    </span><span class="ss">&quot;annotations&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">annotations</span><span class="p">,</span>

<span class="w">                    </span><span class="ss">&quot;build&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">(</span><span class="n">build</span><span class="p">),</span>

<span class="w">                    </span><span class="ss">&quot;map&quot;</span><span class="err">:</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">(</span><span class="k">map</span><span class="p">),</span>

<span class="w">                    </span><span class="ss">&quot;validate_outputs&quot;</span><span class="err">:</span><span class="w"> </span><span class="p">(</span>

<span class="w">                        </span><span class="k">None</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">validate_outputs</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">(</span><span class="n">validate_outputs</span><span class="p">)</span>

<span class="w">                    </span><span class="p">),</span>

<span class="w">                    </span><span class="ss">&quot;version&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">version</span><span class="p">,</span>

<span class="w">                </span><span class="err">}</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span>

<span class="w">            </span><span class="err">}</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">decorate</span>
</code></pre></div>

</details>
<h3 id="read">read</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">read</span><span class="p">(</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span>
    <span class="nb">format</span><span class="p">:</span> <span class="s1">&#39;Format&#39;</span><span class="p">,</span>
    <span class="n">storage_partitions</span><span class="p">:</span> <span class="s1">&#39;Sequence[StoragePartition]&#39;</span><span class="p">,</span>
    <span class="n">view</span><span class="p">:</span> <span class="s1">&#39;View&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="k">read</span><span class="p">(</span>

<span class="w">    </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="nf">format</span><span class="err">:</span><span class="w"> </span><span class="nf">Format</span><span class="p">,</span><span class="w"> </span><span class="nl">storage_partitions</span><span class="p">:</span><span class="w"> </span><span class="k">Sequence</span><span class="o">[</span><span class="n">StoragePartition</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">view</span><span class="err">:</span><span class="w"> </span><span class="k">View</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">storage_partitions</span><span class="p">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">Aside</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">simplifying</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">front</span><span class="p">,</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">dispatch</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">unknown</span><span class="w"> </span><span class="n">list</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">element</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">ambiguous</span><span class="o">/</span><span class="n">error</span><span class="p">.</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">FileNotFoundError</span><span class="p">(</span><span class="ss">&quot;No data&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">storage_partitions</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">is_partitioned</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">            </span><span class="n">f</span><span class="ss">&quot;Multiple partitions can only be read into a partitioned Collection, not {type_}&quot;</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="w"> </span><span class="n">Checks</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Type</span><span class="o">/</span><span class="k">View</span>

<span class="w">    </span><span class="err">#</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Likely</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">View</span><span class="w"> </span><span class="k">method</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">schema</span><span class="w"> </span><span class="n">checking</span><span class="p">,</span><span class="w"> </span><span class="n">filtering</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">column</span><span class="o">/</span><span class="k">row</span><span class="w"> </span><span class="n">subsets</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">necessary</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">_read</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="nf">format</span><span class="p">,</span><span class="w"> </span><span class="n">storage_partitions</span><span class="p">,</span><span class="w"> </span><span class="k">view</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="register_reader">register_reader</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">register_reader</span><span class="p">(</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Callable[[REGISTERED], REGISTERED]&#39;</span>
</code></pre></div>

<p>Decorator for registering a function.</p>
<p>Optionally call with types to return a decorator for unannotated functions.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">register</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nl">args</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Callable</span><span class="o">[</span><span class="n">[REGISTERED</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">REGISTERED</span><span class="err">]:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hasattr</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;__annotations__&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="n">sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tidy_signature</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">inspect</span><span class="p">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>

<span class="w">            </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">clean_signature</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">sig</span><span class="p">.</span><span class="k">parameters</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="k">parameters</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                    </span><span class="n">f</span><span class="ss">&quot;Expected `{func.__name__}` to have {sorted(set(spec.parameters))} parameters, got {sorted(set(sig.parameters))}&quot;</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sig</span><span class="p">.</span><span class="k">parameters</span><span class="err">:</span>

<span class="w">                </span><span class="n">sig_param</span><span class="p">,</span><span class="w"> </span><span class="n">spec_param</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig</span><span class="p">.</span><span class="k">parameters</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">.</span><span class="k">parameters</span><span class="o">[</span><span class="n">name</span><span class="o">]</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">sig_param</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">spec_param</span><span class="p">.</span><span class="nl">kind</span><span class="p">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                        </span><span class="n">f</span><span class="ss">&quot;Expected the `{func.__name__}.{name}` parameter to be {spec_param.kind}, got {sig_param.kind}&quot;</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">sig_param</span><span class="p">.</span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">Any</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="p">(</span>

<span class="w">                    </span><span class="n">sig_param</span><span class="p">.</span><span class="n">annotation</span><span class="p">,</span><span class="w"> </span><span class="n">spec_param</span><span class="p">.</span><span class="n">annotation</span>

<span class="w">                </span><span class="p">)</span><span class="err">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                        </span><span class="n">f</span><span class="ss">&quot;Expected the `{func.__name__}.{name}` parameter to be a subclass of {spec_param.annotation}, got {sig_param.annotation}&quot;</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="p">(</span><span class="n">sig</span><span class="p">.</span><span class="n">return_annotation</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">.</span><span class="n">return_annotation</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                    </span><span class="n">f</span><span class="ss">&quot;Expected the `{func.__name__}` return to match {spec.return_annotation}, got {sig.return_annotation}&quot;</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nf">cast</span><span class="p">(</span><span class="n">Callable</span><span class="o">[</span><span class="n">..., Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">register</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span>
</code></pre></div>

</details>
<h3 id="register_writer">register_writer</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">register_writer</span><span class="p">(</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Callable[[REGISTERED], REGISTERED]&#39;</span>
</code></pre></div>

<p>Decorator for registering a function.</p>
<p>Optionally call with types to return a decorator for unannotated functions.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">register</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nl">args</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Callable</span><span class="o">[</span><span class="n">[REGISTERED</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">REGISTERED</span><span class="err">]:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hasattr</span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;__annotations__&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">func</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">args</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="n">sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tidy_signature</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="w"> </span><span class="n">inspect</span><span class="p">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>

<span class="w">            </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">clean_signature</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">sig</span><span class="p">.</span><span class="k">parameters</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">spec</span><span class="p">.</span><span class="k">parameters</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                    </span><span class="n">f</span><span class="ss">&quot;Expected `{func.__name__}` to have {sorted(set(spec.parameters))} parameters, got {sorted(set(sig.parameters))}&quot;</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sig</span><span class="p">.</span><span class="k">parameters</span><span class="err">:</span>

<span class="w">                </span><span class="n">sig_param</span><span class="p">,</span><span class="w"> </span><span class="n">spec_param</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig</span><span class="p">.</span><span class="k">parameters</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">.</span><span class="k">parameters</span><span class="o">[</span><span class="n">name</span><span class="o">]</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">sig_param</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">spec_param</span><span class="p">.</span><span class="nl">kind</span><span class="p">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                        </span><span class="n">f</span><span class="ss">&quot;Expected the `{func.__name__}.{name}` parameter to be {spec_param.kind}, got {sig_param.kind}&quot;</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">sig_param</span><span class="p">.</span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">Any</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="p">(</span>

<span class="w">                    </span><span class="n">sig_param</span><span class="p">.</span><span class="n">annotation</span><span class="p">,</span><span class="w"> </span><span class="n">spec_param</span><span class="p">.</span><span class="n">annotation</span>

<span class="w">                </span><span class="p">)</span><span class="err">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                        </span><span class="n">f</span><span class="ss">&quot;Expected the `{func.__name__}.{name}` parameter to be a subclass of {spec_param.annotation}, got {sig_param.annotation}&quot;</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="p">(</span><span class="n">sig</span><span class="p">.</span><span class="n">return_annotation</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="p">.</span><span class="n">return_annotation</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                    </span><span class="n">f</span><span class="ss">&quot;Expected the `{func.__name__}` return to match {spec.return_annotation}, got {sig.return_annotation}&quot;</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nf">cast</span><span class="p">(</span><span class="n">Callable</span><span class="o">[</span><span class="n">..., Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">super</span><span class="p">().</span><span class="n">register</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span>
</code></pre></div>

</details>
<h3 id="write">write</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span>
    <span class="nb">format</span><span class="p">:</span> <span class="s1">&#39;Format&#39;</span><span class="p">,</span>
    <span class="n">storage_partition</span><span class="p">:</span> <span class="s1">&#39;StoragePartitionVar&#39;</span><span class="p">,</span>
    <span class="n">view</span><span class="p">:</span> <span class="s1">&#39;View&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;StoragePartitionVar&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span>

<span class="w">    </span><span class="nv">data</span><span class="o">:</span><span class="w"> </span><span class="nv">Any</span><span class="p">,</span><span class="w"> </span><span class="nv">type_</span><span class="o">:</span><span class="w"> </span><span class="nv">Type</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="nv">mat</span><span class="o">:</span><span class="w"> </span><span class="nv">Format</span><span class="p">,</span><span class="w"> </span><span class="nv">storage_partition</span><span class="o">:</span><span class="w"> </span><span class="nv">StoragePartitionVar</span><span class="p">,</span><span class="w"> </span><span class="nv">view</span><span class="o">:</span><span class="w"> </span><span class="nv">View</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nv">StoragePartitionVar</span><span class="o">:</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nv">updated</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nf">_write</span><span class="p">(</span><span class="nv">data</span><span class="p">,</span><span class="w"> </span><span class="nv">type_</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="nv">mat</span><span class="p">,</span><span class="w"> </span><span class="nv">storage_partition</span><span class="p">,</span><span class="w"> </span><span class="nv">view</span><span class="p">))</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">None</span><span class="o">:</span>

<span class="w">        </span><span class="nv">return</span><span class="w"> </span><span class="nv">updated</span>

<span class="w">    </span><span class="nv">return</span><span class="w"> </span><span class="nv">storage_partition</span>
</code></pre></div>

</details>
<h2 id="classes">Classes</h2>
<h3 id="annotation">Annotation</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Annotation</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">Annotation</span>(<span class="n">Model</span>):

    <span class="s">&quot;&quot;&quot;An Annotation is a piece of human knowledge associated with an Artifact.&quot;&quot;&quot;</span>

    <span class="n">_abstract_</span> = <span class="nb">True</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods">Static methods</h4>
<h4 id="construct">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods">Methods</h4>
<h4 id="copy">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="artifact">Artifact</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Artifact</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">class</span><span class="w"> </span><span class="n">Artifact</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="o">:</span>

<span class="w">    </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">An Artifact is the base structure describing an existing or generated dataset.</span>

<span class="s2">    An Artifact is comprised of three key elements:</span>

<span class="s2">    - `type`: spec of the data&#39;s structure, such as data types, nullable, etc.</span>

<span class="s2">    - `format`: the data&#39;s serialized format, such as CSV, Parquet, database native, etc.</span>

<span class="s2">    - `storage`: the data&#39;s persistent storage system, such as blob storage, database native, etc.</span>

<span class="s2">    In addition to the core elements, an Artifact can be tagged with additional `annotations` (to</span>

<span class="s2">    associate it with human knowledge) and `statistics` (to track derived characteristics over</span>

<span class="s2">    time).</span>

<span class="s2">    </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="k">type</span><span class="o">:</span><span class="w"> </span><span class="k">Type</span>

<span class="w">    </span><span class="k">format</span><span class="o">:</span><span class="w"> </span><span class="k">Format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">Format</span><span class="p">.</span><span class="n">get_default</span><span class="p">)</span>

<span class="w">    </span><span class="k">storage</span><span class="o">:</span><span class="w"> </span><span class="k">Storage</span><span class="err">[</span><span class="n">StoragePartition</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">Storage</span><span class="p">.</span><span class="n">get_default</span><span class="p">)</span>

<span class="w">    </span><span class="n">annotations</span><span class="o">:</span><span class="w"> </span><span class="n">tuple</span><span class="err">[</span><span class="n">Annotation</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span>

<span class="w">    </span><span class="n">statistics</span><span class="o">:</span><span class="w"> </span><span class="n">tuple</span><span class="err">[</span><span class="n">Statistic</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span>

<span class="w">    </span><span class="c1"># Hide `producer_output` in repr to prevent showing the entire upstream graph.</span>

<span class="w">    </span><span class="c1">#</span>

<span class="w">    </span><span class="c1"># ProducerOutput is a ForwardRef/cyclic import. Quote the entire hint to force full resolution</span>

<span class="w">    </span><span class="c1"># during `.update_forward_refs`, rather than `Optional[ForwardRef(&quot;ProducerOutput&quot;)]`.</span>

<span class="w">    </span><span class="n">producer_output</span><span class="o">:</span><span class="w"> </span><span class="k">Optional</span><span class="err">[</span><span class="n">ProducerOutput</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">Field</span><span class="p">(</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="n">repr</span><span class="o">=</span><span class="no">False</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># NOTE: Narrow the fields that affect the fingerprint to minimize changes (which trigger</span>

<span class="w">    </span><span class="c1"># recompute). Importantly, avoid fingerprinting the `.producer_output` (ie: the *upstream*</span>

<span class="w">    </span><span class="c1"># producer) to prevent cascading fingerprint changes (Producer.fingerprint accesses the *input*</span>

<span class="w">    </span><span class="c1"># Artifact.fingerprints). Even so, this may still be quite sensitive.</span>

<span class="w">    </span><span class="n">_fingerprint_includes_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frozenset</span><span class="p">(</span><span class="err">[</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;format&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;storage&quot;</span><span class="err">]</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@validator</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">always</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_format</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="k">format</span><span class="o">:</span><span class="w"> </span><span class="k">Format</span><span class="p">,</span><span class="w"> </span><span class="k">values</span><span class="o">:</span><span class="w"> </span><span class="n">dict</span><span class="err">[</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="k">Any</span><span class="err">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">Format</span><span class="o">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">values</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">format</span><span class="p">.</span><span class="n">_visit_type</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">format</span>

<span class="w">    </span><span class="nv">@validator</span><span class="p">(</span><span class="s2">&quot;storage&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">always</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_storage</span><span class="p">(</span>

<span class="w">        </span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="k">storage</span><span class="o">:</span><span class="w"> </span><span class="k">Storage</span><span class="err">[</span><span class="n">StoragePartition</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="k">values</span><span class="o">:</span><span class="w"> </span><span class="n">dict</span><span class="err">[</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="k">Any</span><span class="err">]</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">Storage</span><span class="err">[</span><span class="n">StoragePartition</span><span class="err">]</span><span class="o">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">values</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">            </span><span class="k">storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">storage</span><span class="p">.</span><span class="n">_visit_type</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">format_</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">values</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s2">&quot;format&quot;</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">            </span><span class="k">storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">storage</span><span class="p">.</span><span class="n">_visit_format</span><span class="p">(</span><span class="n">format_</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">storage</span>

<span class="w">    </span><span class="nv">@validator</span><span class="p">(</span><span class="s2">&quot;annotations&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;statistics&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">always</span><span class="o">=</span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="n">pre</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_merge_class_defaults</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="o">:</span><span class="w"> </span><span class="n">tuple</span><span class="err">[</span><span class="k">Any</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="o">:</span><span class="w"> </span><span class="n">ModelField</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="err">[</span><span class="k">Any</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="err">]</span><span class="o">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="k">chain</span><span class="p">(</span><span class="n">get_field_default</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="p">.</span><span class="k">name</span><span class="p">)</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="p">(),</span><span class="w"> </span><span class="k">value</span><span class="p">))</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="nf">cast</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Artifact</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Attempt to convert an arbitrary value to an appropriate Artifact instance.</span>

<span class="s2">        `Artifact.cast` is used to convert values assigned to an `ArtifactBox` (such as</span>

<span class="s2">        `Graph.artifacts`) into an Artifact. When called with:</span>

<span class="s2">        - an Artifact instance, it is returned</span>

<span class="s2">        - a Producer instance with a single output Artifact, the output Artifact is returned</span>

<span class="s2">        - a Producer instance with a multiple output Artifacts, an error is raised</span>

<span class="s2">        - other types, we attempt to map to a `Type` and return an Artifact instance with defaulted Format and Storage</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="n">arti</span><span class="p">.</span><span class="n">formats</span><span class="p">.</span><span class="kt">json</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="kt">JSON</span>

<span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="n">arti</span><span class="p">.</span><span class="n">producers</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">Producer</span>

<span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="n">arti</span><span class="p">.</span><span class="k">storage</span><span class="p">.</span><span class="n">literal</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">StringLiteral</span>

<span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="n">arti</span><span class="p">.</span><span class="k">types</span><span class="p">.</span><span class="n">python</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">python_type_system</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="n">Artifact</span><span class="p">)</span><span class="o">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">value</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="n">Producer</span><span class="p">)</span><span class="o">:</span>

<span class="w">            </span><span class="n">output_artifacts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">value</span><span class="p">.</span><span class="k">out</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">output_artifacts</span><span class="p">,</span><span class="w"> </span><span class="n">Artifact</span><span class="p">)</span><span class="o">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">output_artifacts</span>

<span class="w">            </span><span class="n">n_outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">output_artifacts</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">n_outputs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w">  </span><span class="c1"># pragma: no cover</span>

<span class="w">                </span><span class="c1"># TODO: &quot;side effect&quot; Producers: https://github.com/artigraph/artigraph/issues/11</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;{type(value).__name__} doesn&#39;t produce any Artifacts!&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">assert</span><span class="w"> </span><span class="n">n_outputs</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="s2">&quot;{type(value).__name__} produces {len(output_artifacts)} Artifacts. Try assigning each to a new name in the Graph!&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">annotation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_annotation_from_value</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">(</span>

<span class="w">            </span><span class="k">type</span><span class="o">=</span><span class="n">python_type_system</span><span class="p">.</span><span class="n">to_artigraph</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="err">{}</span><span class="p">),</span>

<span class="w">            </span><span class="k">format</span><span class="o">=</span><span class="kt">JSON</span><span class="p">(),</span>

<span class="w">            </span><span class="k">storage</span><span class="o">=</span><span class="n">StringLiteral</span><span class="p">(</span><span class="k">value</span><span class="o">=</span><span class="kt">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="k">value</span><span class="p">)),</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_1">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables_1">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_1">Static methods</h4>
<h4 id="cast">cast</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">cast</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Artifact&#39;</span>
</code></pre></div>

<p>Attempt to convert an arbitrary value to an appropriate Artifact instance.</p>
<p><code>Artifact.cast</code> is used to convert values assigned to an <code>ArtifactBox</code> (such as
<code>Graph.artifacts</code>) into an Artifact. When called with:
- an Artifact instance, it is returned
- a Producer instance with a single output Artifact, the output Artifact is returned
- a Producer instance with a multiple output Artifacts, an error is raised
- other types, we attempt to map to a <code>Type</code> and return an Artifact instance with defaulted Format and Storage</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">cast</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Artifact</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Attempt to convert an arbitrary value to an appropriate Artifact instance.</span>

<span class="sd">        `Artifact.cast` is used to convert values assigned to an `ArtifactBox` (such as</span>

<span class="sd">        `Graph.artifacts`) into an Artifact. When called with:</span>

<span class="sd">        - an Artifact instance, it is returned</span>

<span class="sd">        - a Producer instance with a single output Artifact, the output Artifact is returned</span>

<span class="sd">        - a Producer instance with a multiple output Artifacts, an error is raised</span>

<span class="sd">        - other types, we attempt to map to a `Type` and return an Artifact instance with defaulted Format and Storage</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">arti.formats.json</span> <span class="kn">import</span> <span class="n">JSON</span>

        <span class="kn">from</span> <span class="nn">arti.producers</span> <span class="kn">import</span> <span class="n">Producer</span>

        <span class="kn">from</span> <span class="nn">arti.storage.literal</span> <span class="kn">import</span> <span class="n">StringLiteral</span>

        <span class="kn">from</span> <span class="nn">arti.types.python</span> <span class="kn">import</span> <span class="n">python_type_system</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Artifact</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">value</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Producer</span><span class="p">):</span>

            <span class="n">output_artifacts</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">out</span><span class="p">()</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_artifacts</span><span class="p">,</span> <span class="n">Artifact</span><span class="p">):</span>

                <span class="k">return</span> <span class="n">output_artifacts</span>

            <span class="n">n_outputs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_artifacts</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">n_outputs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>

                <span class="c1"># TODO: &quot;side effect&quot; Producers: https://github.com/artigraph/artigraph/issues/11</span>

                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> doesn&#39;t produce any Artifacts!&quot;</span><span class="p">)</span>

            <span class="k">assert</span> <span class="n">n_outputs</span> <span class="o">&gt;</span> <span class="mi">1</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> produces </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">output_artifacts</span><span class="p">)</span><span class="si">}</span><span class="s2"> Artifacts. Try assigning each to a new name in the Graph!&quot;</span>

            <span class="p">)</span>

        <span class="n">annotation</span> <span class="o">=</span> <span class="n">get_annotation_from_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>

            <span class="nb">type</span><span class="o">=</span><span class="n">python_type_system</span><span class="o">.</span><span class="n">to_artigraph</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span> <span class="n">hints</span><span class="o">=</span><span class="p">{}),</span>

            <span class="nb">format</span><span class="o">=</span><span class="n">JSON</span><span class="p">(),</span>

            <span class="n">storage</span><span class="o">=</span><span class="n">StringLiteral</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">value</span><span class="p">)),</span>

        <span class="p">)</span>
</code></pre></div>

</details>
<h4 id="construct_1">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_1">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_1">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_1">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_1">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_1">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_1">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_1">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_1">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_1">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_1">Methods</h4>
<h4 id="copy_1">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_1">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_1">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="backend">Backend</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Backend</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Backend</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span><span class="w"> </span><span class="n">Generic</span><span class="o">[</span><span class="n">ConnectionVar</span><span class="o">]</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Backend represents a storage for internal Artigraph metadata.</span>

<span class="ss">    Backend storage is an addressable location (local path, database connection, etc) that</span>

<span class="ss">    tracks metadata for a collection of Graphs over time, including:</span>

<span class="ss">    - the Artifact(s)-&gt;Producer-&gt;Artifact(s) dependency graph</span>

<span class="ss">    - Artifact Annotations, Statistics, Partitions, and other metadata</span>

<span class="ss">    - Artifact and Producer Fingerprints</span>

<span class="ss">    - etc</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="nv">@contextmanager</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">connect</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="o">[</span><span class="n">ConnectionVar</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_2">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
<li>typing.Generic</li>
</ul>
<h4 id="descendants">Descendants</h4>
<ul>
<li>arti.backends.memory.MemoryBackend</li>
</ul>
<h4 id="class-variables_2">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_2">Static methods</h4>
<h4 id="construct_2">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_2">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_2">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_2">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_2">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_2">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_2">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_2">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_2">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_2">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_2">Methods</h4>
<h4 id="connect">connect</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">connect</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Iterator[ConnectionVar]&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@contextmanager</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">connect</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="o">[</span><span class="n">ConnectionVar</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="copy_2">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_2">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_2">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="connection">Connection</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Connection</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">class</span><span class="w"> </span><span class="k">Connection</span><span class="o">:</span>

<span class="w">    </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Connection is a wrapper around an active connection to a Backend resource.</span>

<span class="s2">    For example, a Backend connecting to a database might wrap up a SQLAlchemy connection in a</span>

<span class="s2">    Connection subclass implementing the required methods.</span>

<span class="s2">    </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">    </span><span class="c1"># Artifact partitions - independent of a specific GraphSnapshot</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_artifact_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="o">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="n">input_fingerprints</span><span class="o">:</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">()</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Read all known Partitions for this Storage spec.</span>

<span class="s2">        If `input_fingerprints` is provided, the returned partitions will be filtered accordingly.</span>

<span class="s2">        NOTE: The returned partitions may not be associated with any particular Graph, unless</span>

<span class="s2">        `input_fingerprints` is provided matching those for a GraphSnapshot.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_artifact_partitions</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="o">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="k">partitions</span><span class="o">:</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Add more partitions for a Storage spec.</span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="c1"># Graph</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_graph</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">fingerprint</span><span class="o">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Graph</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Fetch an instance of the named Graph.</span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_graph</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">graph</span><span class="o">:</span><span class="w"> </span><span class="n">Graph</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Write the Graph and all linked Artifacts and Producers to the database.</span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="c1"># GraphSnapshot</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_snapshot</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">fingerprint</span><span class="o">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Fetch an instance of the named GraphSnapshot.</span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_snapshot</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">snapshot</span><span class="o">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Write the GraphSnapshot to the database.</span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_snapshot_tag</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Fetch the GraphSnapshot for the named tag.</span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_snapshot_tag</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">snapshot</span><span class="o">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">overwrite</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Stamp a GraphSnapshot with an arbitrary tag.</span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_snapshot_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">snapshot</span><span class="o">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span><span class="w"> </span><span class="n">artifact_key</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="o">:</span><span class="w"> </span><span class="n">Artifact</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Read the known Partitions for the named Artifact in a specific GraphSnapshot.</span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_snapshot_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="k">snapshot</span><span class="o">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span>

<span class="w">        </span><span class="n">artifact_key</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span>

<span class="w">        </span><span class="n">artifact</span><span class="o">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="k">partitions</span><span class="o">:</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Link the Partitions to the named Artifact in a specific GraphSnapshot.</span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="c1"># Helpers</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_artifact_and_graph_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="k">snapshot</span><span class="o">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span>

<span class="w">        </span><span class="n">artifact_key</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span>

<span class="w">        </span><span class="n">artifact</span><span class="o">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="k">partitions</span><span class="o">:</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="o">:</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">write_artifact_partitions</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="k">partitions</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">write_snapshot_partitions</span><span class="p">(</span><span class="k">snapshot</span><span class="p">,</span><span class="w"> </span><span class="n">artifact_key</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="k">partitions</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@contextmanager</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">connect</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="err">[</span><span class="n">Self</span><span class="err">]</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Return self</span>

<span class="s2">        This makes it easier to work with an Optional connection, eg:</span>

<span class="s2">            with (connection or backend).connect() as conn:</span>

<span class="s2">                ...</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">yield</span><span class="w"> </span><span class="n">self</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__get_validators__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">list</span><span class="err">[</span><span class="n">Callable</span><span class="err">[[</span><span class="k">Any</span><span class="p">,</span><span class="w"> </span><span class="n">ModelField</span><span class="err">]</span><span class="p">,</span><span class="w"> </span><span class="k">Any</span><span class="err">]]</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Return an empty list of &quot;</span><span class="n">validators</span><span class="s2">&quot;.</span>

<span class="s2">        Allows using a Connection (which is not a model) as a field in other models without setting</span>

<span class="s2">        `arbitrary_types_allowed` (which applies broadly). [1].</span>

<span class="s2">        1: https://docs.pydantic.dev/usage/types/#generic-classes-as-types</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">[]</span>
</code></pre></div>

</details>
<hr />
<h4 id="descendants_1">Descendants</h4>
<ul>
<li>arti.backends.memory.MemoryConnection</li>
</ul>
<h4 id="methods_3">Methods</h4>
<h4 id="connect_1">connect</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">connect</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Iterator[Self]&#39;</span>
</code></pre></div>

<p>Return self</p>
<p>This makes it easier to work with an Optional connection, eg:
    with (connection or backend).connect() as conn:
        ...</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@contextmanager</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">connect</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="o">[</span><span class="n">Self</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Return self</span>

<span class="ss">        This makes it easier to work with an Optional connection, eg:</span>

<span class="ss">            with (connection or backend).connect() as conn:</span>

<span class="ss">                ...</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">yield</span><span class="w"> </span><span class="n">self</span>
</code></pre></div>

</details>
<h4 id="read_artifact_partitions">read_artifact_partitions</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">read_artifact_partitions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">,</span>
    <span class="n">input_fingerprints</span><span class="p">:</span> <span class="s1">&#39;InputFingerprints&#39;</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;StoragePartitions&#39;</span>
</code></pre></div>

<p>Read all known Partitions for this Storage spec.</p>
<p>If <code>input_fingerprints</code> is provided, the returned partitions will be filtered accordingly.</p>
<p>NOTE: The returned partitions may not be associated with any particular Graph, unless
<code>input_fingerprints</code> is provided matching those for a GraphSnapshot.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_artifact_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="o">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="n">input_fingerprints</span><span class="o">:</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">()</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="o">:</span>

<span class="w">        </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Read all known Partitions for this Storage spec.</span>

<span class="s2">        If `input_fingerprints` is provided, the returned partitions will be filtered accordingly.</span>

<span class="s2">        NOTE: The returned partitions may not be associated with any particular Graph, unless</span>

<span class="s2">        `input_fingerprints` is provided matching those for a GraphSnapshot.</span>

<span class="s2">        </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="read_graph">read_graph</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">read_graph</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="n">fingerprint</span><span class="p">:</span> <span class="s1">&#39;Fingerprint&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Graph&#39;</span>
</code></pre></div>

<p>Fetch an instance of the named Graph.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_graph</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Graph</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Fetch an instance of the named Graph.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="read_snapshot">read_snapshot</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">read_snapshot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="n">fingerprint</span><span class="p">:</span> <span class="s1">&#39;Fingerprint&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;GraphSnapshot&#39;</span>
</code></pre></div>

<p>Fetch an instance of the named GraphSnapshot.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_snapshot</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Fetch an instance of the named GraphSnapshot.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="read_snapshot_partitions">read_snapshot_partitions</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">read_snapshot_partitions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;GraphSnapshot&#39;</span><span class="p">,</span>
    <span class="n">artifact_key</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;StoragePartitions&#39;</span>
</code></pre></div>

<p>Read the known Partitions for the named Artifact in a specific GraphSnapshot.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_snapshot_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span><span class="w"> </span><span class="nl">artifact_key</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">StoragePartitions</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Read the known Partitions for the named Artifact in a specific GraphSnapshot.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="read_snapshot_tag">read_snapshot_tag</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">read_snapshot_tag</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;GraphSnapshot&#39;</span>
</code></pre></div>

<p>Fetch the GraphSnapshot for the named tag.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">read_snapshot_tag</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">tag</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Fetch the GraphSnapshot for the named tag.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="write_artifact_and_graph_partitions">write_artifact_and_graph_partitions</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write_artifact_and_graph_partitions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;GraphSnapshot&#39;</span><span class="p">,</span>
    <span class="n">artifact_key</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">,</span>
    <span class="n">partitions</span><span class="p">:</span> <span class="s1">&#39;StoragePartitions&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_artifact_and_graph_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="kr">self</span><span class="p">,</span>

<span class="w">        </span><span class="n">snapshot</span><span class="o">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span>

<span class="w">        </span><span class="n">artifact_key</span><span class="o">:</span><span class="w"> </span><span class="n">str</span><span class="p">,</span>

<span class="w">        </span><span class="n">artifact</span><span class="o">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="n">partitions</span><span class="o">:</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="o">:</span>

<span class="w">        </span><span class="kr">self</span><span class="p">.</span><span class="n">write_artifact_partitions</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="p">)</span>

<span class="w">        </span><span class="kr">self</span><span class="p">.</span><span class="n">write_snapshot_partitions</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="n">artifact_key</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="write_artifact_partitions">write_artifact_partitions</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write_artifact_partitions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">,</span>
    <span class="n">partitions</span><span class="p">:</span> <span class="s1">&#39;StoragePartitions&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>Add more partitions for a Storage spec.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_artifact_partitions</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="nl">partitions</span><span class="p">:</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Add more partitions for a Storage spec.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="write_graph">write_graph</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write_graph</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">graph</span><span class="p">:</span> <span class="s1">&#39;Graph&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>Write the Graph and all linked Artifacts and Producers to the database.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_graph</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">graph</span><span class="p">:</span><span class="w"> </span><span class="n">Graph</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Write the Graph and all linked Artifacts and Producers to the database.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="write_snapshot">write_snapshot</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write_snapshot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;GraphSnapshot&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>Write the GraphSnapshot to the database.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_snapshot</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Write the GraphSnapshot to the database.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="write_snapshot_partitions">write_snapshot_partitions</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write_snapshot_partitions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;GraphSnapshot&#39;</span><span class="p">,</span>
    <span class="n">artifact_key</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">,</span>
    <span class="n">partitions</span><span class="p">:</span> <span class="s1">&#39;StoragePartitions&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>Link the Partitions to the named Artifact in a specific GraphSnapshot.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_snapshot_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span>

<span class="w">        </span><span class="nl">artifact_key</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span>

<span class="w">        </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="nl">partitions</span><span class="p">:</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Link the Partitions to the named Artifact in a specific GraphSnapshot.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="write_snapshot_tag">write_snapshot_tag</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write_snapshot_tag</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;GraphSnapshot&#39;</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<p>Stamp a GraphSnapshot with an arbitrary tag.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">write_snapshot_tag</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span><span class="w"> </span><span class="nl">tag</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">overwrite</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Stamp a GraphSnapshot with an arbitrary tag.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="executor">Executor</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Executor</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Executor</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="nv">@abc</span><span class="p">.</span><span class="n">abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_producer_inputs</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="k">Connection</span><span class="p">,</span><span class="w"> </span><span class="nl">producer</span><span class="p">:</span><span class="w"> </span><span class="n">Producer</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">InputPartitions</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">InputPartitions</span><span class="p">(</span>

<span class="w">            </span><span class="err">{</span>

<span class="w">                </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="k">connection</span><span class="p">.</span><span class="n">read_snapshot_partitions</span><span class="p">(</span>

<span class="w">                    </span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">artifact_to_key</span><span class="o">[</span><span class="n">artifact</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">producer</span><span class="p">.</span><span class="n">inputs</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">            </span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">discover_producer_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="k">Connection</span><span class="p">,</span>

<span class="w">        </span><span class="nl">producer</span><span class="p">:</span><span class="w"> </span><span class="n">Producer</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">partition_input_fingerprints</span><span class="p">:</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">set</span><span class="o">[</span><span class="n">CompositeKey</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">built</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">yet</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">GraphSnapshot</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">changed</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">trickled</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">Producer</span><span class="p">).</span><span class="w"> </span><span class="n">Hence</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">we</span><span class="s1">&#39;ll fetch all StoragePartitions for each Storage, filtered to the PKs and</span>

<span class="s1">        # input_fingerprints we&#39;</span><span class="n">ve</span><span class="w"> </span><span class="n">computed</span><span class="w"> </span><span class="o">*</span><span class="k">are</span><span class="o">*</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span>

<span class="w">        </span><span class="n">existing_output_partitions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="k">output</span><span class="err">:</span><span class="w"> </span><span class="k">connection</span><span class="p">.</span><span class="n">read_artifact_partitions</span><span class="p">(</span><span class="k">output</span><span class="p">,</span><span class="w"> </span><span class="n">partition_input_fingerprints</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">producer_outputs</span><span class="o">[</span><span class="n">producer</span><span class="o">]</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">existing_output_partitions</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="k">connection</span><span class="p">.</span><span class="n">write_snapshot_partitions</span><span class="p">(</span>

<span class="w">                </span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">artifact_to_key</span><span class="o">[</span><span class="n">artifact</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Guarantee</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">outputs</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">identified</span><span class="w"> </span><span class="n">partitions</span><span class="p">.</span><span class="w"> </span><span class="n">Currently</span><span class="p">,</span><span class="w"> </span><span class="n">this</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">pretends</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">outputs</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">_any_</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">partition</span><span class="p">.</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="k">partition</span><span class="p">.</span><span class="n">keys</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">chain</span><span class="p">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">existing_output_partitions</span><span class="p">.</span><span class="k">values</span><span class="p">())</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">build_producer_partition</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="k">Connection</span><span class="p">,</span>

<span class="w">        </span><span class="nl">producer</span><span class="p">:</span><span class="w"> </span><span class="n">Producer</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">existing_partition_keys</span><span class="p">:</span><span class="w"> </span><span class="k">set</span><span class="o">[</span><span class="n">CompositeKey</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">input_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">,</span>

<span class="w">        </span><span class="nl">partition_dependencies</span><span class="p">:</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">str, StoragePartitions</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">partition_key</span><span class="p">:</span><span class="w"> </span><span class="n">CompositeKey</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Should</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="ss">&quot;skip if exists&quot;</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">here</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">up</span><span class="vm">?</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">partition_key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">existing_partition_keys</span><span class="p">:</span>

<span class="w">            </span><span class="n">pk_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="ss">&quot; for: {dict(partition_key)}&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">partition_key</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="ss">&quot;.&quot;</span>

<span class="w">            </span><span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Skipping existing {type(producer).__name__} output{pk_str}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Building {producer} output for {partition_key}...&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">Catch</span><span class="w"> </span><span class="n">DispatchError</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">nicer</span><span class="w"> </span><span class="n">error</span><span class="p">...</span><span class="w"> </span><span class="n">maybe</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">our</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nv">@dispatch</span><span class="w"> </span><span class="n">wrapper</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="n">arg</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">fn</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">to</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">raise</span><span class="p">).</span>

<span class="w">        </span><span class="n">arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="k">read</span><span class="p">(</span>

<span class="w">                </span><span class="n">artifact</span><span class="o">=</span><span class="n">producer</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="n">storage_partitions</span><span class="o">=</span><span class="n">partition_dependencies</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="k">view</span><span class="o">=</span><span class="k">view</span><span class="p">,</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">producer</span><span class="p">.</span><span class="n">_build_inputs_</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">producer</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">producer</span><span class="p">.</span><span class="n">_outputs_</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span>

<span class="w">            </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">outputs</span><span class="p">,)</span>

<span class="w">        </span><span class="n">validation_passed</span><span class="p">,</span><span class="w"> </span><span class="n">validation_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">producer</span><span class="p">.</span><span class="n">validate_outputs</span><span class="p">(</span><span class="o">*</span><span class="n">outputs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">validation_passed</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">validation_message</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">snapshot</span><span class="p">.</span><span class="k">write</span><span class="p">(</span>

<span class="w">                </span><span class="k">output</span><span class="p">,</span>

<span class="w">                </span><span class="n">artifact</span><span class="o">=</span><span class="n">snapshot</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">producer_outputs</span><span class="o">[</span><span class="n">producer</span><span class="o">][</span><span class="n">i</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="n">input_fingerprint</span><span class="o">=</span><span class="n">input_fingerprint</span><span class="p">,</span>

<span class="w">                </span><span class="n">keys</span><span class="o">=</span><span class="n">partition_key</span><span class="p">,</span>

<span class="w">                </span><span class="k">view</span><span class="o">=</span><span class="n">producer</span><span class="p">.</span><span class="n">_outputs_</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span>

<span class="w">            </span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_3">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="descendants_2">Descendants</h4>
<ul>
<li>arti.executors.local.LocalExecutor</li>
</ul>
<h4 id="class-variables_3">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_3">Static methods</h4>
<h4 id="construct_3">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_3">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_3">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_3">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_3">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_3">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_3">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_3">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_3">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_3">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_4">Methods</h4>
<h4 id="build">build</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;GraphSnapshot&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abc</span><span class="p">.</span><span class="n">abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="build_producer_partition">build_producer_partition</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">build_producer_partition</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;GraphSnapshot&#39;</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Connection&#39;</span><span class="p">,</span>
    <span class="n">producer</span><span class="p">:</span> <span class="s1">&#39;Producer&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">existing_partition_keys</span><span class="p">:</span> <span class="s1">&#39;set[CompositeKey]&#39;</span><span class="p">,</span>
    <span class="n">input_fingerprint</span><span class="p">:</span> <span class="s1">&#39;Fingerprint&#39;</span><span class="p">,</span>
    <span class="n">partition_dependencies</span><span class="p">:</span> <span class="s1">&#39;frozendict[str, StoragePartitions]&#39;</span><span class="p">,</span>
    <span class="n">partition_key</span><span class="p">:</span> <span class="s1">&#39;CompositeKey&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">build_producer_partition</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="k">Connection</span><span class="p">,</span>

<span class="w">        </span><span class="nl">producer</span><span class="p">:</span><span class="w"> </span><span class="n">Producer</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">existing_partition_keys</span><span class="p">:</span><span class="w"> </span><span class="k">set</span><span class="o">[</span><span class="n">CompositeKey</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">input_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">,</span>

<span class="w">        </span><span class="nl">partition_dependencies</span><span class="p">:</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">str, StoragePartitions</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">partition_key</span><span class="p">:</span><span class="w"> </span><span class="n">CompositeKey</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Should</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="ss">&quot;skip if exists&quot;</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">here</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">up</span><span class="vm">?</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">partition_key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">existing_partition_keys</span><span class="p">:</span>

<span class="w">            </span><span class="n">pk_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="ss">&quot; for: {dict(partition_key)}&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">partition_key</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="ss">&quot;.&quot;</span>

<span class="w">            </span><span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Skipping existing {type(producer).__name__} output{pk_str}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Building {producer} output for {partition_key}...&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">Catch</span><span class="w"> </span><span class="n">DispatchError</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">nicer</span><span class="w"> </span><span class="n">error</span><span class="p">...</span><span class="w"> </span><span class="n">maybe</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">our</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nv">@dispatch</span><span class="w"> </span><span class="n">wrapper</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="n">arg</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">fn</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="k">to</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">raise</span><span class="p">).</span>

<span class="w">        </span><span class="n">arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="k">read</span><span class="p">(</span>

<span class="w">                </span><span class="n">artifact</span><span class="o">=</span><span class="n">producer</span><span class="p">.</span><span class="n">inputs</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="n">storage_partitions</span><span class="o">=</span><span class="n">partition_dependencies</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="k">view</span><span class="o">=</span><span class="k">view</span><span class="p">,</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">producer</span><span class="p">.</span><span class="n">_build_inputs_</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">producer</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">producer</span><span class="p">.</span><span class="n">_outputs_</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span>

<span class="w">            </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">outputs</span><span class="p">,)</span>

<span class="w">        </span><span class="n">validation_passed</span><span class="p">,</span><span class="w"> </span><span class="n">validation_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">producer</span><span class="p">.</span><span class="n">validate_outputs</span><span class="p">(</span><span class="o">*</span><span class="n">outputs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">validation_passed</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">validation_message</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">snapshot</span><span class="p">.</span><span class="k">write</span><span class="p">(</span>

<span class="w">                </span><span class="k">output</span><span class="p">,</span>

<span class="w">                </span><span class="n">artifact</span><span class="o">=</span><span class="n">snapshot</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">producer_outputs</span><span class="o">[</span><span class="n">producer</span><span class="o">][</span><span class="n">i</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="n">input_fingerprint</span><span class="o">=</span><span class="n">input_fingerprint</span><span class="p">,</span>

<span class="w">                </span><span class="n">keys</span><span class="o">=</span><span class="n">partition_key</span><span class="p">,</span>

<span class="w">                </span><span class="k">view</span><span class="o">=</span><span class="n">producer</span><span class="p">.</span><span class="n">_outputs_</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span>

<span class="w">            </span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="copy_3">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_3">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="discover_producer_partitions">discover_producer_partitions</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">discover_producer_partitions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;GraphSnapshot&#39;</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Connection&#39;</span><span class="p">,</span>
    <span class="n">producer</span><span class="p">:</span> <span class="s1">&#39;Producer&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">partition_input_fingerprints</span><span class="p">:</span> <span class="s1">&#39;InputFingerprints&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;set[CompositeKey]&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">discover_producer_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="k">Connection</span><span class="p">,</span>

<span class="w">        </span><span class="nl">producer</span><span class="p">:</span><span class="w"> </span><span class="n">Producer</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">partition_input_fingerprints</span><span class="p">:</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">set</span><span class="o">[</span><span class="n">CompositeKey</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">built</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">yet</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">GraphSnapshot</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">changed</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">trickled</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="n">Producer</span><span class="p">).</span><span class="w"> </span><span class="n">Hence</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">we</span><span class="s1">&#39;ll fetch all StoragePartitions for each Storage, filtered to the PKs and</span>

<span class="s1">        # input_fingerprints we&#39;</span><span class="n">ve</span><span class="w"> </span><span class="n">computed</span><span class="w"> </span><span class="o">*</span><span class="k">are</span><span class="o">*</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span>

<span class="w">        </span><span class="n">existing_output_partitions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="k">output</span><span class="err">:</span><span class="w"> </span><span class="k">connection</span><span class="p">.</span><span class="n">read_artifact_partitions</span><span class="p">(</span><span class="k">output</span><span class="p">,</span><span class="w"> </span><span class="n">partition_input_fingerprints</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">producer_outputs</span><span class="o">[</span><span class="n">producer</span><span class="o">]</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">existing_output_partitions</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="k">connection</span><span class="p">.</span><span class="n">write_snapshot_partitions</span><span class="p">(</span>

<span class="w">                </span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">artifact_to_key</span><span class="o">[</span><span class="n">artifact</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Guarantee</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">outputs</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">identified</span><span class="w"> </span><span class="n">partitions</span><span class="p">.</span><span class="w"> </span><span class="n">Currently</span><span class="p">,</span><span class="w"> </span><span class="n">this</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">pretends</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">outputs</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">_any_</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">partition</span><span class="p">.</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="k">partition</span><span class="p">.</span><span class="n">keys</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">chain</span><span class="p">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">existing_output_partitions</span><span class="p">.</span><span class="k">values</span><span class="p">())</span>

<span class="w">        </span><span class="err">}</span>
</code></pre></div>

</details>
<h4 id="get_producer_inputs">get_producer_inputs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_producer_inputs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;GraphSnapshot&#39;</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Connection&#39;</span><span class="p">,</span>
    <span class="n">producer</span><span class="p">:</span> <span class="s1">&#39;Producer&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;InputPartitions&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_producer_inputs</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="k">Connection</span><span class="p">,</span><span class="w"> </span><span class="nl">producer</span><span class="p">:</span><span class="w"> </span><span class="n">Producer</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">InputPartitions</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">InputPartitions</span><span class="p">(</span>

<span class="w">            </span><span class="err">{</span>

<span class="w">                </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="k">connection</span><span class="p">.</span><span class="n">read_snapshot_partitions</span><span class="p">(</span>

<span class="w">                    </span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">artifact_to_key</span><span class="o">[</span><span class="n">artifact</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">producer</span><span class="p">.</span><span class="n">inputs</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">            </span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="json_3">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="fingerprint">Fingerprint</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Fingerprint</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Fingerprint represents a unique identity as an int64 value.</span>

<span class="ss">    Using an int(64) has a number of convenient properties:</span>

<span class="ss">    - can be combined independent of order with XOR</span>

<span class="ss">    - can be stored relatively cheaply</span>

<span class="ss">    - empty 0 values drop out when combined (5 ^ 0 = 5)</span>

<span class="ss">    - is relatively cross-platform (across databases, languages, etc)</span>

<span class="ss">    There are two &quot;</span><span class="n">special</span><span class="ss">&quot; Fingerprints w/ factory functions that, when combined with other</span>

<span class="ss">    Fingerprints:</span>

<span class="ss">    - `empty()`: returns `empty()`</span>

<span class="ss">    - `identity()`: return the other Fingerprint</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int64</span><span class="o">]</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">combine</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nl">others</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="p">.</span><span class="n">xor</span><span class="p">,</span><span class="w"> </span><span class="n">others</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">empty</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Return a Fingerprint that, when combined, will return Fingerprint.empty()&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">(</span><span class="k">key</span><span class="o">=</span><span class="k">None</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_int</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">from_int64</span><span class="p">(</span><span class="n">int64</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_int64</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="n">int64</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">(</span><span class="k">key</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_string</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Fingerprint an arbitrary string.</span>

<span class="ss">        Fingerprints using Farmhash Fingerprint64, converted to int64 via two&#39;s complement.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">from_uint64</span><span class="p">(</span><span class="n">uint64</span><span class="p">(</span><span class="n">farmhash</span><span class="p">.</span><span class="n">fingerprint64</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_uint64</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="n">uint64</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">from_int64</span><span class="p">(</span><span class="n">int64</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">identity</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Return a Fingerprint that, when combined, will return the other Fingerprint.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">(</span><span class="k">key</span><span class="o">=</span><span class="n">int64</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">is_empty</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">is_identity</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="n">__and__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_gen_fingerprint_binop</span><span class="p">(</span><span class="n">operator</span><span class="p">.</span><span class="n">__and__</span><span class="p">)</span>

<span class="w">    </span><span class="n">__lshift__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_gen_fingerprint_binop</span><span class="p">(</span><span class="n">operator</span><span class="p">.</span><span class="n">__lshift__</span><span class="p">)</span>

<span class="w">    </span><span class="n">__or__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_gen_fingerprint_binop</span><span class="p">(</span><span class="n">operator</span><span class="p">.</span><span class="n">__or__</span><span class="p">)</span>

<span class="w">    </span><span class="n">__rshift__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_gen_fingerprint_binop</span><span class="p">(</span><span class="n">operator</span><span class="p">.</span><span class="n">__rshift__</span><span class="p">)</span>

<span class="w">    </span><span class="n">__xor__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_gen_fingerprint_binop</span><span class="p">(</span><span class="n">operator</span><span class="p">.</span><span class="n">__xor__</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__eq__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">other</span><span class="p">:</span><span class="w"> </span><span class="k">object</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="w"> </span><span class="nc">int</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">other</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">.</span><span class="n">from_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="k">key</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">NotImplemented</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_4">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables_4">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_4">Static methods</h4>
<h4 id="construct_4">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="empty">empty</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">empty</span><span class="p">(</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Fingerprint&#39;</span>
</code></pre></div>

<p>Return a Fingerprint that, when combined, will return Fingerprint.empty()</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">empty</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Return a Fingerprint that, when combined, will return Fingerprint.empty()&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">(</span><span class="k">key</span><span class="o">=</span><span class="k">None</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="from_int">from_int</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_int</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span><span class="p">,</span>
    <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Fingerprint&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_int</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">from_int64</span><span class="p">(</span><span class="n">int64</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div>

</details>
<h4 id="from_int64">from_int64</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_int64</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;int64&#39;</span><span class="p">,</span>
    <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Fingerprint&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_int64</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="n">int64</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">(</span><span class="k">key</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="from_orm_4">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="from_string">from_string</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Fingerprint&#39;</span>
</code></pre></div>

<p>Fingerprint an arbitrary string.</p>
<p>Fingerprints using Farmhash Fingerprint64, converted to int64 via two's complement.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_string</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Fingerprint an arbitrary string.</span>

<span class="ss">        Fingerprints using Farmhash Fingerprint64, converted to int64 via two&#39;s complement.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">from_uint64</span><span class="p">(</span><span class="n">uint64</span><span class="p">(</span><span class="n">farmhash</span><span class="p">.</span><span class="n">fingerprint64</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</code></pre></div>

</details>
<h4 id="from_uint64">from_uint64</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_uint64</span><span class="p">(</span>
    <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;uint64&#39;</span><span class="p">,</span>
    <span class="o">/</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Fingerprint&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_uint64</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="n">uint64</span><span class="p">,</span><span class="w"> </span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">from_int64</span><span class="p">(</span><span class="n">int64</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div>

</details>
<h4 id="identity">identity</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">identity</span><span class="p">(</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Fingerprint&#39;</span>
</code></pre></div>

<p>Return a Fingerprint that, when combined, will return the other Fingerprint.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">identity</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Return a Fingerprint that, when combined, will return the other Fingerprint.&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">(</span><span class="k">key</span><span class="o">=</span><span class="n">int64</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div>

</details>
<h4 id="parse_file_4">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_4">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_4">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_4">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_4">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_4">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_4">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_4">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">is_empty</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">is_identity</span>
</code></pre></div>

<h4 id="methods_5">Methods</h4>
<h4 id="combine">combine</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">combine</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">others</span><span class="p">:</span> <span class="s1">&#39;Fingerprint&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Fingerprint&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="nf">combine</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">others</span><span class="o">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Fingerprint</span><span class="o">:</span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="p">.</span><span class="n">xor</span><span class="p">,</span><span class="w"> </span><span class="n">others</span><span class="p">,</span><span class="w"> </span><span class="kr">self</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="copy_4">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_4">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_4">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="format">Format</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Format</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Format</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format represents file formats such as CSV, Parquet, native (eg: databases), etc.</span>

<span class="sd">    Formats are associated with a type system that provides a bridge between the internal</span>

<span class="sd">    Artigraph types and any external type information.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_abstract_</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">type_system</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">TypeSystem</span><span class="p">]</span>

    <span class="n">extension</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_visit_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="n">Type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>

        <span class="c1"># Ensure our type system can handle the provided type.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">type_system</span><span class="o">.</span><span class="n">to_system</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">hints</span><span class="o">=</span><span class="p">{})</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">get_default</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Format</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">arti.formats.json</span> <span class="kn">import</span> <span class="n">JSON</span>

        <span class="k">return</span> <span class="n">JSON</span><span class="p">()</span>  <span class="c1"># TODO: Support some sort of configurable defaults.</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_5">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="descendants_3">Descendants</h4>
<ul>
<li>arti.formats.json.JSON</li>
<li>arti.formats.pickle.Pickle</li>
</ul>
<h4 id="class-variables_5">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_5">Static methods</h4>
<h4 id="construct_5">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_5">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="get_default">get_default</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_default</span><span class="p">(</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Format&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">get_default</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Format</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">arti.formats.json</span> <span class="kn">import</span> <span class="n">JSON</span>

        <span class="k">return</span> <span class="n">JSON</span><span class="p">()</span>  <span class="c1"># TODO: Support some sort of configurable defaults.</span>
</code></pre></div>

</details>
<h4 id="parse_file_5">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_5">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_5">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_5">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_5">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_5">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_5">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_5">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_6">Methods</h4>
<h4 id="copy_5">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_5">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_5">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="graph">Graph</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Graph</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Graph</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Graph stores a web of Artifacts connected by Producers.&quot;&quot;&quot;</span>

<span class="w">    </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span>

<span class="w">    </span><span class="nl">artifacts</span><span class="p">:</span><span class="w"> </span><span class="n">ArtifactBox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nl">lambda</span><span class="p">:</span><span class="w"> </span><span class="n">ArtifactBox</span><span class="p">(</span><span class="o">**</span><span class="n">BOX_KWARGS</span><span class="o">[</span><span class="n">SEALED</span><span class="o">]</span><span class="p">))</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Backend</span><span class="w"> </span><span class="o">*</span><span class="n">itself</span><span class="o">*</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">affect</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Graph</span><span class="w"> </span><span class="n">build</span><span class="p">,</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">contents</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">certainly</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="n">annotations</span><span class="p">),</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">serializing</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">prevent</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">embedding</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">credentials</span><span class="p">.</span>

<span class="w">    </span><span class="nl">backend</span><span class="p">:</span><span class="w"> </span><span class="n">Backend</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">_get_memory_backend</span><span class="p">,</span><span class="w"> </span><span class="n">exclude</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>

<span class="w">    </span><span class="nl">path_tags</span><span class="p">:</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">str, str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frozendict</span><span class="p">()</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Graph</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="k">off</span><span class="w"> </span><span class="n">sealed</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">opened</span><span class="w"> </span><span class="k">within</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">`</span><span class="k">with</span><span class="w"> </span><span class="n">Graph</span><span class="p">(...)</span><span class="err">`</span><span class="w"> </span><span class="n">context</span>

<span class="w">    </span><span class="nl">_status</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">bool</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PrivateAttr</span><span class="p">(</span><span class="k">None</span><span class="p">)</span>

<span class="w">    </span><span class="nl">_artifact_to_key</span><span class="p">:</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">Artifact, str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PrivateAttr</span><span class="p">(</span><span class="n">frozendict</span><span class="p">())</span>

<span class="w">    </span><span class="nv">@validator</span><span class="p">(</span><span class="ss">&quot;artifacts&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_convert_artifacts</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">artifacts</span><span class="p">:</span><span class="w"> </span><span class="n">ArtifactBox</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">ArtifactBox</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ArtifactBox</span><span class="p">(</span><span class="n">artifacts</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">BOX_KWARGS</span><span class="o">[</span><span class="n">SEALED</span><span class="o">]</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__enter__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Graph</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">arti</span><span class="p">.</span><span class="n">context</span><span class="p">.</span><span class="n">graph</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Another graph is being defined: {arti.context.graph}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">arti</span><span class="p">.</span><span class="n">context</span><span class="p">.</span><span class="n">graph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_toggle</span><span class="p">(</span><span class="k">OPEN</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__exit__</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">exc_type</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">type[BaseException</span><span class="o">]</span><span class="err">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">exc_value</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">BaseException</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">exc_traceback</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">TracebackType</span><span class="o">]</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">arti</span><span class="p">.</span><span class="n">context</span><span class="p">.</span><span class="n">graph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_toggle</span><span class="p">(</span><span class="n">SEALED</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Confirm</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">dependencies</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">acyclic</span>

<span class="w">        </span><span class="n">TopologicalSorter</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">dependencies</span><span class="p">).</span><span class="k">prepare</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_toggle</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">status</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Graph</span><span class="w"> </span><span class="k">object</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ss">&quot;frozen&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">bypass</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">assignment</span><span class="w"> </span><span class="n">checks</span><span class="p">.</span>

<span class="w">        </span><span class="k">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;artifacts&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ArtifactBox</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">artifacts</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">BOX_KWARGS</span><span class="o">[</span><span class="n">status</span><span class="o">]</span><span class="p">))</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_artifact_to_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span>

<span class="w">            </span><span class="err">{</span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">artifacts</span><span class="p">.</span><span class="n">walk</span><span class="p">()</span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">artifact_to_key</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">Artifact, str</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_artifact_to_key</span>

<span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">executor</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Executor</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">snapshot</span><span class="p">().</span><span class="n">build</span><span class="p">(</span><span class="n">executor</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">snapshot</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Identify a &quot;</span><span class="k">unique</span><span class="ss">&quot; ID for this Graph at this point in time.</span>

<span class="ss">        The ID aims to encode the structure of the Graph plus a _snapshot_ of the raw Artifact data</span>

<span class="ss">        (partition kinds and contents). Any change that would affect data should prompt an ID</span>

<span class="ss">        change, however changes to this ID don&#39;t directly cause data to be reproduced.</span>

<span class="ss">        NOTE: There is currently a gap (and thus race condition) between when the Graph ID is</span>

<span class="ss">        computed and when we read raw Artifacts data during Producer builds.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">.</span><span class="n">from_graph</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="o">=</span><span class="k">connection</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@cached_property</span>

<span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">dependencies</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">NodeDependencies</span><span class="p">:</span>

<span class="w">        </span><span class="n">artifact_deps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="p">(</span>

<span class="w">                </span><span class="n">frozenset</span><span class="p">(</span><span class="err">{</span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="p">.</span><span class="n">producer</span><span class="err">}</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span>

<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="n">frozenset</span><span class="p">()</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">artifacts</span><span class="p">.</span><span class="n">walk</span><span class="p">()</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="n">producer_deps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">multi</span><span class="o">-</span><span class="k">output</span><span class="w"> </span><span class="n">Producers</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">appear</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="p">(</span><span class="n">but</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">deduped</span><span class="p">)</span>

<span class="w">            </span><span class="n">producer_output</span><span class="p">.</span><span class="nl">producer</span><span class="p">:</span><span class="w"> </span><span class="n">frozenset</span><span class="p">(</span><span class="n">producer_output</span><span class="p">.</span><span class="n">producer</span><span class="p">.</span><span class="n">inputs</span><span class="p">.</span><span class="k">values</span><span class="p">())</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">artifact_deps</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">producer_output</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">NodeDependencies</span><span class="p">(</span><span class="n">artifact_deps</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">producer_deps</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@cached_property</span>

<span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">producers</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">frozenset</span><span class="o">[</span><span class="n">Producer</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">frozenset</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">producer_outputs</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@cached_property</span>

<span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">producer_outputs</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">Producer, tuple[Artifact, ...</span><span class="o">]</span><span class="err">]:</span>

<span class="w">        </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">defaultdict</span><span class="o">[</span><span class="n">Producer, dict[int, Artifact</span><span class="o">]</span><span class="err">]</span><span class="p">(</span><span class="n">dict</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">artifacts</span><span class="p">.</span><span class="n">walk</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="k">continue</span>

<span class="w">            </span><span class="k">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span>

<span class="w">            </span><span class="n">d</span><span class="o">[</span><span class="n">output.producer</span><span class="o">][</span><span class="n">output.position</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">artifact</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span>

<span class="w">            </span><span class="p">(</span><span class="n">producer</span><span class="p">,</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="n">artifacts_by_position</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sorted</span><span class="p">(</span><span class="n">artifacts_by_position</span><span class="p">)))</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">producer</span><span class="p">,</span><span class="w"> </span><span class="n">artifacts_by_position</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="k">read</span><span class="o">/</span><span class="k">write</span><span class="w"> </span><span class="n">probably</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">bit</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">sanity</span><span class="w"> </span><span class="n">checking</span><span class="w"> </span><span class="p">(</span><span class="n">probably</span><span class="w"> </span><span class="n">somewhere</span><span class="w"> </span><span class="k">else</span><span class="p">),</span><span class="w"> </span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="n">type</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="o">~=</span><span class="w"> </span><span class="k">view</span><span class="p">.</span><span class="w"> </span><span class="n">Doing</span><span class="w"> </span><span class="n">validation</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">data</span><span class="p">,</span><span class="w"> </span><span class="n">etc</span><span class="p">.</span><span class="w"> </span><span class="n">Should</span><span class="w"> </span><span class="ow">some</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">View</span><span class="vm">?</span>

<span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">read</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">annotation</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Any</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">storage_partitions</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Sequence[StoragePartition</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">view</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">View</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">GraphSnapshot</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span>

<span class="w">        </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">artifact_to_key</span><span class="o">[</span><span class="n">artifact</span><span class="o">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Either `annotation` or `view` must be passed&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Only one of `annotation` or `view` may be passed&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">get_class_for</span><span class="p">(</span><span class="n">annotation</span><span class="p">)(</span>

<span class="w">                </span><span class="n">artifact_class</span><span class="o">=</span><span class="n">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="n">artifact</span><span class="p">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="ss">&quot;READ&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="k">view</span><span class="p">.</span><span class="n">check_annotation_compatibility</span><span class="p">(</span><span class="n">annotation</span><span class="p">)</span>

<span class="w">            </span><span class="k">view</span><span class="p">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>

<span class="w">        </span><span class="n">assert</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">mypy</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">mixed</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">^</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">storage_partitions</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">reading</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">Artifacts</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">Artifacts</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="p">(</span><span class="n">which</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">prevents</span><span class="w"> </span><span class="n">snapshotting</span><span class="p">).</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">We</span><span class="s1">&#39;re not using read_artifact_partitions as the underlying data may have</span>

<span class="s1">                # changed. The backend may have pointers to old versions (which is expected), but we</span>

<span class="s1">                # only want to return the current values.</span>

<span class="s1">                storage_partitions = artifact.storage.discover_partitions()</span>

<span class="s1">            else:</span>

<span class="s1">                snapshot = snapshot or self.snapshot()</span>

<span class="s1">                with (connection or self.backend).connect() as conn:</span>

<span class="s1">                    storage_partitions = conn.read_snapshot_partitions(snapshot, key, artifact)</span>

<span class="s1">        return io.read(</span>

<span class="s1">            type_=artifact.type,</span>

<span class="s1">            format=artifact.format,</span>

<span class="s1">            storage_partitions=storage_partitions,</span>

<span class="s1">            view=view,</span>

<span class="s1">        )</span>

<span class="s1">    @requires_sealed</span>

<span class="s1">    def write(</span>

<span class="s1">        self,</span>

<span class="s1">        data: Any,</span>

<span class="s1">        *,</span>

<span class="s1">        artifact: Artifact,</span>

<span class="s1">        input_fingerprint: Fingerprint = Fingerprint.empty(),</span>

<span class="s1">        keys: CompositeKey = CompositeKey(),</span>

<span class="s1">        view: Optional[View] = None,</span>

<span class="s1">        snapshot: Optional[GraphSnapshot] = None,</span>

<span class="s1">        connection: Optional[Connection] = None,</span>

<span class="s1">    ) -&gt; StoragePartition:</span>

<span class="s1">        key = self.artifact_to_key[artifact]</span>

<span class="s1">        if snapshot is not None and artifact.producer_output is None:</span>

<span class="s1">            raise ValueError(</span>

<span class="s1">                f&quot;Writing to a raw Artifact (`{key}`) with a GraphSnapshot is not supported.&quot;</span>

<span class="s1">            )</span>

<span class="s1">        if view is None:</span>

<span class="s1">            view = View.get_class_for(type(data))(</span>

<span class="s1">                artifact_class=type(artifact), type=artifact.type, mode=&quot;WRITE&quot;</span>

<span class="s1">            )</span>

<span class="s1">        view.check_annotation_compatibility(type(data))</span>

<span class="s1">        view.check_artifact_compatibility(artifact)</span>

<span class="s1">        storage_partition = artifact.storage.generate_partition(</span>

<span class="s1">            input_fingerprint=input_fingerprint, keys=keys, with_content_fingerprint=False</span>

<span class="s1">        )</span>

<span class="s1">        storage_partition = io.write(</span>

<span class="s1">            data,</span>

<span class="s1">            type_=artifact.type,</span>

<span class="s1">            format=artifact.format,</span>

<span class="s1">            storage_partition=storage_partition,</span>

<span class="s1">            view=view,</span>

<span class="s1">        ).with_content_fingerprint()</span>

<span class="s1">        # TODO: Should we only do this in bulk? We might want the backends to transparently batch</span>

<span class="s1">        # requests, but that&#39;</span><span class="n">s</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">friendly</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">transient</span><span class="w"> </span><span class="ss">&quot;.connect&quot;</span><span class="p">.</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="k">connection</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">backend</span><span class="p">).</span><span class="k">connect</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">conn</span><span class="p">:</span>

<span class="w">            </span><span class="n">conn</span><span class="p">.</span><span class="n">write_artifact_partitions</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">storage_partition</span><span class="p">,))</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">Skip</span><span class="w"> </span><span class="n">linking</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">affects</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">Artifacts</span><span class="w"> </span><span class="p">(</span><span class="n">which</span><span class="w"> </span><span class="n">would</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">trigger</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">change</span><span class="p">).</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="n">conn</span><span class="p">.</span><span class="n">write_snapshot_partitions</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">storage_partition</span><span class="p">,))</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">storage_partition</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_6">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables_6">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_6">Static methods</h4>
<h4 id="construct_6">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_6">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_6">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_6">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_6">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_6">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_6">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_6">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_6">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_6">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">artifact_to_key</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_7">Methods</h4>
<h4 id="build_1">build</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">executor</span><span class="p">:</span> <span class="s1">&#39;Optional[Executor]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;GraphSnapshot&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">executor</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Executor</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">snapshot</span><span class="p">().</span><span class="n">build</span><span class="p">(</span><span class="n">executor</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="copy_6">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dependencies">dependencies</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dependencies</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="dict_6">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_6">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h4 id="producer_outputs">producer_outputs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">producer_outputs</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="producers">producers</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">producers</span><span class="p">(</span>
    <span class="o">...</span>
<span class="p">)</span>
</code></pre></div>

<h4 id="read_1">read</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">read</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="s1">&#39;Optional[Any]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">storage_partitions</span><span class="p">:</span> <span class="s1">&#39;Optional[Sequence[StoragePartition]]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">view</span><span class="p">:</span> <span class="s1">&#39;Optional[View]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;Optional[GraphSnapshot]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Optional[Connection]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">read</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">annotation</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Any</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">storage_partitions</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Sequence[StoragePartition</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">view</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">View</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">GraphSnapshot</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span>

<span class="w">        </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">artifact_to_key</span><span class="o">[</span><span class="n">artifact</span><span class="o">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Either `annotation` or `view` must be passed&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Only one of `annotation` or `view` may be passed&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">get_class_for</span><span class="p">(</span><span class="n">annotation</span><span class="p">)(</span>

<span class="w">                </span><span class="n">artifact_class</span><span class="o">=</span><span class="n">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="n">artifact</span><span class="p">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="ss">&quot;READ&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="k">view</span><span class="p">.</span><span class="n">check_annotation_compatibility</span><span class="p">(</span><span class="n">annotation</span><span class="p">)</span>

<span class="w">            </span><span class="k">view</span><span class="p">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>

<span class="w">        </span><span class="n">assert</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">mypy</span><span class="w"> </span><span class="n">gets</span><span class="w"> </span><span class="n">mixed</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">^</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">storage_partitions</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">reading</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">Artifacts</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">Artifacts</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="p">(</span><span class="n">which</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">prevents</span><span class="w"> </span><span class="n">snapshotting</span><span class="p">).</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">We</span><span class="err">&#39;</span><span class="n">re</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">read_artifact_partitions</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">underlying</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="n">changed</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">backend</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">pointers</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">old</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="p">(</span><span class="n">which</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">expected</span><span class="p">),</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">we</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="k">values</span><span class="p">.</span>

<span class="w">                </span><span class="n">storage_partitions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">discover_partitions</span><span class="p">()</span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span>

<span class="w">                </span><span class="n">snapshot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">snapshot</span><span class="p">()</span>

<span class="w">                </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="k">connection</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">backend</span><span class="p">).</span><span class="k">connect</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">conn</span><span class="p">:</span>

<span class="w">                    </span><span class="n">storage_partitions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conn</span><span class="p">.</span><span class="n">read_snapshot_partitions</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="k">read</span><span class="p">(</span>

<span class="w">            </span><span class="n">type_</span><span class="o">=</span><span class="n">artifact</span><span class="p">.</span><span class="n">type</span><span class="p">,</span>

<span class="w">            </span><span class="nf">format</span><span class="o">=</span><span class="n">artifact</span><span class="p">.</span><span class="nf">format</span><span class="p">,</span>

<span class="w">            </span><span class="n">storage_partitions</span><span class="o">=</span><span class="n">storage_partitions</span><span class="p">,</span>

<span class="w">            </span><span class="k">view</span><span class="o">=</span><span class="k">view</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="snapshot">snapshot</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">snapshot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Optional[Connection]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;GraphSnapshot&#39;</span>
</code></pre></div>

<p>Identify a "unique" ID for this Graph at this point in time.</p>
<p>The ID aims to encode the structure of the Graph plus a <em>snapshot</em> of the raw Artifact data
(partition kinds and contents). Any change that would affect data should prompt an ID
change, however changes to this ID don't directly cause data to be reproduced.</p>
<p>NOTE: There is currently a gap (and thus race condition) between when the Graph ID is
computed and when we read raw Artifacts data during Producer builds.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">snapshot</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Identify a &quot;</span><span class="k">unique</span><span class="ss">&quot; ID for this Graph at this point in time.</span>

<span class="ss">        The ID aims to encode the structure of the Graph plus a _snapshot_ of the raw Artifact data</span>

<span class="ss">        (partition kinds and contents). Any change that would affect data should prompt an ID</span>

<span class="ss">        change, however changes to this ID don&#39;t directly cause data to be reproduced.</span>

<span class="ss">        NOTE: There is currently a gap (and thus race condition) between when the Graph ID is</span>

<span class="ss">        computed and when we read raw Artifacts data during Producer builds.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">.</span><span class="n">from_graph</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="o">=</span><span class="k">connection</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="write_1">write</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">,</span>
    <span class="n">input_fingerprint</span><span class="p">:</span> <span class="s1">&#39;Fingerprint&#39;</span> <span class="o">=</span> <span class="n">Fingerprint</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">keys</span><span class="p">:</span> <span class="s1">&#39;CompositeKey&#39;</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">view</span><span class="p">:</span> <span class="s1">&#39;Optional[View]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s1">&#39;Optional[GraphSnapshot]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Optional[Connection]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;StoragePartition&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@requires_sealed</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">write</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="k">data</span><span class="err">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="nl">input_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">.</span><span class="n">empty</span><span class="p">(),</span>

<span class="w">        </span><span class="nl">keys</span><span class="p">:</span><span class="w"> </span><span class="n">CompositeKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CompositeKey</span><span class="p">(),</span>

<span class="w">        </span><span class="k">view</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">View</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">snapshot</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">GraphSnapshot</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">StoragePartition</span><span class="p">:</span>

<span class="w">        </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">artifact_to_key</span><span class="o">[</span><span class="n">artifact</span><span class="o">]</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;Writing to a raw Artifact (`{key}`) with a GraphSnapshot is not supported.&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">View</span><span class="p">.</span><span class="n">get_class_for</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="k">data</span><span class="p">))(</span>

<span class="w">                </span><span class="n">artifact_class</span><span class="o">=</span><span class="n">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="n">artifact</span><span class="p">.</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="ss">&quot;WRITE&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">view</span><span class="p">.</span><span class="n">check_annotation_compatibility</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="k">data</span><span class="p">))</span>

<span class="w">        </span><span class="k">view</span><span class="p">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>

<span class="w">        </span><span class="n">storage_partition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">generate_partition</span><span class="p">(</span>

<span class="w">            </span><span class="n">input_fingerprint</span><span class="o">=</span><span class="n">input_fingerprint</span><span class="p">,</span><span class="w"> </span><span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="n">with_content_fingerprint</span><span class="o">=</span><span class="k">False</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">storage_partition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io</span><span class="p">.</span><span class="k">write</span><span class="p">(</span>

<span class="w">            </span><span class="k">data</span><span class="p">,</span>

<span class="w">            </span><span class="n">type_</span><span class="o">=</span><span class="n">artifact</span><span class="p">.</span><span class="n">type</span><span class="p">,</span>

<span class="w">            </span><span class="nf">format</span><span class="o">=</span><span class="n">artifact</span><span class="p">.</span><span class="nf">format</span><span class="p">,</span>

<span class="w">            </span><span class="n">storage_partition</span><span class="o">=</span><span class="n">storage_partition</span><span class="p">,</span>

<span class="w">            </span><span class="k">view</span><span class="o">=</span><span class="k">view</span><span class="p">,</span>

<span class="w">        </span><span class="p">).</span><span class="n">with_content_fingerprint</span><span class="p">()</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Should</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">bulk</span><span class="vm">?</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">backends</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">transparently</span><span class="w"> </span><span class="n">batch</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">requests</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">that</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">friendly</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">transient</span><span class="w"> </span><span class="ss">&quot;.connect&quot;</span><span class="p">.</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="k">connection</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">backend</span><span class="p">).</span><span class="k">connect</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">conn</span><span class="p">:</span>

<span class="w">            </span><span class="n">conn</span><span class="p">.</span><span class="n">write_artifact_partitions</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">storage_partition</span><span class="p">,))</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">Skip</span><span class="w"> </span><span class="n">linking</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">affects</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="n">Artifacts</span><span class="w"> </span><span class="p">(</span><span class="n">which</span><span class="w"> </span><span class="n">would</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">trigger</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">change</span><span class="p">).</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">snapshot</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="n">conn</span><span class="p">.</span><span class="n">write_snapshot_partitions</span><span class="p">(</span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">storage_partition</span><span class="p">,))</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">storage_partition</span>
</code></pre></div>

</details>
<h3 id="graphsnapshot">GraphSnapshot</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">GraphSnapshot</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">GraphSnapshot</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;GraphSnapshot represents the state of a Graph and the referenced raw data at a point in time.</span>

<span class="ss">    GraphSnapshot encodes the structure of the Graph plus a snapshot of the raw Artifact data</span>

<span class="ss">    (partition kinds and contents) at a point in time. Any change that would affect data should</span>

<span class="ss">    prompt an ID change.</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="nl">id</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span>

<span class="w">    </span><span class="nl">graph</span><span class="p">:</span><span class="w"> </span><span class="n">Graph</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">artifacts</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">ArtifactBox</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">artifacts</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">backend</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Backend</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">backend</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">name</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="n">name</span>

<span class="w">    </span><span class="nv">@classmethod</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Should</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">(</span><span class="n">TTL</span><span class="p">)</span><span class="w"> </span><span class="n">cache</span><span class="vm">?</span><span class="w"> </span><span class="n">Raw</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="p">(</span><span class="n">especially</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tests</span><span class="p">)</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">detected</span><span class="p">.</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_graph</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">graph</span><span class="p">:</span><span class="w"> </span><span class="n">Graph</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Snapshot the Graph and all existing raw data.</span>

<span class="ss">        NOTE: There is currently a gap (and thus race condition) between when the Graph ID is</span>

<span class="ss">        computed and when we read raw Artifact data during Producer builds.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Resolve</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">statically</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">fingerprints</span><span class="p">.</span><span class="w"> </span><span class="n">Specifically</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">pin</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Producer</span><span class="p">.</span><span class="n">fingerprint</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">dynamic</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Timestamp</span><span class="p">).</span><span class="w"> </span><span class="n">Unbuilt</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Artifact</span><span class="w"> </span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span><span class="w"> </span><span class="n">won</span><span class="s1">&#39;t be fully resolved yet.</span>

<span class="s1">        snapshot_id, known_artifact_partitions = graph.fingerprint, dict[str, StoragePartitions]()</span>

<span class="s1">        for node, _ in graph.dependencies.items():</span>

<span class="s1">            snapshot_id = snapshot_id.combine(node.fingerprint)</span>

<span class="s1">            if isinstance(node, Artifact):</span>

<span class="s1">                key = graph.artifact_to_key[node]</span>

<span class="s1">                snapshot_id = snapshot_id.combine(Fingerprint.from_string(key))</span>

<span class="s1">                # Include fingerprints (including content_fingerprint!) for all raw Artifact</span>

<span class="s1">                # partitions, triggering a graph ID change if these artifacts change out-of-band.</span>

<span class="s1">                #</span>

<span class="s1">                # TODO: Should we *also* inspect Producer.inputs for Artifacts _not_ inside this</span>

<span class="s1">                # Graph and inspect their contents too? I guess we&#39;</span><span class="n">ll</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">things</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">bit</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="n">differently</span><span class="w"> </span><span class="n">depending</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">external</span><span class="w"> </span><span class="n">Artifacts</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">Produced</span><span class="w"> </span><span class="p">(</span><span class="ow">in</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">upstream</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="n">Graph</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="p">.</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                    </span><span class="n">known_artifact_partitions</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">(</span>

<span class="w">                        </span><span class="k">partition</span><span class="p">.</span><span class="n">with_content_fingerprint</span><span class="p">()</span>

<span class="w">                        </span><span class="k">for</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">discover_partitions</span><span class="p">()</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">known_artifact_partitions</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="err">:</span>

<span class="w">                        </span><span class="n">content_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;partitions&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_partitioned</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="ss">&quot;data&quot;</span>

<span class="w">                        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;No {content_str} found for `{key}`: {node}&quot;</span><span class="p">)</span>

<span class="w">                    </span><span class="n">snapshot_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snapshot_id</span><span class="p">.</span><span class="n">combine</span><span class="p">(</span>

<span class="w">                        </span><span class="o">*[</span><span class="n">partition.fingerprint for partition in known_artifact_partitions[key</span><span class="o">]</span><span class="err">]</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">snapshot_id</span><span class="p">.</span><span class="n">is_empty</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">snapshot_id</span><span class="p">.</span><span class="nl">is_identity</span><span class="p">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">pragma</span><span class="p">:</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">cover</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">shouldn</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">happen</span><span class="w"> </span><span class="n">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">faulty</span><span class="p">.</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Fingerprint is empty!&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">snapshot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cls</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">snapshot_id</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">discovered</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">known</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="k">connection</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">backend</span><span class="p">).</span><span class="k">connect</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">conn</span><span class="p">:</span>

<span class="w">            </span><span class="n">conn</span><span class="p">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

<span class="w">            </span><span class="n">conn</span><span class="p">.</span><span class="n">write_snapshot</span><span class="p">(</span><span class="n">snapshot</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">known_artifact_partitions</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                </span><span class="n">conn</span><span class="p">.</span><span class="n">write_artifact_and_graph_partitions</span><span class="p">(</span>

<span class="w">                    </span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">artifacts</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">snapshot</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">build</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">executor</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Executor</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">executor</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="k">from</span><span class="w"> </span><span class="n">arti</span><span class="p">.</span><span class="n">executors</span><span class="p">.</span><span class="k">local</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">LocalExecutor</span>

<span class="w">            </span><span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalExecutor</span><span class="p">()</span>

<span class="w">        </span><span class="n">executor</span><span class="p">.</span><span class="n">build</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">tag</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">tag</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">overwrite</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="k">connection</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">backend</span><span class="p">).</span><span class="k">connect</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">conn</span><span class="p">:</span>

<span class="w">            </span><span class="n">conn</span><span class="p">.</span><span class="n">write_snapshot_tag</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">overwrite</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_tag</span><span class="p">(</span>

<span class="w">        </span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">tag</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">connectable</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Backend[Connection</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">Connection</span><span class="err">]</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="n">connectable</span><span class="p">.</span><span class="k">connect</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">conn</span><span class="p">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">conn</span><span class="p">.</span><span class="n">read_snapshot_tag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">read</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">annotation</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Any</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">storage_partitions</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Sequence[StoragePartition</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">view</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">View</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="k">read</span><span class="p">(</span>

<span class="w">            </span><span class="n">artifact</span><span class="p">,</span>

<span class="w">            </span><span class="n">annotation</span><span class="o">=</span><span class="n">annotation</span><span class="p">,</span>

<span class="w">            </span><span class="n">storage_partitions</span><span class="o">=</span><span class="n">storage_partitions</span><span class="p">,</span>

<span class="w">            </span><span class="k">view</span><span class="o">=</span><span class="k">view</span><span class="p">,</span>

<span class="w">            </span><span class="n">snapshot</span><span class="o">=</span><span class="n">self</span><span class="p">,</span>

<span class="w">            </span><span class="k">connection</span><span class="o">=</span><span class="k">connection</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">write</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="k">data</span><span class="err">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="nl">input_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">.</span><span class="n">empty</span><span class="p">(),</span>

<span class="w">        </span><span class="nl">keys</span><span class="p">:</span><span class="w"> </span><span class="n">CompositeKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CompositeKey</span><span class="p">(),</span>

<span class="w">        </span><span class="k">view</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">View</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">StoragePartition</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="k">write</span><span class="p">(</span>

<span class="w">            </span><span class="k">data</span><span class="p">,</span>

<span class="w">            </span><span class="n">artifact</span><span class="o">=</span><span class="n">artifact</span><span class="p">,</span>

<span class="w">            </span><span class="n">input_fingerprint</span><span class="o">=</span><span class="n">input_fingerprint</span><span class="p">,</span>

<span class="w">            </span><span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span>

<span class="w">            </span><span class="k">view</span><span class="o">=</span><span class="k">view</span><span class="p">,</span>

<span class="w">            </span><span class="n">snapshot</span><span class="o">=</span><span class="n">self</span><span class="p">,</span>

<span class="w">            </span><span class="k">connection</span><span class="o">=</span><span class="k">connection</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_7">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables_7">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_7">Static methods</h4>
<h4 id="construct_7">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_graph">from_graph</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_graph</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">:</span> <span class="s1">&#39;Graph&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Optional[Connection]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;GraphSnapshot&#39;</span>
</code></pre></div>

<p>Snapshot the Graph and all existing raw data.</p>
<p>NOTE: There is currently a gap (and thus race condition) between when the Graph ID is
computed and when we read raw Artifact data during Producer builds.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Should</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">(</span><span class="n">TTL</span><span class="p">)</span><span class="w"> </span><span class="n">cache</span><span class="vm">?</span><span class="w"> </span><span class="n">Raw</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="p">(</span><span class="n">especially</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">tests</span><span class="p">)</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">detected</span><span class="p">.</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_graph</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">graph</span><span class="p">:</span><span class="w"> </span><span class="n">Graph</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Snapshot the Graph and all existing raw data.</span>

<span class="ss">        NOTE: There is currently a gap (and thus race condition) between when the Graph ID is</span>

<span class="ss">        computed and when we read raw Artifact data during Producer builds.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Resolve</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">statically</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">fingerprints</span><span class="p">.</span><span class="w"> </span><span class="n">Specifically</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">pin</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Producer</span><span class="p">.</span><span class="n">fingerprint</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">dynamic</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">Timestamp</span><span class="p">).</span><span class="w"> </span><span class="n">Unbuilt</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Artifact</span><span class="w"> </span><span class="p">(</span><span class="n">partitions</span><span class="p">)</span><span class="w"> </span><span class="n">won</span><span class="s1">&#39;t be fully resolved yet.</span>

<span class="s1">        snapshot_id, known_artifact_partitions = graph.fingerprint, dict[str, StoragePartitions]()</span>

<span class="s1">        for node, _ in graph.dependencies.items():</span>

<span class="s1">            snapshot_id = snapshot_id.combine(node.fingerprint)</span>

<span class="s1">            if isinstance(node, Artifact):</span>

<span class="s1">                key = graph.artifact_to_key[node]</span>

<span class="s1">                snapshot_id = snapshot_id.combine(Fingerprint.from_string(key))</span>

<span class="s1">                # Include fingerprints (including content_fingerprint!) for all raw Artifact</span>

<span class="s1">                # partitions, triggering a graph ID change if these artifacts change out-of-band.</span>

<span class="s1">                #</span>

<span class="s1">                # TODO: Should we *also* inspect Producer.inputs for Artifacts _not_ inside this</span>

<span class="s1">                # Graph and inspect their contents too? I guess we&#39;</span><span class="n">ll</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">things</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">bit</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="n">differently</span><span class="w"> </span><span class="n">depending</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">external</span><span class="w"> </span><span class="n">Artifacts</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">Produced</span><span class="w"> </span><span class="p">(</span><span class="ow">in</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">upstream</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="n">Graph</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="p">.</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                    </span><span class="n">known_artifact_partitions</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">(</span>

<span class="w">                        </span><span class="k">partition</span><span class="p">.</span><span class="n">with_content_fingerprint</span><span class="p">()</span>

<span class="w">                        </span><span class="k">for</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">node</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">discover_partitions</span><span class="p">()</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">known_artifact_partitions</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="err">:</span>

<span class="w">                        </span><span class="n">content_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;partitions&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_partitioned</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="ss">&quot;data&quot;</span>

<span class="w">                        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;No {content_str} found for `{key}`: {node}&quot;</span><span class="p">)</span>

<span class="w">                    </span><span class="n">snapshot_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snapshot_id</span><span class="p">.</span><span class="n">combine</span><span class="p">(</span>

<span class="w">                        </span><span class="o">*[</span><span class="n">partition.fingerprint for partition in known_artifact_partitions[key</span><span class="o">]</span><span class="err">]</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">snapshot_id</span><span class="p">.</span><span class="n">is_empty</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">snapshot_id</span><span class="p">.</span><span class="nl">is_identity</span><span class="p">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">pragma</span><span class="p">:</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">cover</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">shouldn</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">happen</span><span class="w"> </span><span class="n">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">faulty</span><span class="p">.</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Fingerprint is empty!&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">snapshot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cls</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="n">snapshot_id</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Write</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">discovered</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">known</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="k">connection</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">backend</span><span class="p">).</span><span class="k">connect</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">conn</span><span class="p">:</span>

<span class="w">            </span><span class="n">conn</span><span class="p">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>

<span class="w">            </span><span class="n">conn</span><span class="p">.</span><span class="n">write_snapshot</span><span class="p">(</span><span class="n">snapshot</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">known_artifact_partitions</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                </span><span class="n">conn</span><span class="p">.</span><span class="n">write_artifact_and_graph_partitions</span><span class="p">(</span>

<span class="w">                    </span><span class="n">snapshot</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot</span><span class="p">.</span><span class="n">artifacts</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">snapshot</span>
</code></pre></div>

</details>
<h4 id="from_orm_7">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="from_tag">from_tag</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_tag</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">connectable</span><span class="p">:</span> <span class="s1">&#39;Union[Backend[Connection], Connection]&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;GraphSnapshot&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_tag</span><span class="p">(</span>

<span class="w">        </span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">tag</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">connectable</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Backend[Connection</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">Connection</span><span class="err">]</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">GraphSnapshot</span><span class="p">:</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="n">connectable</span><span class="p">.</span><span class="k">connect</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">conn</span><span class="p">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">conn</span><span class="p">.</span><span class="n">read_snapshot_tag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="parse_file_7">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_7">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_7">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_7">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_7">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_7">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_7">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_7">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">artifacts</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">backend</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">name</span>
</code></pre></div>

<h4 id="methods_8">Methods</h4>
<h4 id="build_2">build</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">executor</span><span class="p">:</span> <span class="s1">&#39;Optional[Executor]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;GraphSnapshot&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">executor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Executor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GraphSnapshot</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">executor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="kn">from</span> <span class="nn">arti.executors.local</span> <span class="kn">import</span> <span class="n">LocalExecutor</span>

            <span class="n">executor</span> <span class="o">=</span> <span class="n">LocalExecutor</span><span class="p">()</span>

        <span class="n">executor</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span>
</code></pre></div>

</details>
<h4 id="copy_7">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_7">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_7">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h4 id="read_2">read</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">read</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="s1">&#39;Optional[Any]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">storage_partitions</span><span class="p">:</span> <span class="s1">&#39;Optional[Sequence[StoragePartition]]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">view</span><span class="p">:</span> <span class="s1">&#39;Optional[View]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Optional[Connection]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">read</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">annotation</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Any</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">storage_partitions</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Sequence[StoragePartition</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">view</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">View</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="k">read</span><span class="p">(</span>

<span class="w">            </span><span class="n">artifact</span><span class="p">,</span>

<span class="w">            </span><span class="n">annotation</span><span class="o">=</span><span class="n">annotation</span><span class="p">,</span>

<span class="w">            </span><span class="n">storage_partitions</span><span class="o">=</span><span class="n">storage_partitions</span><span class="p">,</span>

<span class="w">            </span><span class="k">view</span><span class="o">=</span><span class="k">view</span><span class="p">,</span>

<span class="w">            </span><span class="n">snapshot</span><span class="o">=</span><span class="n">self</span><span class="p">,</span>

<span class="w">            </span><span class="k">connection</span><span class="o">=</span><span class="k">connection</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="tag">tag</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">tag</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">tag</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Optional[Connection]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">tag</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">tag</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">overwrite</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="p">(</span><span class="k">connection</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">backend</span><span class="p">).</span><span class="k">connect</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">conn</span><span class="p">:</span>

<span class="w">            </span><span class="n">conn</span><span class="p">.</span><span class="n">write_snapshot_tag</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">overwrite</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="write_2">write</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span><span class="p">,</span>
    <span class="n">input_fingerprint</span><span class="p">:</span> <span class="s1">&#39;Fingerprint&#39;</span> <span class="o">=</span> <span class="n">Fingerprint</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">keys</span><span class="p">:</span> <span class="s1">&#39;CompositeKey&#39;</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">view</span><span class="p">:</span> <span class="s1">&#39;Optional[View]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connection</span><span class="p">:</span> <span class="s1">&#39;Optional[Connection]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;StoragePartition&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">write</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="k">data</span><span class="err">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span>

<span class="w">        </span><span class="o">*</span><span class="p">,</span>

<span class="w">        </span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span>

<span class="w">        </span><span class="nl">input_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">.</span><span class="n">empty</span><span class="p">(),</span>

<span class="w">        </span><span class="nl">keys</span><span class="p">:</span><span class="w"> </span><span class="n">CompositeKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CompositeKey</span><span class="p">(),</span>

<span class="w">        </span><span class="k">view</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">View</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">connection</span><span class="err">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Connection</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">StoragePartition</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">graph</span><span class="p">.</span><span class="k">write</span><span class="p">(</span>

<span class="w">            </span><span class="k">data</span><span class="p">,</span>

<span class="w">            </span><span class="n">artifact</span><span class="o">=</span><span class="n">artifact</span><span class="p">,</span>

<span class="w">            </span><span class="n">input_fingerprint</span><span class="o">=</span><span class="n">input_fingerprint</span><span class="p">,</span>

<span class="w">            </span><span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span>

<span class="w">            </span><span class="k">view</span><span class="o">=</span><span class="k">view</span><span class="p">,</span>

<span class="w">            </span><span class="n">snapshot</span><span class="o">=</span><span class="n">self</span><span class="p">,</span>

<span class="w">            </span><span class="k">connection</span><span class="o">=</span><span class="k">connection</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="partitionkey">PartitionKey</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">PartitionKey</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">PartitionKey</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="n">_abstract_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">    </span><span class="nl">_by_type_</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">dict[type[Type</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">PartitionKey</span><span class="o">]</span><span class="err">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">    </span><span class="nl">default_key_components</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">frozendict[str, str</span><span class="o">]</span><span class="err">]</span>

<span class="w">    </span><span class="nl">matching_type</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">type[Type</span><span class="o">]</span><span class="err">]</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init_subclass__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="nl">kwargs</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">super</span><span class="p">().</span><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="nl">_abstract_</span><span class="p">:</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">attr</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;default_key_components&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;matching_type&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">hasattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;{cls.__name__} must set `{attr}`&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="k">unknown</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">default_key_components</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="nl">key_components</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;Unknown key_components in {cls.__name__}.default_key_components: {unknown}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">register</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_by_type_</span><span class="p">,</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">matching_type</span><span class="p">,</span><span class="w"> </span><span class="n">cls</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classproperty</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">key_components</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">frozenset</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">frozenset</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">__fields__</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">frozenset</span><span class="p">(</span>

<span class="w">            </span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">dir</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">getattr_static</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">),</span><span class="w"> </span><span class="n">key_component</span><span class="p">)</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="nv">@abc</span><span class="p">.</span><span class="n">abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_key_components</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="nl">key_components</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">PartitionKey</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Unable to parse &#39;{cls.__name__}&#39; from: {key_components}&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_class_for</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">PartitionKey</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_by_type_</span><span class="o">[</span><span class="n">type(type_)</span><span class="o">]</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">types_from</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">CompositeKeyTypes</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">Collection</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">frozendict</span><span class="p">()</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span>

<span class="w">            </span><span class="err">{</span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">get_class_for</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">type_</span><span class="p">.</span><span class="n">partition_fields</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_8">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="descendants_4">Descendants</h4>
<ul>
<li>arti.partitions.DateKey</li>
<li>arti.partitions._IntKey</li>
<li>arti.partitions.NullKey</li>
</ul>
<h4 id="class-variables_8">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">key_components</span>
</code></pre></div>

<h4 id="static-methods_8">Static methods</h4>
<h4 id="construct_8">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_key_components">from_key_components</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_key_components</span><span class="p">(</span>
    <span class="o">**</span><span class="n">key_components</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PartitionKey&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="nv">@abc</span><span class="p">.</span><span class="n">abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_key_components</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="nl">key_components</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">PartitionKey</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Unable to parse &#39;{cls.__name__}&#39; from: {key_components}&quot;</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="from_orm_8">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="get_class_for">get_class_for</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_class_for</span><span class="p">(</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Type&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;type[PartitionKey]&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_class_for</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">PartitionKey</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_by_type_</span><span class="o">[</span><span class="n">type(type_)</span><span class="o">]</span>
</code></pre></div>

</details>
<h4 id="parse_file_8">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_8">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_8">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_8">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_8">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="types_from">types_from</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">types_from</span><span class="p">(</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Type&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;CompositeKeyTypes&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">types_from</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">CompositeKeyTypes</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">Collection</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">frozendict</span><span class="p">()</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span>

<span class="w">            </span><span class="err">{</span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">get_class_for</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">type_</span><span class="p">.</span><span class="n">partition_fields</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="update_forward_refs_8">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_8">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_8">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_9">Methods</h4>
<h4 id="copy_8">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_8">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_8">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="producer_1">Producer</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Producer</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Producer</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;A Producer is a task that builds one or more Artifacts.&quot;&quot;&quot;</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="n">fields</span><span class="o">/</span><span class="n">methods</span>

<span class="w">    </span><span class="nl">annotations</span><span class="p">:</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">Annotation, ...</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span>

<span class="w">    </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="n">Version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SemVer</span><span class="p">(</span><span class="n">major</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">minor</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">patch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">map</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">validate_outputs</span><span class="w"> </span><span class="k">parameters</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">dynamic</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">subclasses</span><span class="p">,</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">however</span><span class="w"> </span><span class="n">mypy</span><span class="w"> </span><span class="n">doesn</span><span class="s1">&#39;t like the &quot;incompatible&quot; signature on subclasses if actually defined here</span>

<span class="s1">    # (nor support ParamSpec yet). `map` is generated during subclassing if not set, `build` is</span>

<span class="s1">    # required, and `validate_outputs` defaults to no-op checks (hence is the only one with a</span>

<span class="s1">    # provided method).</span>

<span class="s1">    #</span>

<span class="s1">    # These must be @classmethods or @staticmethods.</span>

<span class="s1">    map: ClassVar[MapSig]</span>

<span class="s1">    build: ClassVar[BuildSig]</span>

<span class="s1">    if TYPE_CHECKING:</span>

<span class="s1">        validate_outputs: ClassVar[ValidateSig]</span>

<span class="s1">    else:</span>

<span class="s1">        @staticmethod</span>

<span class="s1">        def validate_outputs(*outputs: Any) -&gt; Union[bool, tuple[bool, str]]:</span>

<span class="s1">            &quot;&quot;&quot;Validate the `Producer.build` outputs, returning the status and a message.</span>

<span class="s1">            The validation status is applied to all outputs. If validation does not pass, the</span>

<span class="s1">            outputs will not be written to storage to prevent checkpointing the output. In the</span>

<span class="s1">            future, we may still write the data to ease debugging, but track validation status in</span>

<span class="s1">            the Backend (preventing downstream use).</span>

<span class="s1">            The arguments must not be mutated.</span>

<span class="s1">            The parameters must be usable with positional argument. The output of `build` will be</span>

<span class="s1">            passed in as it was returned, for example: `def build(...): return 1, 2` will result in</span>

<span class="s1">            `validate_outputs(1, 2)`.</span>

<span class="s1">            NOTE: `validate_outputs` is a stopgap until Statistics and Thresholds are fully implemented.</span>

<span class="s1">            &quot;&quot;&quot;</span>

<span class="s1">            return True, &quot;No validation performed.&quot;</span>

<span class="s1">    # Internal fields/methods</span>

<span class="s1">    _abstract_: ClassVar[bool] = True</span>

<span class="s1">    _fingerprint_excludes_ = frozenset([&quot;annotations&quot;])</span>

<span class="s1">    # NOTE: The following are set in __init_subclass__</span>

<span class="s1">    _input_artifact_classes_: ClassVar[frozendict[str, type[Artifact]]]</span>

<span class="s1">    _build_inputs_: ClassVar[BuildInputs]</span>

<span class="s1">    _build_sig_: ClassVar[Signature]</span>

<span class="s1">    _map_inputs_: ClassVar[MapInputs]</span>

<span class="s1">    _map_sig_: ClassVar[Signature]</span>

<span class="s1">    _outputs_: ClassVar[Outputs]</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def __init_subclass__(cls, **kwargs: Any) -&gt; None:</span>

<span class="s1">        super().__init_subclass__(**kwargs)</span>

<span class="s1">        if not cls._abstract_:</span>

<span class="s1">            with wrap_exc(ValueError, prefix=cls.__name__):</span>

<span class="s1">                cls._input_artifact_classes_ = cls._validate_fields()</span>

<span class="s1">                with wrap_exc(ValueError, prefix=&quot;.build&quot;):</span>

<span class="s1">                    (</span>

<span class="s1">                        cls._build_sig_,</span>

<span class="s1">                        cls._build_inputs_,</span>

<span class="s1">                        cls._outputs_,</span>

<span class="s1">                    ) = cls._validate_build_sig()</span>

<span class="s1">                with wrap_exc(ValueError, prefix=&quot;.validate_output&quot;):</span>

<span class="s1">                    cls._validate_validate_output_sig()</span>

<span class="s1">                with wrap_exc(ValueError, prefix=&quot;.map&quot;):</span>

<span class="s1">                    cls._map_sig_, cls._map_inputs_ = cls._validate_map_sig()</span>

<span class="s1">                cls._validate_no_unused_fields()</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_fields(cls) -&gt; frozendict[str, type[Artifact]]:</span>

<span class="s1">        # NOTE: Aside from the base producer fields, all others should (currently) be Artifacts.</span>

<span class="s1">        #</span>

<span class="s1">        # Users can set additional class attributes, but they must be properly hinted as ClassVars.</span>

<span class="s1">        # These won&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">interact</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">&quot;framework&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">can</span><span class="s1">&#39;t be parameters to build/map.</span>

<span class="s1">        artifact_fields = {k: v for k, v in cls.__fields__.items() if k not in Producer.__fields__}</span>

<span class="s1">        for name, field in artifact_fields.items():</span>

<span class="s1">            with wrap_exc(ValueError, prefix=f&quot;.{name}&quot;):</span>

<span class="s1">                if not (field.default is None and field.default_factory is None and field.required):</span>

<span class="s1">                    raise ValueError(&quot;field must not have a default nor be Optional.&quot;)</span>

<span class="s1">                if not lenient_issubclass(field.outer_type_, Artifact):</span>

<span class="s1">                    raise ValueError(</span>

<span class="s1">                        f&quot;type hint must be an Artifact subclass, got: {field.outer_type_}&quot;</span>

<span class="s1">                    )</span>

<span class="s1">        return frozendict({name: field.outer_type_ for name, field in artifact_fields.items()})</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_parameters(</span>

<span class="s1">        cls, sig: Signature, *, validator: Callable[[str, Parameter], _T]</span>

<span class="s1">    ) -&gt; Iterator[_T]:</span>

<span class="s1">        if undefined_params := set(sig.parameters) - set(cls._input_artifact_classes_):</span>

<span class="s1">            raise ValueError(</span>

<span class="s1">                f&quot;the following parameter(s) must be defined as a field: {undefined_params}&quot;</span>

<span class="s1">            )</span>

<span class="s1">        for name, param in sig.parameters.items():</span>

<span class="s1">            with wrap_exc(ValueError, prefix=f&quot; {name} param&quot;):</span>

<span class="s1">                if param.annotation is param.empty:</span>

<span class="s1">                    raise ValueError(&quot;must have a type hint.&quot;)</span>

<span class="s1">                if param.default is not param.empty:</span>

<span class="s1">                    raise ValueError(&quot;must not have a default.&quot;)</span>

<span class="s1">                if param.kind not in (param.POSITIONAL_OR_KEYWORD, param.KEYWORD_ONLY):</span>

<span class="s1">                    raise ValueError(&quot;must be usable as a keyword argument.&quot;)</span>

<span class="s1">                yield validator(name, param)</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_build_param(cls, name: str, param: Parameter) -&gt; tuple[str, View]:</span>

<span class="s1">        annotation = param.annotation</span>

<span class="s1">        field_artifact_class = cls._input_artifact_classes_[param.name]</span>

<span class="s1">        # If there is no Artifact hint, add in the field value as the default.</span>

<span class="s1">        if get_item_from_annotated(annotation, Artifact, is_subclass=True) is None:</span>

<span class="s1">            annotation = Annotated[annotation, field_artifact_class]</span>

<span class="s1">        view = View.from_annotation(annotation, mode=&quot;READ&quot;)</span>

<span class="s1">        if view.artifact_class != field_artifact_class:</span>

<span class="s1">            raise ValueError(</span>

<span class="s1">                f&quot;annotation Artifact class ({view.artifact_class}) does not match that set on the field ({field_artifact_class}).&quot;</span>

<span class="s1">            )</span>

<span class="s1">        return name, view</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_build_sig_return(cls, annotation: Any, *, i: int) -&gt; View:</span>

<span class="s1">        with wrap_exc(ValueError, prefix=f&quot; {ordinal(i+1)} return&quot;):</span>

<span class="s1">            return View.from_annotation(annotation, mode=&quot;WRITE&quot;)</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_build_sig(cls) -&gt; tuple[Signature, BuildInputs, Outputs]:</span>

<span class="s1">        &quot;&quot;&quot;Validate the .build method&quot;&quot;&quot;</span>

<span class="s1">        if not hasattr(cls, &quot;build&quot;):</span>

<span class="s1">            raise ValueError(&quot;must be implemented&quot;)</span>

<span class="s1">        if not isinstance(getattr_static(cls, &quot;build&quot;), (classmethod, staticmethod)):</span>

<span class="s1">            raise ValueError(&quot;must be a @classmethod or @staticmethod&quot;)</span>

<span class="s1">        build_sig = signature(cls.build, force_tuple_return=True, remove_owner=True)</span>

<span class="s1">        # Validate the parameters</span>

<span class="s1">        build_inputs = BuildInputs(</span>

<span class="s1">            cls._validate_parameters(build_sig, validator=cls._validate_build_param)</span>

<span class="s1">        )</span>

<span class="s1">        # Validate the return definition</span>

<span class="s1">        return_annotation = build_sig.return_annotation</span>

<span class="s1">        if return_annotation is build_sig.empty:</span>

<span class="s1">            # TODO: &quot;side effect&quot; Producers: https://github.com/artigraph/artigraph/issues/11</span>

<span class="s1">            raise ValueError(&quot;a return value must be set with the output Artifact(s).&quot;)</span>

<span class="s1">        if return_annotation == (NoneType,):</span>

<span class="s1">            raise ValueError(&quot;missing return signature&quot;)</span>

<span class="s1">        outputs = Outputs(</span>

<span class="s1">            cls._validate_build_sig_return(annotation, i=i)</span>

<span class="s1">            for i, annotation in enumerate(return_annotation)</span>

<span class="s1">        )</span>

<span class="s1">        # Validate all outputs have equivalent partitioning schemes.</span>

<span class="s1">        #</span>

<span class="s1">        # We currently require the partition key type *and* name to match, but in the future we</span>

<span class="s1">        # might be able to extend the dependency metadata to support heterogeneous names if</span>

<span class="s1">        # necessary.</span>

<span class="s1">        seen_key_types = {PartitionKey.types_from(view.type) for view in outputs}</span>

<span class="s1">        if len(seen_key_types) != 1:</span>

<span class="s1">            raise ValueError(&quot;all outputs must have the same partitioning scheme&quot;)</span>

<span class="s1">        return build_sig, build_inputs, outputs</span>

<span class="s1">    @classmethod</span>

<span class="s1">    def _validate_validate_output_sig(cls) -&gt; None:</span>

<span class="s1">        build_output_hints = [</span>

<span class="s1">            get_args(hint)[0] if get_origin(hint) is Annotated else hint</span>

<span class="s1">            for hint in cls._build_sig_.return_annotation</span>

<span class="s1">        ]</span>

<span class="s1">        match_build_str = f&quot;match the `.build` return (`{build_output_hints}`)&quot;</span>

<span class="s1">        validate_parameters = signature(cls.validate_outputs).parameters</span>

<span class="s1">        def param_matches(param: Parameter, build_return: type) -&gt; bool:</span>

<span class="s1">            # Skip checking non-hinted parameters to allow lambdas.</span>

<span class="s1">            #</span>

<span class="s1">            # NOTE: Parameter type hints are *contravariant* (you can&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="ss">&quot;Manager&quot;</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">a</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">expecting</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="ss">&quot;Employee&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">hence</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">build_return</span><span class="w"> </span><span class="k">as</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">subtype</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">supertype</span><span class="p">.</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">empty</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="p">(</span>

<span class="w">                </span><span class="n">build_return</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Allow</span><span class="w"> </span><span class="err">`</span><span class="o">*</span><span class="nl">args</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="err">`</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">`</span><span class="o">*</span><span class="nl">args</span><span class="p">:</span><span class="w"> </span><span class="n">T</span><span class="err">`</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="err">`</span><span class="n">build</span><span class="p">(...)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">T, ...</span><span class="o">]</span><span class="err">`</span>

<span class="w">            </span><span class="nf">len</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span>

<span class="w">            </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">param</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">.</span><span class="k">values</span><span class="p">())</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">).</span><span class="n">kind</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">VAR_POSITIONAL</span>

<span class="w">        </span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">all</span><span class="p">(</span><span class="n">param_matches</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="w"> </span><span class="n">output_hint</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">output_hint</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">build_output_hints</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot; {param.name} param&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;type hint must be `Any` or {match_build_str}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Otherwise</span><span class="p">,</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">pairwise</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">build_output_hints</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;must {match_build_str}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">validate_parameters</span><span class="p">.</span><span class="n">items</span><span class="p">())</span><span class="err">:</span>

<span class="w">                </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot; {name} param&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="k">default</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="nl">empty</span><span class="p">:</span>

<span class="w">                        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;must not have a default.&quot;</span><span class="p">)</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">(</span><span class="n">param</span><span class="p">.</span><span class="n">POSITIONAL_ONLY</span><span class="p">,</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">POSITIONAL_OR_KEYWORD</span><span class="p">)</span><span class="err">:</span>

<span class="w">                        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;must be usable as a positional argument.&quot;</span><span class="p">)</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">param_matches</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">expected</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">build_output_hints</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">))</span><span class="err">:</span>

<span class="w">                        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                            </span><span class="n">f</span><span class="ss">&quot;type hint must match the {ordinal(i+1)} `.build` return (`{expected}`)&quot;</span>

<span class="w">                        </span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Validate</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">signature</span><span class="vm">?</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_map_param</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">param</span><span class="p">:</span><span class="w"> </span><span class="k">Parameter</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Should</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="ow">some</span><span class="w"> </span><span class="n">ArtifactPartition</span><span class="o">[</span><span class="n">MyArtifact</span><span class="o">]</span><span class="w"> </span><span class="n">type</span><span class="vm">?</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="p">.</span><span class="n">annotation</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">StoragePartitions</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;type hint must be `StoragePartitions`&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">name</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_map_sig</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">Signature, MapInputs</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Validate partitioned Artifacts and the .map method&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">hasattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;map&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">runtime</span><span class="w"> </span><span class="n">checking</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="err">`</span><span class="k">map</span><span class="err">`</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="p">(</span><span class="nl">ie</span><span class="p">:</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="n">aligns</span><span class="w"> </span><span class="n">w</span><span class="o">/</span><span class="w"> </span><span class="k">output</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">artifacts</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">such</span><span class="p">).</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">any</span><span class="p">(</span><span class="n">is_partitioned</span><span class="p">(</span><span class="k">view</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_outputs_</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;must be implemented when the `build` outputs are partitioned&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">def</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="o">**</span><span class="nl">kwargs</span><span class="p">:</span><span class="w"> </span><span class="n">StoragePartitions</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">PartitionDependencies</span><span class="p">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">PartitionDependencies</span><span class="p">(</span><span class="err">{</span><span class="nl">NotPartitioned</span><span class="p">:</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span><span class="err">}</span><span class="p">)</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">Narrow</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="n">signature</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">validated</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">graph</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="p">(</span><span class="n">via</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_map_inputs_</span><span class="p">)</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">map</span><span class="p">.</span>

<span class="w">            </span><span class="k">map</span><span class="p">.</span><span class="n">__signature__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Signature</span><span class="p">(</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="k">ignore</span><span class="o">[</span><span class="n">attr-defined</span><span class="o">]</span>

<span class="w">                </span><span class="o">[</span>

<span class="n">                    Parameter(name=name, annotation=StoragePartitions, kind=Parameter.KEYWORD_ONLY)</span>

<span class="n">                    for name, artifact in cls._input_artifact_classes_.items()</span>

<span class="n">                    if name in cls._build_inputs_</span>

<span class="n">                </span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="n">return_annotation</span><span class="o">=</span><span class="n">PartitionDependencies</span><span class="p">,</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">cls</span><span class="p">.</span><span class="k">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cast</span><span class="p">(</span><span class="n">MapSig</span><span class="p">,</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">(</span><span class="k">map</span><span class="p">))</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">getattr_static</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;map&quot;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">classmethod</span><span class="p">,</span><span class="w"> </span><span class="n">staticmethod</span><span class="p">))</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;must be a @classmethod or @staticmethod&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">map_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">signature</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="k">map</span><span class="p">)</span>

<span class="w">        </span><span class="n">map_inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MapInputs</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_validate_parameters</span><span class="p">(</span><span class="n">map_sig</span><span class="p">,</span><span class="w"> </span><span class="n">validator</span><span class="o">=</span><span class="n">cls</span><span class="p">.</span><span class="n">_validate_map_param</span><span class="p">))</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">map_sig</span><span class="p">,</span><span class="w"> </span><span class="n">map_inputs</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Verify</span><span class="w"> </span><span class="k">map</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="n">hint</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">TBD</span><span class="w"> </span><span class="n">spec</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_no_unused_fields</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">unused_fields</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_input_artifact_classes_</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span>

<span class="w">            </span><span class="k">set</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_build_sig_</span><span class="p">.</span><span class="k">parameters</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_map_sig_</span><span class="p">.</span><span class="k">parameters</span><span class="p">)</span>

<span class="w">        </span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;the following fields aren&#39;t used in `.build` or `.map`: {unused_fields}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">    </span><span class="nv">@validator</span><span class="p">(</span><span class="ss">&quot;*&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_validate_instance_artifact_args</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="nl">field</span><span class="p">:</span><span class="w"> </span><span class="n">ModelField</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Artifact</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">view</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_build_inputs_</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">field</span><span class="p">.</span><span class="n">name</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="k">view</span><span class="p">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">value</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">pydantic</span><span class="w"> </span><span class="n">defines</span><span class="w"> </span><span class="p">.</span><span class="n">__iter__</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="err">`</span><span class="n">self</span><span class="p">.</span><span class="n">__dict__</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="err">`</span><span class="n">dict</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="err">`</span><span class="p">,</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">override</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">easy</span><span class="w"> </span><span class="n">expansion</span><span class="o">/</span><span class="n">assignment</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Graph</span><span class="w">  </span><span class="k">without</span><span class="w"> </span><span class="err">`</span><span class="p">.</span><span class="k">out</span><span class="p">()</span><span class="err">`</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="err">`</span><span class="n">g</span><span class="p">.</span><span class="n">artifacts</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">.</span><span class="n">artifacts</span><span class="p">.</span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MyProducer</span><span class="p">(...)</span><span class="err">`</span><span class="p">).</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__iter__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Iterator</span><span class="o">[</span><span class="n">Artifact</span><span class="o">]</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="k">ignore</span><span class="o">[</span><span class="n">override</span><span class="o">]</span>

<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">out</span><span class="p">()</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span><span class="w"> </span><span class="n">tuple</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="p">,)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">iter</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">compute_input_fingerprint</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">dependency_partitions</span><span class="p">:</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">str, StoragePartitions</span><span class="o">]</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="n">input_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">dependency_partitions</span><span class="p">)</span>

<span class="w">        </span><span class="n">expected_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_build_inputs_</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">input_names</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">expected_names</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;Mismatched dependency inputs; expected {expected_names}, got {input_names}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">care</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">*</span><span class="n">code</span><span class="o">*</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">*</span><span class="k">input</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="n">contents</span><span class="o">*</span><span class="w"> </span><span class="n">changed</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="k">file</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">paths</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="p">(</span><span class="n">but</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">content</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">prior</span><span class="w"> </span><span class="n">run</span><span class="p">).</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_class_key_</span><span class="p">).</span><span class="n">combine</span><span class="p">(</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">version</span><span class="p">.</span><span class="n">fingerprint</span><span class="p">,</span>

<span class="w">            </span><span class="o">*</span><span class="p">(</span>

<span class="w">                </span><span class="k">partition</span><span class="p">.</span><span class="n">content_fingerprint</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">dependency_partitions</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="k">partition</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">partitions</span>

<span class="w">            </span><span class="p">),</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">compute_dependencies</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">input_partitions</span><span class="p">:</span><span class="w"> </span><span class="n">InputPartitions</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">PartitionDependencies, InputFingerprints</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Validate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Producer</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">partitioning</span><span class="w"> </span><span class="n">scheme</span><span class="w"> </span><span class="ow">and</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="p">(</span><span class="n">basically</span><span class="p">,</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">error</span><span class="p">).</span><span class="w"> </span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">partitioned</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">expect</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="mi">1</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="w"> </span><span class="p">(</span><span class="n">NotPartitioned</span><span class="p">).</span>

<span class="w">        </span><span class="n">partition_dependencies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="k">map</span><span class="p">(</span>

<span class="w">            </span><span class="o">**</span><span class="err">{</span>

<span class="w">                </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">partitions</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">input_partitions</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_map_inputs_</span>

<span class="w">            </span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="n">partition_input_fingerprints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">(</span>

<span class="w">            </span><span class="err">{</span>

<span class="w">                </span><span class="nl">composite_key</span><span class="p">:</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">compute_input_fingerprint</span><span class="p">(</span><span class="n">dependency_partitions</span><span class="p">)</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">composite_key</span><span class="p">,</span><span class="w"> </span><span class="n">dependency_partitions</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">            </span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="p">,</span><span class="w"> </span><span class="n">partition_input_fingerprints</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">inputs</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Artifact</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="err">{</span><span class="nl">k</span><span class="p">:</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_input_artifact_classes_</span><span class="err">}</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">out</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nl">outputs</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Artifact, tuple[Artifact, ...</span><span class="o">]</span><span class="err">]:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Configure the output Artifacts this Producer will build.</span>

<span class="ss">        The arguments are matched to the `Producer.build` return signature in order.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="k">view</span><span class="p">.</span><span class="n">artifact_class</span><span class="p">(</span><span class="n">type</span><span class="o">=</span><span class="k">view</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_outputs_</span><span class="p">)</span>

<span class="w">        </span><span class="n">passed_n</span><span class="p">,</span><span class="w"> </span><span class="n">expected_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">),</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_build_sig_</span><span class="p">.</span><span class="n">return_annotation</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">passed_n</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">expected_n</span><span class="p">:</span>

<span class="w">            </span><span class="n">ret_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;, &quot;</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="o">[</span><span class="n">str(v) for v in self._build_sig_.return_annotation</span><span class="o">]</span><span class="p">)</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;{self._class_key_}.out() - expected {expected_n} arguments of ({ret_str}), but got: {outputs}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">ord</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Artifact</span><span class="p">:</span>

<span class="w">            </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_outputs_</span><span class="o">[</span><span class="n">ord</span><span class="o">]</span>

<span class="w">            </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot;{self._class_key_}.out() {ordinal(ord+1)} argument&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">view</span><span class="p">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                        </span><span class="n">f</span><span class="ss">&quot;{artifact} is produced by {artifact.producer_output.producer}!&quot;</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span>

<span class="w">                </span><span class="k">update</span><span class="o">=</span><span class="err">{</span><span class="ss">&quot;producer_output&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">ProducerOutput</span><span class="p">(</span><span class="n">producer</span><span class="o">=</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">position</span><span class="o">=</span><span class="n">ord</span><span class="p">)</span><span class="err">}</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="n">validate</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">ord</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">outputs</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">outputs</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_9">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables_9">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_9">Static methods</h4>
<h4 id="construct_9">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_9">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_9">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_9">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_9">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_9">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_9">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_9">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_9">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="validate_outputs">validate_outputs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate_outputs</span><span class="p">(</span>
    <span class="o">*</span><span class="n">outputs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Union[bool, tuple[bool, str]]&#39;</span>
</code></pre></div>

<p>Validate the <code>Producer.build</code> outputs, returning the status and a message.</p>
<p>The validation status is applied to all outputs. If validation does not pass, the
outputs will not be written to storage to prevent checkpointing the output. In the
future, we may still write the data to ease debugging, but track validation status in
the Backend (preventing downstream use).</p>
<p>The arguments must not be mutated.</p>
<p>The parameters must be usable with positional argument. The output of <code>build</code> will be
passed in as it was returned, for example: <code>def build(...): return 1, 2</code> will result in
<code>validate_outputs(1, 2)</code>.</p>
<p>NOTE: <code>validate_outputs</code> is a stopgap until Statistics and Thresholds are fully implemented.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">        </span><span class="nv">@staticmethod</span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">validate_outputs</span><span class="p">(</span><span class="o">*</span><span class="n">outputs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">Union</span><span class="err">[</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="n">tuple</span><span class="err">[</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="err">]]</span><span class="o">:</span>

<span class="w">            </span><span class="s2">&quot;</span><span class="se">&quot;&quot;</span><span class="s2">Validate the `Producer.build` outputs, returning the status and a message.</span>

<span class="s2">            The validation status is applied to all outputs. If validation does not pass, the</span>

<span class="s2">            outputs will not be written to storage to prevent checkpointing the output. In the</span>

<span class="s2">            future, we may still write the data to ease debugging, but track validation status in</span>

<span class="s2">            the Backend (preventing downstream use).</span>

<span class="s2">            The arguments must not be mutated.</span>

<span class="s2">            The parameters must be usable with positional argument. The output of `build` will be</span>

<span class="s2">            passed in as it was returned, for example: `def build(...): return 1, 2` will result in</span>

<span class="s2">            `validate_outputs(1, 2)`.</span>

<span class="s2">            NOTE: `validate_outputs` is a stopgap until Statistics and Thresholds are fully implemented.</span>

<span class="s2">            </span><span class="se">&quot;&quot;</span><span class="s2">&quot;</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;No validation performed.&quot;</span>
</code></pre></div>

</details>
<h4 id="instance-variables_9">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">inputs</span>
</code></pre></div>

<h4 id="methods_10">Methods</h4>
<h4 id="compute_dependencies">compute_dependencies</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_dependencies</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">input_partitions</span><span class="p">:</span> <span class="s1">&#39;InputPartitions&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[PartitionDependencies, InputFingerprints]&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">compute_dependencies</span><span class="p">(</span>

<span class="w">        </span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">input_partitions</span><span class="o">:</span><span class="w"> </span><span class="n">InputPartitions</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="p">[</span><span class="n">PartitionDependencies</span><span class="p">,</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">]</span><span class="o">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="o">:</span><span class="w"> </span><span class="kr">Validate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">partition_dependencies</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Producer</span><span class="s">&#39;s partitioning scheme and</span>

<span class="s">        # such (basically, check user error). eg: if output is not partitioned, we expect only 1</span>

<span class="s">        # entry in partition_dependencies (NotPartitioned).</span>

<span class="s">        partition_dependencies = self.map(</span>

<span class="s">            **{</span>

<span class="s">                name: partitions</span>

<span class="s">                for name, partitions in input_partitions.items()</span>

<span class="s">                if name in self._map_inputs_</span>

<span class="s">            }</span>

<span class="s">        )</span>

<span class="s">        partition_input_fingerprints = InputFingerprints(</span>

<span class="s">            {</span>

<span class="s">                composite_key: self.compute_input_fingerprint(dependency_partitions)</span>

<span class="s">                for composite_key, dependency_partitions in partition_dependencies.items()</span>

<span class="s">            }</span>

<span class="s">        )</span>

<span class="s">        return partition_dependencies, partition_input_fingerprints</span>
</code></pre></div>

</details>
<h4 id="compute_input_fingerprint">compute_input_fingerprint</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_input_fingerprint</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dependency_partitions</span><span class="p">:</span> <span class="s1">&#39;frozendict[str, StoragePartitions]&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Fingerprint&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nt">def</span><span class="w"> </span><span class="nt">compute_input_fingerprint</span><span class="o">(</span>

<span class="w">        </span><span class="nt">self</span><span class="o">,</span><span class="w"> </span><span class="nt">dependency_partitions</span><span class="o">:</span><span class="w"> </span><span class="nt">frozendict</span><span class="cp">[</span><span class="nx">str</span><span class="p">,</span><span class="w"> </span><span class="nx">StoragePartitions</span><span class="cp">]</span>

<span class="w">    </span><span class="o">)</span><span class="w"> </span><span class="nt">-</span><span class="o">&gt;</span><span class="w"> </span><span class="nt">Fingerprint</span><span class="o">:</span>

<span class="w">        </span><span class="nt">input_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">set</span><span class="o">(</span><span class="nt">dependency_partitions</span><span class="o">)</span>

<span class="w">        </span><span class="nt">expected_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nt">set</span><span class="o">(</span><span class="nt">self</span><span class="p">.</span><span class="nc">_build_inputs_</span><span class="o">)</span>

<span class="w">        </span><span class="nt">if</span><span class="w"> </span><span class="nt">input_names</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nt">expected_names</span><span class="o">:</span>

<span class="w">            </span><span class="nt">raise</span><span class="w"> </span><span class="nt">ValueError</span><span class="o">(</span>

<span class="w">                </span><span class="nt">f</span><span class="s2">&quot;Mismatched dependency inputs; expected {expected_names}, got {input_names}&quot;</span>

<span class="w">            </span><span class="o">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nt">We</span><span class="w"> </span><span class="nt">only</span><span class="w"> </span><span class="nt">care</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="o">*</span><span class="nt">code</span><span class="o">*</span><span class="w"> </span><span class="nt">or</span><span class="w"> </span><span class="o">*</span><span class="nt">input</span><span class="w"> </span><span class="nt">partition</span><span class="w"> </span><span class="nt">contents</span><span class="o">*</span><span class="w"> </span><span class="nt">changed</span><span class="o">,</span><span class="w"> </span><span class="nt">not</span><span class="w"> </span><span class="nt">if</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="nt">input</span><span class="w"> </span><span class="nt">file</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nt">paths</span><span class="w"> </span><span class="nt">changed</span><span class="w"> </span><span class="o">(</span><span class="nt">but</span><span class="w"> </span><span class="nt">have</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="nt">same</span><span class="w"> </span><span class="nt">content</span><span class="w"> </span><span class="nt">as</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="nt">prior</span><span class="w"> </span><span class="nt">run</span><span class="o">).</span>

<span class="w">        </span><span class="nt">return</span><span class="w"> </span><span class="nt">Fingerprint</span><span class="p">.</span><span class="nc">from_string</span><span class="o">(</span><span class="nt">self</span><span class="p">.</span><span class="nc">_class_key_</span><span class="o">)</span><span class="p">.</span><span class="nc">combine</span><span class="o">(</span>

<span class="w">            </span><span class="nt">self</span><span class="p">.</span><span class="nc">version</span><span class="p">.</span><span class="nc">fingerprint</span><span class="o">,</span>

<span class="w">            </span><span class="o">*(</span>

<span class="w">                </span><span class="nt">partition</span><span class="p">.</span><span class="nc">content_fingerprint</span>

<span class="w">                </span><span class="nt">for</span><span class="w"> </span><span class="nt">name</span><span class="o">,</span><span class="w"> </span><span class="nt">partitions</span><span class="w"> </span><span class="nt">in</span><span class="w"> </span><span class="nt">dependency_partitions</span><span class="p">.</span><span class="nc">items</span><span class="o">()</span>

<span class="w">                </span><span class="nt">for</span><span class="w"> </span><span class="nt">partition</span><span class="w"> </span><span class="nt">in</span><span class="w"> </span><span class="nt">partitions</span>

<span class="w">            </span><span class="o">),</span>

<span class="w">        </span><span class="o">)</span>
</code></pre></div>

</details>
<h4 id="copy_9">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_9">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_9">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h4 id="out">out</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">out</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">outputs</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Union[Artifact, tuple[Artifact, ...]]&#39;</span>
</code></pre></div>

<p>Configure the output Artifacts this Producer will build.</p>
<p>The arguments are matched to the <code>Producer.build</code> return signature in order.</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">out</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nl">outputs</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Artifact, tuple[Artifact, ...</span><span class="o">]</span><span class="err">]:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Configure the output Artifacts this Producer will build.</span>

<span class="ss">        The arguments are matched to the `Producer.build` return signature in order.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">outputs</span><span class="p">:</span>

<span class="w">            </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="k">view</span><span class="p">.</span><span class="n">artifact_class</span><span class="p">(</span><span class="n">type</span><span class="o">=</span><span class="k">view</span><span class="p">.</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_outputs_</span><span class="p">)</span>

<span class="w">        </span><span class="n">passed_n</span><span class="p">,</span><span class="w"> </span><span class="n">expected_n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">),</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_build_sig_</span><span class="p">.</span><span class="n">return_annotation</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">passed_n</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">expected_n</span><span class="p">:</span>

<span class="w">            </span><span class="n">ret_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;, &quot;</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="o">[</span><span class="n">str(v) for v in self._build_sig_.return_annotation</span><span class="o">]</span><span class="p">)</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;{self._class_key_}.out() - expected {expected_n} arguments of ({ret_str}), but got: {outputs}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">def</span><span class="w"> </span><span class="n">validate</span><span class="p">(</span><span class="nl">artifact</span><span class="p">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">ord</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Artifact</span><span class="p">:</span>

<span class="w">            </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_outputs_</span><span class="o">[</span><span class="n">ord</span><span class="o">]</span>

<span class="w">            </span><span class="k">with</span><span class="w"> </span><span class="n">wrap_exc</span><span class="p">(</span><span class="n">ValueError</span><span class="p">,</span><span class="w"> </span><span class="k">prefix</span><span class="o">=</span><span class="n">f</span><span class="ss">&quot;{self._class_key_}.out() {ordinal(ord+1)} argument&quot;</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">view</span><span class="p">.</span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">producer_output</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                        </span><span class="n">f</span><span class="ss">&quot;{artifact} is produced by {artifact.producer_output.producer}!&quot;</span>

<span class="w">                    </span><span class="p">)</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">artifact</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span>

<span class="w">                </span><span class="k">update</span><span class="o">=</span><span class="err">{</span><span class="ss">&quot;producer_output&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">ProducerOutput</span><span class="p">(</span><span class="n">producer</span><span class="o">=</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">position</span><span class="o">=</span><span class="n">ord</span><span class="p">)</span><span class="err">}</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tuple</span><span class="p">(</span><span class="n">validate</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="n">ord</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">outputs</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">outputs</span>
</code></pre></div>

</details>
<h3 id="statistic">Statistic</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Statistic</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">Statistic</span>(<span class="n">Model</span>):

    <span class="nb">pass</span>  <span class="c1"># TODO: Determine the interface for Statistics</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_10">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables_10">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_10">Static methods</h4>
<h4 id="construct_10">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_10">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_10">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_10">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_10">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_10">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_10">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_10">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_10">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_10">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_11">Methods</h4>
<h4 id="copy_10">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_10">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_10">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="storage">Storage</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Storage</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Storage</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span><span class="w"> </span><span class="n">Generic</span><span class="o">[</span><span class="n">StoragePartitionVar_co</span><span class="o">]</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Storage is a data reference identifying 1 or more partitions of data.</span>

<span class="ss">    Storage fields should have defaults set with placeholders for tags and partition</span>

<span class="ss">    keys. This allows automatic injection of the tags and partition keys for simple</span>

<span class="ss">    cases.</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">_abstract_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">    </span><span class="nl">storage_partition_type</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">type[StoragePartitionVar_co</span><span class="o">]</span><span class="err">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="k">ignore</span><span class="o">[</span><span class="n">misc</span><span class="o">]</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="n">separators</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">resolve_</span><span class="o">*</span><span class="w"> </span><span class="n">helpers</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nf">format</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="k">into</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">storage</span><span class="w"> </span><span class="n">fields</span><span class="p">.</span>

<span class="w">    </span><span class="err">#</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">defaults</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">tailored</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ss">&quot;path&quot;</span><span class="o">-</span><span class="ow">like</span><span class="w"> </span><span class="n">fields</span><span class="p">.</span>

<span class="w">    </span><span class="nl">key_value_sep</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;=&quot;</span>

<span class="w">    </span><span class="nl">partition_name_component_sep</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;_&quot;</span>

<span class="w">    </span><span class="nl">segment_sep</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="p">.</span><span class="n">sep</span>

<span class="w">    </span><span class="nl">_key_types</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">CompositeKeyTypes</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PrivateAttr</span><span class="p">(</span><span class="k">None</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init_subclass__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="nl">kwargs</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">super</span><span class="p">().</span><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="nl">_abstract_</span><span class="p">:</span>

<span class="w">            </span><span class="k">return</span>

<span class="w">        </span><span class="n">cls</span><span class="p">.</span><span class="n">storage_partition_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_class_type_vars</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">        </span><span class="n">expected_field_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">outer_type_</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">storage_partition_type</span><span class="p">.</span><span class="n">__fields__</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">StoragePartition</span><span class="p">.</span><span class="n">__fields__</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="n">fields</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">info</span><span class="p">.</span><span class="n">outer_type_</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">__fields__</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">Storage</span><span class="p">.</span><span class="n">__fields__</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">expected_field_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;{cls.__name__} fields must match {cls.storage_partition_type.__name__} ({expected_field_types}), got: {fields}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_default</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Storage</span><span class="o">[</span><span class="n">StoragePartition</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="n">arti</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">literal</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">StringLiteral</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StringLiteral</span><span class="p">()</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Support</span><span class="w"> </span><span class="ow">some</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">configurable</span><span class="w"> </span><span class="n">defaults</span><span class="p">.</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_visit_type</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Self</span><span class="p">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">Check</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">partitioning</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">field</span><span class="p">(</span><span class="n">s</span><span class="p">).</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>

<span class="w">        </span><span class="n">copy</span><span class="p">.</span><span class="n">_key_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PartitionKey</span><span class="p">.</span><span class="n">types_from</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>

<span class="w">        </span><span class="n">assert</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">key_types</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="n">key_component_specs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="n">f</span><span class="ss">&quot;{name}{self.partition_name_component_sep}{component_name}&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">f</span><span class="ss">&quot;{{{name}.{component_spec}}}&quot;</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">pk</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">key_types</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">component_name</span><span class="p">,</span><span class="w"> </span><span class="n">component_spec</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">pk</span><span class="p">.</span><span class="n">default_key_components</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">resolve</span><span class="p">(</span>

<span class="w">            </span><span class="n">partition_key_spec</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">segment_sep</span><span class="p">.</span><span class="k">join</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;{name}{self.key_value_sep}{spec}&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">key_component_specs</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_visit_format</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">format_</span><span class="p">:</span><span class="w"> </span><span class="nf">Format</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Self</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="n">format_</span><span class="p">.</span><span class="n">extension</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_visit_graph</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">graph</span><span class="p">:</span><span class="w"> </span><span class="n">Graph</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Self</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">resolve</span><span class="p">(</span>

<span class="w">            </span><span class="n">graph_name</span><span class="o">=</span><span class="n">graph</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>

<span class="w">            </span><span class="n">path_tags</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">segment_sep</span><span class="p">.</span><span class="k">join</span><span class="p">(</span>

<span class="w">                </span><span class="n">f</span><span class="ss">&quot;{tag}{self.key_value_sep}{value}&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">graph</span><span class="p">.</span><span class="n">path_tags</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">            </span><span class="p">),</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_visit_input_fingerprint</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">input_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Self</span><span class="p">:</span>

<span class="w">        </span><span class="n">input_fingerprint_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">input_fingerprint</span><span class="p">.</span><span class="k">key</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">input_fingerprint</span><span class="p">.</span><span class="nl">is_empty</span><span class="p">:</span>

<span class="w">            </span><span class="n">input_fingerprint_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">input_fingerprint</span><span class="o">=</span><span class="n">input_fingerprint_key</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_visit_names</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">names</span><span class="err">:</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">str, ...</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Self</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">resolve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="k">names</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">names</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">names</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">segment_sep</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="k">names</span><span class="p">))</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">includes_input_fingerprint_template</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="ow">any</span><span class="p">(</span><span class="ss">&quot;{input_fingerprint}&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_format_fields</span><span class="p">.</span><span class="k">values</span><span class="p">())</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">key_types</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">CompositeKeyTypes</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_key_types</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;`key_types` have not been set yet.&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_key_types</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_format_fields</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">frozendict</span><span class="o">[</span><span class="n">str, str</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">frozendict</span><span class="p">(</span>

<span class="w">            </span><span class="err">{</span>

<span class="w">                </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="k">value</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__fields__</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)),</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span>

<span class="w">            </span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_check_keys</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">key_types</span><span class="p">:</span><span class="w"> </span><span class="n">CompositeKeyTypes</span><span class="p">,</span><span class="w"> </span><span class="nl">keys</span><span class="p">:</span><span class="w"> </span><span class="n">CompositeKey</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Confirm</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="k">names</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="n">align</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">key_types</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">keys</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Expected partition keys {tuple(key_types)} but none were passed&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">keys</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">key_types</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Expected no partition keys but got: {keys}&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@abc</span><span class="p">.</span><span class="n">abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">discover_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">input_fingerprints</span><span class="p">:</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">()</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">StoragePartitionVar_co, ...</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">generate_partition</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">keys</span><span class="p">:</span><span class="w"> </span><span class="n">CompositeKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CompositeKey</span><span class="p">(),</span>

<span class="w">        </span><span class="nl">input_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">.</span><span class="n">empty</span><span class="p">(),</span>

<span class="w">        </span><span class="nl">with_content_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">StoragePartitionVar_co</span><span class="p">:</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_check_keys</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">key_types</span><span class="p">,</span><span class="w"> </span><span class="n">keys</span><span class="p">)</span>

<span class="w">        </span><span class="n">format_kwargs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">Any, Any</span><span class="o">]</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">input_fingerprint</span><span class="p">.</span><span class="nl">is_empty</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">includes_input_fingerprint_template</span><span class="p">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;{self} requires an input_fingerprint, but none was provided&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">includes_input_fingerprint_template</span><span class="p">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;{self} does not specify a {{input_fingerprint}} template&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">format_kwargs</span><span class="o">[</span><span class="n">&quot;input_fingerprint&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">input_fingerprint</span><span class="p">.</span><span class="k">key</span><span class="p">)</span>

<span class="w">        </span><span class="n">field_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="p">(</span>

<span class="w">                </span><span class="n">strip_partition_indexes</span><span class="p">(</span><span class="n">original</span><span class="p">).</span><span class="nf">format</span><span class="p">(</span><span class="o">**</span><span class="n">format_kwargs</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">lenient_issubclass</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">original</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">)),</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span>

<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="n">original</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__fields__</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">storage_partition_type</span><span class="p">.</span><span class="n">__fields__</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">partition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">storage_partition_type</span><span class="p">(</span>

<span class="w">            </span><span class="n">input_fingerprint</span><span class="o">=</span><span class="n">input_fingerprint</span><span class="p">,</span><span class="w"> </span><span class="n">keys</span><span class="o">=</span><span class="n">keys</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">field_values</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nl">with_content_fingerprint</span><span class="p">:</span>

<span class="w">            </span><span class="k">partition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">partition</span><span class="p">.</span><span class="n">with_content_fingerprint</span><span class="p">()</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">partition</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_resolve_field</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">spec</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">,</span><span class="w"> </span><span class="nl">placeholder_values</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, str</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">placeholder</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">placeholder_values</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">value</span><span class="err">:</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="n">Strip</span><span class="w"> </span><span class="n">placeholder</span><span class="w"> </span><span class="o">*</span><span class="ow">and</span><span class="o">*</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="k">trailing</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">segment_sep</span><span class="p">.</span>

<span class="w">                </span><span class="k">trim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;{&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">placeholder</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="ss">&quot;}&quot;</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">f</span><span class="ss">&quot;{trim}{self.segment_sep}&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">spec</span><span class="p">:</span>

<span class="w">                    </span><span class="k">trim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="ss">&quot;{trim}{self.segment_sep}&quot;</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="n">Also</span><span class="w"> </span><span class="n">strip</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="k">trailing</span><span class="w"> </span><span class="n">separators</span><span class="p">,</span><span class="w"> </span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">placeholder</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="p">.</span>

<span class="w">                </span><span class="n">spec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spec</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="k">trim</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="p">).</span><span class="n">rstrip</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">segment_sep</span><span class="p">)</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">spec</span><span class="p">:</span>

<span class="w">                    </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;{self}.{name} was empty after removing unused templates&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">partial_format</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">placeholder_values</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">resolve</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="k">values</span><span class="err">:</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Self</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span>

<span class="w">            </span><span class="k">update</span><span class="o">=</span><span class="err">{</span>

<span class="w">                </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="k">new</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_format_fields</span><span class="p">.</span><span class="n">items</span><span class="p">()</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="n">Avoid</span><span class="w"> </span><span class="ss">&quot;setting&quot;</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="n">pydantic</span><span class="w"> </span><span class="n">repr</span><span class="w"> </span><span class="n">verbosity</span><span class="w"> </span><span class="p">(</span><span class="n">which</span>

<span class="w">                </span><span class="err">#</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="ss">&quot;set&quot;</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="k">default</span><span class="p">).</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_resolve_field</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">original</span><span class="p">,</span><span class="w"> </span><span class="k">values</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">original</span>

<span class="w">            </span><span class="err">}</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_11">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
<li>typing.Generic</li>
</ul>
<h4 id="descendants_5">Descendants</h4>
<ul>
<li>arti.storage.google.cloud.storage.GCSFile</li>
<li>arti.storage.local.LocalFile</li>
<li>arti.storage.literal.StringLiteral</li>
</ul>
<h4 id="class-variables_11">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">key_value_sep</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">partition_name_component_sep</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">segment_sep</span>
</code></pre></div>

<h4 id="static-methods_11">Static methods</h4>
<h4 id="construct_11">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_11">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="get_default_1">get_default</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_default</span><span class="p">(</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Storage[StoragePartition]&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    <span class="nd">@classmethod</span>

    <span class="k">def</span> <span class="nf">get_default</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Storage</span><span class="p">[</span><span class="n">StoragePartition</span><span class="p">]:</span>

        <span class="kn">from</span> <span class="nn">arti.storage.literal</span> <span class="kn">import</span> <span class="n">StringLiteral</span>

        <span class="k">return</span> <span class="n">StringLiteral</span><span class="p">()</span>  <span class="c1"># TODO: Support some sort of configurable defaults.</span>
</code></pre></div>

</details>
<h4 id="parse_file_11">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_11">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_11">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_11">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_11">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_11">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_11">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_11">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">includes_input_fingerprint_template</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">key_types</span>
</code></pre></div>

<h4 id="methods_12">Methods</h4>
<h4 id="copy_11">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_11">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="discover_partitions">discover_partitions</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">discover_partitions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">input_fingerprints</span><span class="p">:</span> <span class="s1">&#39;InputFingerprints&#39;</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;tuple[StoragePartitionVar_co, ...]&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abc</span><span class="p">.</span><span class="n">abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">discover_partitions</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">input_fingerprints</span><span class="p">:</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InputFingerprints</span><span class="p">()</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">StoragePartitionVar_co, ...</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="generate_partition">generate_partition</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_partition</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">keys</span><span class="p">:</span> <span class="s1">&#39;CompositeKey&#39;</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">input_fingerprint</span><span class="p">:</span> <span class="s1">&#39;Fingerprint&#39;</span> <span class="o">=</span> <span class="n">Fingerprint</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">with_content_fingerprint</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;StoragePartitionVar_co&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="x">    def generate_partition(</span>

<span class="x">        self,</span>

<span class="x">        keys: CompositeKey = CompositeKey(),</span>

<span class="x">        input_fingerprint: Fingerprint = Fingerprint.empty(),</span>

<span class="x">        with_content_fingerprint: bool = True,</span>

<span class="x">    ) -&gt; StoragePartitionVar_co:</span>

<span class="x">        self._check_keys(self.key_types, keys)</span>

<span class="x">        format_kwargs = dict[Any, Any](keys)</span>

<span class="x">        if input_fingerprint.is_empty:</span>

<span class="x">            if self.includes_input_fingerprint_template:</span>

<span class="x">                raise ValueError(f&quot;{self} requires an input_fingerprint, but none was provided&quot;)</span>

<span class="x">        else:</span>

<span class="x">            if not self.includes_input_fingerprint_template:</span>

<span class="x">                raise ValueError(f&quot;{self} does not specify a </span><span class="cp">{{</span><span class="nv">input_fingerprint</span><span class="cp">}}</span><span class="x"> template&quot;)</span>

<span class="x">            format_kwargs[&quot;input_fingerprint&quot;] = str(input_fingerprint.key)</span>

<span class="x">        field_values = {</span>

<span class="x">            name: (</span>

<span class="x">                strip_partition_indexes(original).format(**format_kwargs)</span>

<span class="x">                if lenient_issubclass(type(original := getattr(self, name)), str)</span>

<span class="x">                else original</span>

<span class="x">            )</span>

<span class="x">            for name in self.__fields__</span>

<span class="x">            if name in self.storage_partition_type.__fields__</span>

<span class="x">        }</span>

<span class="x">        partition = self.storage_partition_type(</span>

<span class="x">            input_fingerprint=input_fingerprint, keys=keys, **field_values</span>

<span class="x">        )</span>

<span class="x">        if with_content_fingerprint:</span>

<span class="x">            partition = partition.with_content_fingerprint()</span>

<span class="x">        return partition</span>
</code></pre></div>

</details>
<h4 id="json_11">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h4 id="resolve">resolve</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">def</span><span class="w"> </span><span class="nf">resolve</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="nv">values</span><span class="o">:</span><span class="w"> </span><span class="nv">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nv">Self</span><span class="o">:</span>

<span class="w">        </span><span class="nv">return</span><span class="w"> </span><span class="nv">self</span><span class="o">.</span><span class="nf">copy</span><span class="p">(</span>

<span class="w">            </span><span class="nv">update</span><span class="o">=</span><span class="p">{</span>

<span class="w">                </span><span class="nv">name</span><span class="o">:</span><span class="w"> </span><span class="nv">new</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="nv">name</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="nv">iginal</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">self</span><span class="o">.</span><span class="nv">_format_fields</span><span class="o">.</span><span class="nf">items</span><span class="p">()</span>

<span class="w">                </span><span class="o">#</span><span class="w"> </span><span class="nv">Avoid</span><span class="w"> </span><span class="s">&quot;setting&quot;</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">updated</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nv">reduce</span><span class="w"> </span><span class="nv">pydantic</span><span class="w"> </span><span class="nv">repr</span><span class="w"> </span><span class="nf">verbosity</span><span class="w"> </span><span class="p">(</span><span class="nv">which</span>

<span class="w">                </span><span class="o">#</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="nv">shows</span><span class="w"> </span><span class="s">&quot;set&quot;</span><span class="w"> </span><span class="nv">fields</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">default</span><span class="p">)</span><span class="o">.</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nv">new</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">self</span><span class="o">.</span><span class="nf">_resolve_field</span><span class="p">(</span><span class="nv">name</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="nv">iginal</span><span class="p">,</span><span class="w"> </span><span class="nv">values</span><span class="p">))</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="ow">or</span><span class="nv">iginal</span>

<span class="w">            </span><span class="p">}</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="storagepartition">StoragePartition</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">StoragePartition</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">StoragePartition</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="nl">keys</span><span class="p">:</span><span class="w"> </span><span class="n">CompositeKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CompositeKey</span><span class="p">()</span>

<span class="w">    </span><span class="nl">input_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span>

<span class="w">    </span><span class="nl">content_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="n">Fingerprint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Fingerprint</span><span class="p">.</span><span class="n">empty</span><span class="p">()</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">with_content_fingerprint</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">keep_existing</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Self</span><span class="p">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">keep_existing</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">content_fingerprint</span><span class="p">.</span><span class="nl">is_empty</span><span class="p">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">self</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="k">update</span><span class="o">=</span><span class="err">{</span><span class="ss">&quot;content_fingerprint&quot;</span><span class="err">:</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">compute_content_fingerprint</span><span class="p">()</span><span class="err">}</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@abc</span><span class="p">.</span><span class="n">abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">compute_content_fingerprint</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span>

<span class="w">            </span><span class="ss">&quot;{type(self).__name__}.compute_content_fingerprint is not implemented!&quot;</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_12">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="descendants_6">Descendants</h4>
<ul>
<li>arti.storage.google.cloud.storage.GCSFilePartition</li>
<li>arti.storage.local.LocalFilePartition</li>
<li>arti.storage.literal.StringLiteralPartition</li>
</ul>
<h4 id="class-variables_12">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_12">Static methods</h4>
<h4 id="construct_12">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_12">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_12">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_12">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_12">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_12">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_12">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_12">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_12">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_12">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_13">Methods</h4>
<h4 id="compute_content_fingerprint">compute_content_fingerprint</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compute_content_fingerprint</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Fingerprint&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@abc</span><span class="p">.</span><span class="n">abstractmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">compute_content_fingerprint</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Fingerprint</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span>

<span class="w">            </span><span class="ss">&quot;{type(self).__name__}.compute_content_fingerprint is not implemented!&quot;</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="copy_12">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_12">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_12">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h4 id="with_content_fingerprint">with_content_fingerprint</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">with_content_fingerprint</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">keep_existing</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">with_content_fingerprint</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">keep_existing</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">True</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kr">Self</span><span class="o">:</span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="n">keep_existing</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">content_fingerprint</span><span class="p">.</span><span class="n">is_empty</span><span class="o">:</span>

<span class="w">            </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">update</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;content_fingerprint&quot;</span><span class="o">:</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">compute_content_fingerprint</span><span class="p">()})</span>
</code></pre></div>

</details>
<h3 id="threshold">Threshold</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Threshold</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Threshold</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">type[Type</span><span class="o">]</span><span class="err">]</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="k">check</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="err">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_13">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables_13">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_13">Static methods</h4>
<h4 id="construct_13">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_13">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_13">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_13">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_13">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_13">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_13">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_13">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_13">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_13">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_14">Methods</h4>
<h4 id="check">check</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">check</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">check</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="o">:</span><span class="w"> </span><span class="kr">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bool</span><span class="o">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="copy_13">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_13">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_13">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="type">Type</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Type</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">Type</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Type represents a data type.&quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">_abstract_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="n">Exclude</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">minimize</span><span class="w"> </span><span class="n">fingerprint</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="p">(</span><span class="ow">and</span><span class="w"> </span><span class="n">thus</span><span class="w"> </span><span class="n">rebuilds</span><span class="p">).</span>

<span class="w">    </span><span class="n">_fingerprint_excludes_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">frozenset</span><span class="p">(</span><span class="o">[</span><span class="n">&quot;description&quot;</span><span class="o">]</span><span class="p">)</span>

<span class="w">    </span><span class="nl">description</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span>

<span class="w">    </span><span class="nl">nullable</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">friendly_key</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nf">str</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;A human-readable class-name like key representing this Type.</span>

<span class="ss">        The key doesn&#39;t have to be unique, just a best effort, meaningful string.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_class_key_</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_14">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="descendants_7">Descendants</h4>
<ul>
<li>arti.types._Numeric</li>
<li>arti.types.Binary</li>
<li>arti.types.Boolean</li>
<li>arti.types.Date</li>
<li>arti.types.DateTime</li>
<li>arti.types.Enum</li>
<li>arti.types.Geography</li>
<li>arti.types.List</li>
<li>arti.types.Map</li>
<li>arti.types.Null</li>
<li>arti.types.Set</li>
<li>arti.types.String</li>
<li>arti.types.Struct</li>
<li>arti.types.Time</li>
<li>arti.types.Timestamp</li>
</ul>
<h4 id="class-variables_14">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_14">Static methods</h4>
<h4 id="construct_14">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_14">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_14">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_14">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_14">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_14">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_14">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_14">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_14">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_14">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">friendly_key</span>
</code></pre></div>

<p>A human-readable class-name like key representing this Type.</p>
<p>The key doesn't have to be unique, just a best effort, meaningful string.</p>
<h4 id="methods_15">Methods</h4>
<h4 id="copy_14">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_14">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_14">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="typeadapter">TypeAdapter</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TypeAdapter</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nl">TypeAdapter</span><span class="p">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;TypeAdapter maps between Artigraph types and a foreign type system.&quot;&quot;&quot;</span>

<span class="w">    </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">class_name</span><span class="p">()</span>

<span class="w">    </span><span class="nl">artigraph</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">type[Type</span><span class="o">]</span><span class="err">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">Artigraph</span><span class="w"> </span><span class="n">Type</span>

<span class="w">    </span><span class="k">system</span><span class="err">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">Any</span><span class="o">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">external</span><span class="w"> </span><span class="k">system</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">type</span>

<span class="w">    </span><span class="nl">priority</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">priority</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">mapping</span><span class="p">.</span><span class="w"> </span><span class="n">Higher</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">better</span><span class="p">.</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">matches_artigraph</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">artigraph</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">to_artigraph</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">type_system</span><span class="p">:</span><span class="w"> </span><span class="n">TypeSystem</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Type</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">matches_system</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">to_system</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">type_system</span><span class="p">:</span><span class="w"> </span><span class="n">TypeSystem</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<hr />
<h4 id="descendants_8">Descendants</h4>
<ul>
<li>arti.types._ScalarClassTypeAdapter</li>
<li>arti.types.python.PyValueContainer</li>
<li>arti.types.python.PyLiteral</li>
<li>arti.types.python.PyMap</li>
<li>arti.types.python.PyOptional</li>
<li>arti.types.python.PyStruct</li>
<li>arti.types.bigquery._BigQueryTypeAdapter</li>
<li>arti.types.bigquery.ListFieldTypeAdapter</li>
<li>arti.types.bigquery.TableTypeAdapter</li>
<li>arti.types.numpy.ArrayAdapter</li>
<li>arti.types.pandas.SeriesAdapter</li>
<li>arti.types.pandas.DataFrameAdapter</li>
<li>arti.types.pyarrow._PyarrowTypeAdapter</li>
<li>arti.types.pydantic.BaseModelAdapter</li>
</ul>
<h4 id="class-variables_15">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">key</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">priority</span>
</code></pre></div>

<h4 id="static-methods_15">Static methods</h4>
<h4 id="matches_artigraph">matches_artigraph</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">matches_artigraph</span><span class="p">(</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">hints</span><span class="p">:</span> <span class="s1">&#39;dict[str, Any]&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">matches_artigraph</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">artigraph</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="matches_system">matches_system</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">matches_system</span><span class="p">(</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">hints</span><span class="p">:</span> <span class="s1">&#39;dict[str, Any]&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;bool&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">matches_system</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="to_artigraph">to_artigraph</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">to_artigraph</span><span class="p">(</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">hints</span><span class="p">:</span> <span class="s1">&#39;dict[str, Any]&#39;</span><span class="p">,</span>
    <span class="n">type_system</span><span class="p">:</span> <span class="s1">&#39;TypeSystem&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Type&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">to_artigraph</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">type_system</span><span class="p">:</span><span class="w"> </span><span class="n">TypeSystem</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Type</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h4 id="to_system">to_system</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">to_system</span><span class="p">(</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">hints</span><span class="p">:</span> <span class="s1">&#39;dict[str, Any]&#39;</span><span class="p">,</span>
    <span class="n">type_system</span><span class="p">:</span> <span class="s1">&#39;TypeSystem&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">to_system</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">type_system</span><span class="p">:</span><span class="w"> </span><span class="n">TypeSystem</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="typesystem">TypeSystem</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TypeSystem</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">TypeSystem</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="k">key</span><span class="err">:</span><span class="w"> </span><span class="nf">str</span>

<span class="w">    </span><span class="nl">extends</span><span class="p">:</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">TypeSystem, ...</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nl">NOTE</span><span class="p">:</span><span class="w"> </span><span class="k">Use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">NoCopyDict</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">copies</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">registry</span><span class="p">.</span><span class="w"> </span><span class="n">Otherwise</span><span class="p">,</span><span class="w"> </span><span class="n">TypeSystems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">extend</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">TypeSystem</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">adapters</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="o">*</span><span class="k">as</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">initialization</span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="k">as</span><span class="w"> </span><span class="n">pydantic</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">deepcopy</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">TypeSystems</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">`</span><span class="n">extends</span><span class="err">`</span><span class="w"> </span><span class="n">argument</span><span class="p">).</span>

<span class="w">    </span><span class="nl">_adapter_by_key</span><span class="p">:</span><span class="w"> </span><span class="n">NoCopyDict</span><span class="o">[</span><span class="n">str, type[TypeAdapter</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PrivateAttr</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">NoCopyDict</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">register_adapter</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">adapter</span><span class="p">:</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">TypeAdapter</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">TypeAdapter</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">register</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_adapter_by_key</span><span class="p">,</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">adapter</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_priority_sorted_adapters</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">list</span><span class="o">[</span><span class="n">type[TypeAdapter</span><span class="o">]</span><span class="err">]:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sorted</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_adapter_by_key</span><span class="p">.</span><span class="k">values</span><span class="p">(),</span><span class="w"> </span><span class="k">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="ss">&quot;priority&quot;</span><span class="p">),</span><span class="w"> </span><span class="nf">reverse</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">to_artigraph</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">root_type_system</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">TypeSystem</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Type</span><span class="p">:</span>

<span class="w">        </span><span class="n">root_type_system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root_type_system</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">_priority_sorted_adapters</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="n">matches_system</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="n">to_artigraph</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="n">type_system</span><span class="o">=</span><span class="n">root_type_system</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">type_system</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">extends</span><span class="p">:</span>

<span class="w">            </span><span class="k">try</span><span class="err">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">type_system</span><span class="p">.</span><span class="n">to_artigraph</span><span class="p">(</span>

<span class="w">                    </span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="n">root_type_system</span><span class="o">=</span><span class="n">root_type_system</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">            </span><span class="ow">except</span><span class="w"> </span><span class="nl">NotImplementedError</span><span class="p">:</span>

<span class="w">                </span><span class="n">pass</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;No {root_type_system} adapter for system type: {type_}.&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">to_system</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">root_type_system</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">TypeSystem</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span>

<span class="w">        </span><span class="n">root_type_system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root_type_system</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">_priority_sorted_adapters</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="n">matches_artigraph</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="n">to_system</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="n">type_system</span><span class="o">=</span><span class="n">root_type_system</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">type_system</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">extends</span><span class="p">:</span>

<span class="w">            </span><span class="k">try</span><span class="err">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">type_system</span><span class="p">.</span><span class="n">to_system</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="n">root_type_system</span><span class="o">=</span><span class="n">root_type_system</span><span class="p">)</span>

<span class="w">            </span><span class="ow">except</span><span class="w"> </span><span class="nl">NotImplementedError</span><span class="p">:</span>

<span class="w">                </span><span class="n">pass</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;No {root_type_system} adapter for Artigraph type: {type_}.&quot;</span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_15">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="class-variables_16">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_16">Static methods</h4>
<h4 id="construct_15">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_15">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_15">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_15">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_15">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_15">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_15">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_15">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_15">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_15">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_16">Methods</h4>
<h4 id="copy_15">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_15">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_15">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h4 id="register_adapter">register_adapter</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">register_adapter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">adapter</span><span class="p">:</span> <span class="s1">&#39;type[TypeAdapter]&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;type[TypeAdapter]&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">register_adapter</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">adapter</span><span class="p">:</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">TypeAdapter</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">TypeAdapter</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">register</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_adapter_by_key</span><span class="p">,</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="k">key</span><span class="p">,</span><span class="w"> </span><span class="n">adapter</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="to_artigraph_1">to_artigraph</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">to_artigraph</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">hints</span><span class="p">:</span> <span class="s1">&#39;dict[str, Any]&#39;</span><span class="p">,</span>
    <span class="n">root_type_system</span><span class="p">:</span> <span class="s1">&#39;Optional[TypeSystem]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Type&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">to_artigraph</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">root_type_system</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">TypeSystem</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Type</span><span class="p">:</span>

<span class="w">        </span><span class="n">root_type_system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root_type_system</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">_priority_sorted_adapters</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="n">matches_system</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="n">to_artigraph</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="n">type_system</span><span class="o">=</span><span class="n">root_type_system</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">type_system</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">extends</span><span class="p">:</span>

<span class="w">            </span><span class="k">try</span><span class="err">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">type_system</span><span class="p">.</span><span class="n">to_artigraph</span><span class="p">(</span>

<span class="w">                    </span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="n">root_type_system</span><span class="o">=</span><span class="n">root_type_system</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">            </span><span class="ow">except</span><span class="w"> </span><span class="nl">NotImplementedError</span><span class="p">:</span>

<span class="w">                </span><span class="n">pass</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;No {root_type_system} adapter for system type: {type_}.&quot;</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="to_system_1">to_system</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">to_system</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">type_</span><span class="p">:</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">hints</span><span class="p">:</span> <span class="s1">&#39;dict[str, Any]&#39;</span><span class="p">,</span>
    <span class="n">root_type_system</span><span class="p">:</span> <span class="s1">&#39;Optional[TypeSystem]&#39;</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Any&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">to_system</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">type_</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">hints</span><span class="p">:</span><span class="w"> </span><span class="n">dict</span><span class="o">[</span><span class="n">str, Any</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="nl">root_type_system</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">TypeSystem</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ow">Any</span><span class="err">:</span>

<span class="w">        </span><span class="n">root_type_system</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root_type_system</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">self</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">_priority_sorted_adapters</span><span class="p">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="n">matches_artigraph</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">adapter</span><span class="p">.</span><span class="n">to_system</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="n">type_system</span><span class="o">=</span><span class="n">root_type_system</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">type_system</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">extends</span><span class="p">:</span>

<span class="w">            </span><span class="k">try</span><span class="err">:</span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">type_system</span><span class="p">.</span><span class="n">to_system</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span><span class="w"> </span><span class="n">hints</span><span class="o">=</span><span class="n">hints</span><span class="p">,</span><span class="w"> </span><span class="n">root_type_system</span><span class="o">=</span><span class="n">root_type_system</span><span class="p">)</span>

<span class="w">            </span><span class="ow">except</span><span class="w"> </span><span class="nl">NotImplementedError</span><span class="p">:</span>

<span class="w">                </span><span class="n">pass</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;No {root_type_system} adapter for Artigraph type: {type_}.&quot;</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="version">Version</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Version</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nb">Version</span>(<span class="n">Model</span>):

    <span class="n">_abstract_</span> = <span class="nb">True</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_16">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="descendants_9">Descendants</h4>
<ul>
<li>arti.versions.GitCommit</li>
<li>arti.versions.SemVer</li>
<li>arti.versions.String</li>
<li>arti.versions.Timestamp</li>
</ul>
<h4 id="class-variables_17">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<h4 id="static-methods_17">Static methods</h4>
<h4 id="construct_16">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_orm_16">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_file_16">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_16">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_16">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_16">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_16">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_16">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_16">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_16">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_17">Methods</h4>
<h4 id="copy_16">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_16">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_16">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
<h3 id="view">View</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">View</span><span class="p">(</span>
    <span class="n">__pydantic_self__</span><span class="p">,</span>
    <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="k">View</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;View represents the in-memory representation of the artifact.</span>

<span class="ss">    Examples include pandas.DataFrame, dask.DataFrame, a BigQuery table.</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">_abstract_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">    </span><span class="nl">_by_python_type_</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">dict[Optional[type</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">View</span><span class="o">]</span><span class="err">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">    </span><span class="nl">priority</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Set</span><span class="w"> </span><span class="n">priority</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">view</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">python_type</span><span class="p">.</span><span class="w"> </span><span class="n">Higher</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">better</span><span class="p">.</span>

<span class="w">    </span><span class="nl">python_type</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">Optional[type</span><span class="o">]</span><span class="err">]</span>

<span class="w">    </span><span class="nl">type_system</span><span class="p">:</span><span class="w"> </span><span class="n">ClassVar</span><span class="o">[</span><span class="n">TypeSystem</span><span class="o">]</span>

<span class="w">    </span><span class="nl">mode</span><span class="p">:</span><span class="w"> </span><span class="n">MODE</span>

<span class="w">    </span><span class="nl">artifact_class</span><span class="p">:</span><span class="w"> </span><span class="n">type</span><span class="o">[</span><span class="n">Artifact</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Artifact</span>

<span class="w">    </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init_subclass__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="nl">kwargs</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">super</span><span class="p">().</span><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="nl">_abstract_</span><span class="p">:</span>

<span class="w">            </span><span class="n">register</span><span class="p">(</span><span class="n">cls</span><span class="p">.</span><span class="n">_by_python_type_</span><span class="p">,</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">python_type</span><span class="p">,</span><span class="w"> </span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="nl">x</span><span class="p">:</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">priority</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@classmethod</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_check_type_compatibility</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">view_type</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">,</span><span class="w"> </span><span class="nl">artifact_type</span><span class="p">:</span><span class="w"> </span><span class="n">Type</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="n">Consider</span><span class="w"> </span><span class="n">supporting</span><span class="w"> </span><span class="ow">some</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">&quot;reader schema&quot;</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">View</span><span class="s1">&#39;s Type is a subset</span>

<span class="s1">        # of the Artifact&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="p">(</span><span class="ow">and</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="k">filter</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">columns</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">read</span><span class="p">).</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">consider</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">allowing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Producer</span><span class="s1">&#39;s Type to be a superset of the Artifact&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">we</span><span class="s1">&#39;d filter the</span>

<span class="s1">        # columns on write.</span>

<span class="s1">        #</span>

<span class="s1">        # If implementing, we can leverage the `mode` to determine which should be the &quot;superset&quot;.</span>

<span class="s1">        if view_type != artifact_type:</span>

<span class="s1">            raise ValueError(</span>

<span class="s1">                f&quot;the specified Type (`{view_type}`) is not compatible with the Artifact&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="p">(</span><span class="err">`{</span><span class="n">artifact_type</span><span class="err">}`</span><span class="p">).</span><span class="ss">&quot;</span>

<span class="ss">            )</span>

<span class="ss">    @validator(&quot;</span><span class="n">type</span><span class="ss">&quot;)</span>

<span class="ss">    @classmethod</span>

<span class="ss">    def _validate_type(cls, type_: Type, values: dict[str, Any]) -&gt; Type:</span>

<span class="ss">        artifact_class: Optional[type[Artifact]] = values.get(&quot;</span><span class="n">artifact_class</span><span class="ss">&quot;)</span>

<span class="ss">        if artifact_class is None:</span>

<span class="ss">            return type_  # pragma: no cover</span>

<span class="ss">        artifact_type: Optional[Type] = get_field_default(artifact_class, &quot;</span><span class="n">type</span><span class="ss">&quot;)</span>

<span class="ss">        if artifact_type is not None:</span>

<span class="ss">            cls._check_type_compatibility(view_type=type_, artifact_type=artifact_type)</span>

<span class="ss">        return type_</span>

<span class="ss">    @classmethod</span>

<span class="ss">    def _get_kwargs_from_annotation(cls, annotation: Any) -&gt; dict[str, Any]:</span>

<span class="ss">        artifact_class = get_item_from_annotated(</span>

<span class="ss">            annotation, Artifact, is_subclass=True</span>

<span class="ss">        ) or get_field_default(cls, &quot;</span><span class="n">artifact_class</span><span class="ss">&quot;)</span>

<span class="ss">        assert artifact_class is not None</span>

<span class="ss">        assert issubclass(artifact_class, Artifact)</span>

<span class="ss">        # Try to extract or infer the Type. We prefer: an explicit Type in the annotation, followed</span>

<span class="ss">        # by an Artifact&#39;s default type, falling back to inferring a Type from the type hint.</span>

<span class="ss">        type_ = get_item_from_annotated(annotation, Type, is_subclass=False)</span>

<span class="ss">        if type_ is None:</span>

<span class="ss">            artifact_type: Optional[Type] = get_field_default(artifact_class, &quot;</span><span class="n">type</span><span class="ss">&quot;)</span>

<span class="ss">            if artifact_type is None:</span>

<span class="ss">                from arti.types.python import python_type_system</span>

<span class="ss">                type_ = python_type_system.to_artigraph(discard_Annotated(annotation), hints={})</span>

<span class="ss">            else:</span>

<span class="ss">                type_ = artifact_type</span>

<span class="ss">        # NOTE: We validate that type_ and artifact_type (if set) are compatible in _validate_type,</span>

<span class="ss">        # which will run for *any* instance, not just those created with `.from_annotation`.</span>

<span class="ss">        return {&quot;</span><span class="n">artifact_class</span><span class="ss">&quot;: artifact_class, &quot;</span><span class="n">type</span><span class="ss">&quot;: type_}</span>

<span class="ss">    @classmethod  # TODO: Use typing.Self for return, pending mypy support</span>

<span class="ss">    def get_class_for(cls, annotation: Any) -&gt; builtins.type[View]:</span>

<span class="ss">        view_class = get_item_from_annotated(annotation, cls, is_subclass=True)</span>

<span class="ss">        if view_class is None:</span>

<span class="ss">            # We&#39;ve already searched for a View instance in the original Annotated args, so just</span>

<span class="ss">            # extract the root annotation.</span>

<span class="ss">            annotation = discard_Annotated(annotation)</span>

<span class="ss">            # Import the View submodules to trigger registration.</span>

<span class="ss">            import_submodules(__path__, __name__)</span>

<span class="ss">            view_class = cls._by_python_type_.get(annotation)</span>

<span class="ss">            # If no match and the type is a subscripted Generic (eg: `list[int]`), try to unwrap any</span>

<span class="ss">            # extra type variables.</span>

<span class="ss">            if view_class is None and (origin := get_origin(annotation)) is not None:</span>

<span class="ss">                view_class = cls._by_python_type_.get(origin)</span>

<span class="ss">            if view_class is None:</span>

<span class="ss">                raise ValueError(</span>

<span class="ss">                    f&quot;</span><span class="err">{</span><span class="n">annotation</span><span class="err">}</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">matched</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">View</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="err">`</span><span class="n">Annotated</span><span class="o">[</span><span class="n">int, arti.views.python.Int</span><span class="o">]</span><span class="err">`</span><span class="p">)</span><span class="ss">&quot;</span>

<span class="ss">                )</span>

<span class="ss">        return view_class</span>

<span class="ss">    @classmethod  # TODO: Use typing.Self for return, pending mypy support</span>

<span class="ss">    def from_annotation(cls, annotation: Any, *, mode: MODE) -&gt; View:</span>

<span class="ss">        view_class = cls.get_class_for(annotation)</span>

<span class="ss">        view = view_class(mode=mode, **cls._get_kwargs_from_annotation(annotation))</span>

<span class="ss">        view.check_annotation_compatibility(annotation)</span>

<span class="ss">        return view</span>

<span class="ss">    def check_annotation_compatibility(self, annotation: Any) -&gt; None:</span>

<span class="ss">        # We&#39;re only checking the root annotation (lenient_issubclass ignores Annotated anyway), so</span>

<span class="ss">        # tidy up the value to improve error messages.</span>

<span class="ss">        annotation = discard_Annotated(annotation)</span>

<span class="ss">        system_type = self.type_system.to_system(self.type, hints={})</span>

<span class="ss">        if not (</span>

<span class="ss">            lenient_issubclass(system_type, annotation)</span>

<span class="ss">            or lenient_issubclass(type(system_type), annotation)</span>

<span class="ss">        ):</span>

<span class="ss">            raise ValueError(f&quot;</span><span class="err">{</span><span class="n">annotation</span><span class="err">}</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">represent</span><span class="w"> </span><span class="err">{</span><span class="n">self</span><span class="p">.</span><span class="n">type</span><span class="err">}</span><span class="ss">&quot;)</span>

<span class="ss">    def check_artifact_compatibility(self, artifact: Artifact) -&gt; None:</span>

<span class="ss">        if not isinstance(artifact, self.artifact_class):</span>

<span class="ss">            raise ValueError(f&quot;</span><span class="n">expected</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="err">{</span><span class="n">self</span><span class="p">.</span><span class="n">artifact_class</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="n">got</span><span class="w"> </span><span class="err">{</span><span class="n">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span><span class="err">}</span><span class="ss">&quot;)</span>

<span class="ss">        self._check_type_compatibility(view_type=self.type, artifact_type=artifact.type)</span>

<span class="ss">        if self.mode in {&quot;</span><span class="k">READ</span><span class="ss">&quot;, &quot;</span><span class="n">READWRITE</span><span class="ss">&quot;}:</span>

<span class="ss">            io._read.lookup(</span>

<span class="ss">                type(artifact.type),</span>

<span class="ss">                type(artifact.format),</span>

<span class="ss">                list[artifact.storage.storage_partition_type],  # type: ignore[name-defined]</span>

<span class="ss">                type(self),</span>

<span class="ss">            )</span>

<span class="ss">        if self.mode in {&quot;</span><span class="k">WRITE</span><span class="ss">&quot;, &quot;</span><span class="n">READWRITE</span><span class="err">&quot;}:</span>

<span class="w">            </span><span class="n">io</span><span class="p">.</span><span class="n">_write</span><span class="p">.</span><span class="n">lookup</span><span class="p">(</span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">python_type</span><span class="p">,</span>

<span class="w">                </span><span class="n">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">.</span><span class="n">type</span><span class="p">),</span>

<span class="w">                </span><span class="n">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">.</span><span class="nf">format</span><span class="p">),</span>

<span class="w">                </span><span class="n">artifact</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">storage_partition_type</span><span class="p">,</span>

<span class="w">                </span><span class="n">type</span><span class="p">(</span><span class="n">self</span><span class="p">),</span>

<span class="w">            </span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro_17">Ancestors (in MRO)</h4>
<ul>
<li>arti.internal.models.Model</li>
<li>pydantic.main.BaseModel</li>
<li>pydantic.utils.Representation</li>
</ul>
<h4 id="descendants_10">Descendants</h4>
<ul>
<li>arti.views.python.PythonBuiltin</li>
</ul>
<h4 id="class-variables_18">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Config</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">priority</span>
</code></pre></div>

<h4 id="static-methods_18">Static methods</h4>
<h4 id="construct_17">construct</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">construct</span><span class="p">(</span>
    <span class="n">_fields_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;SetStr&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">values</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<p>Creates a new model setting <strong>dict</strong> and <strong>fields_set</strong> from trusted or pre-validated data.</p>
<p>Default values are respected, but no other validation is performed.
Behaves as if <code>Config.extra = 'allow'</code> was set since it adds all passed values</p>
<h4 id="from_annotation">from_annotation</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_annotation</span><span class="p">(</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="s1">&#39;MODE&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;View&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">Use</span><span class="w"> </span><span class="n">typing</span><span class="p">.</span><span class="n">Self</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">return</span><span class="p">,</span><span class="w"> </span><span class="n">pending</span><span class="w"> </span><span class="n">mypy</span><span class="w"> </span><span class="n">support</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">from_annotation</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">annotation</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="nl">mode</span><span class="p">:</span><span class="w"> </span><span class="n">MODE</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">View</span><span class="err">:</span>

<span class="w">        </span><span class="n">view_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">get_class_for</span><span class="p">(</span><span class="n">annotation</span><span class="p">)</span>

<span class="w">        </span><span class="k">view</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">view_class</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">cls</span><span class="p">.</span><span class="n">_get_kwargs_from_annotation</span><span class="p">(</span><span class="n">annotation</span><span class="p">))</span>

<span class="w">        </span><span class="k">view</span><span class="p">.</span><span class="n">check_annotation_compatibility</span><span class="p">(</span><span class="n">annotation</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">view</span>
</code></pre></div>

</details>
<h4 id="from_orm_17">from_orm</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">from_orm</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="get_class_for_1">get_class_for</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_class_for</span><span class="p">(</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;builtins.type[View]&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nv">@classmethod</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">Use</span><span class="w"> </span><span class="n">typing</span><span class="p">.</span><span class="n">Self</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">return</span><span class="p">,</span><span class="w"> </span><span class="n">pending</span><span class="w"> </span><span class="n">mypy</span><span class="w"> </span><span class="n">support</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_class_for</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="nl">annotation</span><span class="p">:</span><span class="w"> </span><span class="ow">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">builtins</span><span class="p">.</span><span class="n">type</span><span class="o">[</span><span class="n">View</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="n">view_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_item_from_annotated</span><span class="p">(</span><span class="n">annotation</span><span class="p">,</span><span class="w"> </span><span class="n">cls</span><span class="p">,</span><span class="w"> </span><span class="n">is_subclass</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">view_class</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="err">&#39;</span><span class="n">ve</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">searched</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">View</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">Annotated</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">just</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">extract</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">annotation</span><span class="p">.</span>

<span class="w">            </span><span class="n">annotation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">discard_Annotated</span><span class="p">(</span><span class="n">annotation</span><span class="p">)</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">Import</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">View</span><span class="w"> </span><span class="n">submodules</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">trigger</span><span class="w"> </span><span class="n">registration</span><span class="p">.</span>

<span class="w">            </span><span class="n">import_submodules</span><span class="p">(</span><span class="n">__path__</span><span class="p">,</span><span class="w"> </span><span class="n">__name__</span><span class="p">)</span>

<span class="w">            </span><span class="n">view_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_by_python_type_</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">annotation</span><span class="p">)</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="k">match</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subscripted</span><span class="w"> </span><span class="n">Generic</span><span class="w"> </span><span class="p">(</span><span class="nl">eg</span><span class="p">:</span><span class="w"> </span><span class="err">`</span><span class="n">list</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="err">`</span><span class="p">),</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unwrap</span><span class="w"> </span><span class="ow">any</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">variables</span><span class="p">.</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">view_class</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="p">(</span><span class="n">origin</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">get_origin</span><span class="p">(</span><span class="n">annotation</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="n">view_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">_by_python_type_</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">view_class</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                    </span><span class="n">f</span><span class="ss">&quot;{annotation} cannot be matched to a View, try setting one explicitly (eg: `Annotated[int, arti.views.python.Int]`)&quot;</span>

<span class="w">                </span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">view_class</span>
</code></pre></div>

</details>
<h4 id="parse_file_17">parse_file</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_obj_17">parse_obj</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_obj</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="parse_raw_17">parse_raw</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_raw</span><span class="p">(</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">content_type</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span>
    <span class="n">proto</span><span class="p">:</span> <span class="n">pydantic</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">Protocol</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">allow_pickle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="schema_17">schema</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema</span><span class="p">(</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<h4 id="schema_json_17">schema_json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">schema_json</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="s1">&#39;unicode&#39;</span> <span class="o">=</span> <span class="s1">&#39;#/definitions/</span><span class="si">{model}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<h4 id="update_forward_refs_17">update_forward_refs</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">update_forward_refs</span><span class="p">(</span>
    <span class="o">**</span><span class="n">localns</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Try to update ForwardRefs on fields based on this Model, globalns and localns.</p>
<h4 id="validate_17">validate</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Model&#39;</span>
</code></pre></div>

<h4 id="instance-variables_17">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">fingerprint</span>
</code></pre></div>

<h4 id="methods_18">Methods</h4>
<h4 id="check_annotation_compatibility">check_annotation_compatibility</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">check_annotation_compatibility</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">check_annotation_compatibility</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">annotation</span><span class="o">:</span><span class="w"> </span><span class="kr">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="o">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">We</span><span class="s">&#39;re only checking the root annotation (lenient_issubclass ignores Annotated anyway), so</span>

<span class="s">        # tidy up the value to improve error messages.</span>

<span class="s">        annotation = discard_Annotated(annotation)</span>

<span class="s">        system_type = self.type_system.to_system(self.type, hints={})</span>

<span class="s">        if not (</span>

<span class="s">            lenient_issubclass(system_type, annotation)</span>

<span class="s">            or lenient_issubclass(type(system_type), annotation)</span>

<span class="s">        ):</span>

<span class="s">            raise ValueError(f&quot;</span><span class="p">{</span><span class="n">annotation</span><span class="p">}</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">represent</span><span class="w"> </span><span class="p">{</span><span class="kr">self</span><span class="p">.</span><span class="kr">type</span><span class="p">}</span><span class="s">&quot;)</span>
</code></pre></div>

</details>
<h4 id="check_artifact_compatibility">check_artifact_compatibility</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">check_artifact_compatibility</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">artifact</span><span class="p">:</span> <span class="s1">&#39;Artifact&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;None&#39;</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">check_artifact_compatibility</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">artifact</span><span class="o">:</span><span class="w"> </span><span class="n">Artifact</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="o">:</span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">artifact</span><span class="p">,</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">artifact_class</span><span class="p">)</span><span class="o">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s">&quot;expected an instance of {self.artifact_class}, got {type(artifact)}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="kr">self</span><span class="p">.</span><span class="n">_check_type_compatibility</span><span class="p">(</span><span class="n">view_type</span><span class="o">=</span><span class="kr">self</span><span class="p">.</span><span class="kr">type</span><span class="p">,</span><span class="w"> </span><span class="n">artifact_type</span><span class="o">=</span><span class="n">artifact</span><span class="p">.</span><span class="kr">type</span><span class="p">)</span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">mode</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;READ&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;READWRITE&quot;</span><span class="p">}</span><span class="o">:</span>

<span class="w">            </span><span class="n">io</span><span class="p">.</span><span class="n">_read</span><span class="p">.</span><span class="kr">lookup</span><span class="p">(</span>

<span class="w">                </span><span class="kr">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">.</span><span class="kr">type</span><span class="p">),</span>

<span class="w">                </span><span class="kr">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">.</span><span class="n">format</span><span class="p">),</span>

<span class="w">                </span><span class="n">list</span><span class="p">[</span><span class="n">artifact</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">storage_partition_type</span><span class="p">],</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="kr">type</span><span class="o">:</span><span class="w"> </span><span class="n">ignore</span><span class="p">[</span><span class="n">name</span><span class="o">-</span><span class="n">defined</span><span class="p">]</span>

<span class="w">                </span><span class="kr">type</span><span class="p">(</span><span class="kr">self</span><span class="p">),</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">mode</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;WRITE&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;READWRITE&quot;</span><span class="p">}</span><span class="o">:</span>

<span class="w">            </span><span class="n">io</span><span class="p">.</span><span class="n">_write</span><span class="p">.</span><span class="kr">lookup</span><span class="p">(</span>

<span class="w">                </span><span class="kr">self</span><span class="p">.</span><span class="n">python_type</span><span class="p">,</span>

<span class="w">                </span><span class="kr">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">.</span><span class="kr">type</span><span class="p">),</span>

<span class="w">                </span><span class="kr">type</span><span class="p">(</span><span class="n">artifact</span><span class="p">.</span><span class="n">format</span><span class="p">),</span>

<span class="w">                </span><span class="n">artifact</span><span class="p">.</span><span class="n">storage</span><span class="p">.</span><span class="n">storage_partition_type</span><span class="p">,</span>

<span class="w">                </span><span class="kr">type</span><span class="p">(</span><span class="kr">self</span><span class="p">),</span>

<span class="w">            </span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="copy_17">copy</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">deep</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validate</span><span class="p">:</span> <span class="s1">&#39;bool&#39;</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="s1">&#39;Any&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Self&#39;</span>
</code></pre></div>

<p>Duplicate a model, optionally choose which fields to include, exclude and change.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>include</td>
<td>None</td>
<td>fields to include in new model</td>
<td>None</td>
</tr>
<tr>
<td>exclude</td>
<td>None</td>
<td>fields to exclude from new model, as with values this takes precedence over include</td>
<td>None</td>
</tr>
<tr>
<td>update</td>
<td>None</td>
<td>values to change/add in the new model. Note: the data is not validated before creating</td>
<td></td>
</tr>
<tr>
<td>the new model: you should trust this data</td>
<td>None</td>
<td></td>
<td></td>
</tr>
<tr>
<td>deep</td>
<td>None</td>
<td>set to <code>True</code> to make a deep copy of the model</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>None</td>
<td>new model instance</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">copy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">True</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="o">:</span><span class="w"> </span><span class="k">Any</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Self</span><span class="o">:</span>

<span class="w">        </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">super</span><span class="p">().</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="n">deep</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">validate</span><span class="o">:</span>

<span class="w">            </span><span class="c1"># NOTE: We set exclude_unset=False so that all existing defaulted fields are reused (as</span>

<span class="w">            </span><span class="c1"># is normal `.copy` behavior).</span>

<span class="w">            </span><span class="c1">#</span>

<span class="w">            </span><span class="c1"># To reduce `repr` noise, we&#39;ll reset .__fields_set__ to those of the pre-validation copy</span>

<span class="w">            </span><span class="c1"># (which includes those originally set + updated).</span>

<span class="w">            </span><span class="n">fields_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">__fields_set__</span>

<span class="w">            </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy</span><span class="p">.</span><span class="n">validate</span><span class="p">(</span>

<span class="w">                </span><span class="n">dict</span><span class="p">(</span><span class="n">copy</span><span class="p">.</span><span class="n">_iter</span><span class="p">(</span><span class="n">to_dict</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">by_alias</span><span class="o">=</span><span class="no">False</span><span class="p">,</span><span class="w"> </span><span class="n">exclude_unset</span><span class="o">=</span><span class="no">False</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="c1"># Use object.__setattr__ to bypass frozen model assignment errors</span>

<span class="w">            </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;__fields_set__&quot;</span><span class="p">,</span><span class="w"> </span><span class="kt">set</span><span class="p">(</span><span class="n">fields_set</span><span class="p">))</span>

<span class="w">            </span><span class="c1"># Copy over the private attributes, which are missing after validation (since we&#39;re only</span>

<span class="w">            </span><span class="c1"># passing the fields).</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="k">name</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__private_attributes__</span><span class="o">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">value</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">Undefined</span><span class="p">))</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">Undefined</span><span class="o">:</span>

<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="n">deep</span><span class="o">:</span>

<span class="w">                        </span><span class="k">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deepcopy</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>

<span class="w">                    </span><span class="n">object</span><span class="p">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span><span class="w"> </span><span class="k">name</span><span class="p">,</span><span class="w"> </span><span class="k">value</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span>
</code></pre></div>

</details>
<h4 id="dict_17">dict</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;DictStrAny&#39;</span>
</code></pre></div>

<p>Generate a dictionary representation of the model, optionally specifying which fields to include or exclude.</p>
<h4 id="json_17">json</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">include</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;AbstractSetIntStr&#39;</span><span class="p">),</span> <span class="n">ForwardRef</span><span class="p">(</span><span class="s1">&#39;MappingIntStrAny&#39;</span><span class="p">),</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">skip_defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_unset</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_defaults</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">encoder</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">models_as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">dumps_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;unicode&#39;</span>
</code></pre></div>

<p>Generate a JSON representation of the model, <code>include</code> and <code>exclude</code> arguments as per <code>dict()</code>.</p>
<p><code>encoder</code> is an optional function to supply as <code>default</code> to json.dumps(), other arguments as per <code>json.dumps()</code>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="graphs/" title="Graphs" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Graphs
              </span>
            </div>
          </a>
        
        
          <a href="partitions/" title="Partitions" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Partitions
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Powered by
        <a href="http://timothycrosley.github.io/portray">portray.</a>
        You too can
        <a href="http://timothycrosley.github.io/portray">
          portray</a>
        your Python project well using automatic documentation.
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>